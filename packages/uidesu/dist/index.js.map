{"version":3,"sources":["../package.json","../src/registry/errors.ts","../src/utils/highlighter.ts","../src/utils/logger.ts","../src/utils/handle-error.ts","../src/registry/constants.ts","../src/registry/env.ts","../src/registry/parser.ts","../src/utils/frameworks.ts","../src/utils/resolve-import.ts","../src/utils/get-config.ts","../src/utils/get-package-info.ts","../src/utils/get-project-info.ts","../src/utils/compare.ts","../src/utils/env-helpers.ts","../src/utils/spinner.ts","../src/utils/transformers/transform-css-vars.ts","../src/utils/icon-libraries.ts","../src/utils/transformers/transform-icons.ts","../src/utils/transformers/transform-import.ts","../src/utils/transformers/transform-jsx.ts","../src/utils/transformers/transform-rsc.ts","../src/utils/transformers/transform-tw-prefix.ts","../src/utils/transformers/index.ts","../src/utils/transformers/transform-next.ts","../src/utils/updaters/update-files.ts","../src/registry/utils.ts","../src/registry/config.ts","../src/registry/context.ts","../src/registry/validator.ts","../src/registry/builder.ts","../src/registry/fetcher.ts","../src/utils/updaters/update-tailwind-config.ts","../src/registry/resolver.ts","../src/registry/api.ts","../src/utils/is-safe-target.ts","../src/utils/updaters/update-css.ts","../src/utils/updaters/update-css-vars.ts","../src/utils/get-package-manager.ts","../src/utils/updaters/update-dependencies.ts","../src/utils/updaters/update-env-vars.ts","../src/utils/add-components.ts","../src/utils/env-loader.ts","../src/registry/namespaces.ts","../src/utils/registries.ts","../src/commands/add.ts","../src/preflights/preflight-build.ts","../src/commands/build.ts","../src/preflights/preflight-init.ts","../src/utils/create-project.ts","../src/utils/file-helper.ts","../src/commands/init.ts","../src/index.ts"],"names":["package_default","RegistryErrorCode","RegistryError","message","options","RegistryNotFoundError","url","cause","RegistryUnauthorizedError","RegistryForbiddenError","RegistryFetchError","statusCode","responseBody","baseMessage","suggestion","RegistryNotConfiguredError","registryName","RegistryLocalFileError","filePath","RegistryParseError","item","parseError","z","e","RegistryMissingEnvironmentVariablesError","missingVars","v","RegistriesIndexParseError","invalidNamespaces","i","arr","highlighter","red","yellow","cyan","green","logger","args","handleError","error","key","value","REGISTRY_URL","FALLBACK_STYLE","BASE_COLORS","BUILTIN_REGISTRIES","expandEnvVars","_match","extractEnvVars","vars","regex","match","REGISTRY_PATTERN","parseRegistryAndItemFromString","name","FRAMEWORKS","resolveImport","importPath","config","createMatchPath","explorer","cosmiconfig","getConfig","cwd","getRawConfig","resolveConfigPaths","tsConfig","loadConfig","configSchema","path","configResult","rawConfigSchema","componentPath","getWorkspaceConfig","resolvedAliases","isAliasKey","resolvedPath","packageRoot","findPackageRoot","result","workspaceConfigSchema","commonRoot","findCommonRoot","relativePath","matchingPackageRoot","fg","pkgPath","pkgDir","parts1","parts2","commonParts","getTargetStyleFromConfig","fallback","getProjectInfo","createConfig","partial","defaultConfig","getPackageInfo","shouldThrow","packageJsonPath","fs","PROJECT_SHARED_IGNORE","configFiles","isSrcDir","isTsx","tailwindConfigFile","tailwindCssFile","tailwindVersion","aliasPrefix","packageJson","isTypeScriptProject","getTailwindConfigFile","getTailwindCssFile","getTailwindVersion","getTsConfigAliasPrefix","isUsingAppDir","type","file","getFrameworkVersion","framework","version","versionMatch","rangeMatch","packageInfo","files","contents","alias","paths","getProjectConfig","defaultProjectInfo","existingConfig","projectInfo","getProjectTailwindVersionFromConfig","isContentSame","existingContent","newContent","ignoreImports","normalizedExisting","normalizedNew","importRegex","normalizeImports","content","prefix","suffix","parts","lastPart","existingNormalized","newNormalized","isEnvFile","fileName","findExistingEnvFile","targetDir","variants","variant","existsSync","parseEnvContent","lines","env","line","trimmed","equalIndex","getNewEnvKeys","existingEnv","newEnv","newKeys","mergeEnvContent","spinner","text","ora","transformCssVars","sourceFile","baseColor","SyntaxKind","node","raw","mapped","applyColorMapping","splitClassName","className","rest","alpha","split","PREFIXES","input","mapping","classNames","lightMode","darkMode","modifier","needle","ICON_LIBRARIES","SOURCE_LIBRARY","transformIcons","registryIcons","getRegistryIcons","sourceLibrary","targetLibrary","targetedIcons","importDeclaration","specifier","iconName","targetedIcon","iconImportDeclaration","icon","_useSemicolon","transformImport","isRemote","utilsAlias","utilsImport","updated","updateImportAliases","namedImport","moduleSpecifier","PARSE_OPTIONS","transformJsx","output","ast","code","parse","transformFromAstSync","transformTypescript","directiveRegex","transformRsc","first","transformTwPrefixes","defaultClassNames","applyPrefix","callExpression","arg","project","Project","createTempSourceFile","filename","dir","tmpdir","transform","opts","transformers","tempFile","ScriptKind","transformer","transformNext","func","variable","exportDecl","namedExport","updateFiles","filesCreatedSpinner","getRegistryBaseColor","filesCreated","filesUpdated","filesSkipped","envVarsAdded","envFile","index","resolveFilePath","f","basename","alternativeEnvFile","existingFile","statSync","_isNext16Middleware","existingFileContent","overwrite","prompts","mergedContent","allFiles","updatedFiles","resolveImports","target","resolvePageTarget","resolveFileTargetDirectory","resolveNestedFilePath","normalizedPaths","p","normalizedNeedle","needleDir","needleSegments","testPath","normalizedFilePath","normalizedTargetDir","fileSegments","targetSegments","lastTargetSegment","commonDirIndex","segment","filePaths","filepath","importDeclarations","probableImportFilePath","resolvedImportFilePath","resolveModuleByProbablePath","newImport","toAliasedImport","extensions","relativeFiles","fileSet","extInPath","hasExt","absBase","relBase","tryExts","candidates","absCand","relCand","absIdx","relIdx","a","b","aExt","bExt","ord","aStrong","bStrong","abs","matches","root","aliasKey","rootDir","rel","ext","keepExt","noExt","aliasBase","isRootMiddleware","isNextJs","majorVersion","isUrl","isLocalFile","isUniversalRegistryItem","registryItem","deduplicateFilesByTarget","filesArrays","canDeduplicateFiles","registryItemFileSchema","targetMap","resolveStyleFromConfig","configWithDefaults","baseConfig","deepmerge","context","setRegistryHeaders","headers","getRegistryHeadersFromContext","clearRegistryContext","extractEnvVarsFromRegistryConfig","validateRegistryConfig","missing","NAME_PLACEHOLDER","STYLE_PLACEHOLDER","ENV_VAR_PATTER","QUERY_PARAM_SEPARATOR","QUERY_PARAM_DELIMITER","buildUrlAndHeadersForRegistryItem","registry","registryConfig","buildUrlFromRegistryConfig","buildHeadersFromRegistryConfig","baseUrl","appendQueryParams","expandedValue","shouldIncludeHeader","params","urlParams","queryString","separator","originalValue","trimmedExpanded","templateWithoutVars","resolveRegistryUrl","pathOrUrl","agent","HttpsProxyAgent","registryCache","fetchRegistry","fetchPromise","response","fetch","messageFromServer","json","parsed","fetchRegistryLocal","expandedPath","homedir","registryItemSchema","updateTailwindConfig","tailwindConfig","tailwindFileRelativePath","tailwindSpinner","transformTailwindConfig","_createSourceFile","configObject","property","quoteChar","_getQuoteChar","addTailwindConfigProperty","plugin","addTailwindConfigPlugin","addTailwindConfigTheme","existingProperty","newProperty","initializer","newValue","initializerText","element","theme","nestSpreadProperties","themeInitializer","themeObjectString","themeObject","parseObjectLiteral","dst","src","resultString","objectToString","unnestSpreadProperties","existingPlugins","QuoteKind","obj","properties","prop","spreadAssignment","spreadText","nestSpreadElements","elements","j","propAssignment","unsetSpreadElements","spreadTest","objectLiteralString","statement","parseObjectLiteralExpression","parseArrayLiteralExpression","parseValue","buildTailwindThemeColorsFromCssVars","cssVars","colorName","subType","resolveRegistryItemsFromRegistries","items","registryHeaders","resolvedItems","resolved","fetchRegistryItems","resolveRegistryTree","names","payload","allDependencyItems","allDependencyRegistryNames","uniqueNames","results","resultMap","sourceName","itemWithSource","resolvedDependencies","namespacedDeps","dep","registryNames","resolveDependenciesRecursively","uniqueRegistryNames","nonNamespacedItems","namespacedDepItems","depResults","getUidesuRegistryIndex","registryUrls","itemDependencies","resolveRegistryDependencies","uniqueUrls","registryPayload","registryGetTheme","sourceMap","source","topologicalSortRegistryItems","tailwind","css","docs","envVars","deduplicatedFiles","registryResolvedItemsTreeSchema","dependencies","visited","resolvedDeps","nested","style","urls","computeItemHash","identifier","hash","createHash","extractItemIdentifierFromDependency","dependency","pathname","itemMap","hashToItem","inDegree","adjacencyList","depToHashes","itemSource","itemHash","depHash","exactMatches","nameMatches","queue","sorted","degree","currentHash","dependentHash","newDegree","sortedHashes","getRegistryItems","useCache","registryIndexSchema","getRegistryStyles","stylesSchema","iconsSchema","getRegistryBaseColors","registryBaseColorSchema","getRegistriesIndex","data","registriesIndexSchema","isSafeTarget","targetPath","decodedPath","prevPath","normalizedTarget","normalizedRoot","hasPathTraversal","cleanPath","cleanTarget","cleanDecoded","pattern","updateCss","cssFilepath","cssFilepathRelative","cssSpinner","transformCss","plugins","updateCssPlugin","postcss","lastNode","selector","atRuleMatch","importRule","importNodes","lastImport","quotedParams","normalizeParams","pluginRule","pluginNodes","lastPlugin","newAtRule","themeInline","keyframesRule","step","stepProps","processRule","utilityAtRule","existingDecl","decl","atRule","processAtRule","childSelector","childProps","nestedMatch","nestedName","nestedParams","tempRule","rule","clone","parent","atRuleName","atRuleParams","nestedSelector","updateCssVars","cssVarsSpinner","updateCssVarsPlugin","cleanupDefaultNextStylesPlugin","addCustomImport","addCustomVariant","updateCssVarsPluginV4","updateThemePlugin","updateTailwindConfigPlugin","updateTailwindConfigAnimationPlugin","updateTailwindConfigKeyframesPlugin","updateBaseLayerPlugin","requiredRules","baseLayer","apply","applyRule","AtRule","addOrUpdateVars","removeConflictVars","rootRule","propsToRemove","bodyRule","darkRootRule","ruleNode","newDecl","themeNode","upsertThemeNode","isLocalHSLValue","variables","themeVarNodes","radiusVariables","cssVarNode","isColorValue","propValue","variantNode","customVariantNode","importNode","quote","getQuoteType","lastPluginNode","pluginName","pluginNode","existingKeyFrameNodes","keyframeValueSchema","keyframeName","keyframeValue","parsedKeyframeValue","keyframeNode","values","existingAnimationNodes","parsedAnimationValue","animationNode","chunks","chunk","getPackageManager","withFallback","packageManager","detect","userAgent","updateDependencies","devDependencies","dependenciesSpinner","getUpdateDependenciesPackageManager","flag","shouldPromptForNpmFlag","confirmation","installWithPackageManager","hasReact19","hasReactDayPicker8","installWithNpm","installWithDeno","installWithExpo","execa","updateEnvVars","envSpinner","projectRoot","envFilePath","existingEnvFile","envFileExists","envFileName","newEnvContent","envFileUpdated","envFileCreated","addComponents","components","workspaceConfig","addWorkspaceComponents","addProjectComponents","registrySpinner","tree","validateFilesTarget","overwriteCssVars","shouldOverwriteCssVars","component","loadEnvFiles","envFiles","envPath","join","resolveRegistryNamespaces","discoveredNamespaces","visitedItems","itemsToProcess","currentItem","depRegistry","ensureRegistriesInConfig","missingRegistries","registryIndex","foundRegistries","existingRegistries","newConfigWithRegistries","resolvedPaths","configWithoutResolvedPaths","configSpinner","updatedConfig","addOptionsSchema","add","Command","initialConfig","hasNewRegistries","newRegistries","itemType","confirm","preFlightBuild","errors","resolvePaths","buildOptionsSchema","build","Oe","registrySchema","buildSpinner","preFlightInit","projectSpinner","frameworkSpinner","tailwindSpinnerMessage","tsConfigSpinner","MONOREPO_TEMPLATE_URL","TEMPLATES","createProject","template","projectName","nextVersion","isRemoteComponent","meta","projectPath","createViteProject","createNextProject","createMonorepoProject","createSpinner","installSpinner","templatePath","os","tarPath","extractedPath","packageJsonContent","FILE_BACKUP_SUFFIX","createFileBackup","fsExtra","backupPath","restoreFileBackup","deleteFileBackup","initOptionsSchema","val","init","shadowConfig","componentsJsonPath","runInit","newProjectTemplate","preflight","projectConfig","promptForMinimalConfig","cssVariables","styles","baseColors","color","main","program"],"mappings":"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","file":"index.js","sourcesContent":["{\r\n  \"name\": \"uidesu\",\r\n  \"version\": \"1.0.0\",\r\n  \"description\": \"Add components to your apps.\",\r\n  \"publishConfig\": {\r\n    \"access\": \"public\"\r\n  },\r\n  \"license\": \"MIT\",\r\n  \"author\": {\r\n    \"name\": \"sergiocortes-dll\",\r\n    \"url\": \"https://twitter.com/sergiocortes-dll\"\r\n  },\r\n  \"repository\": {\r\n    \"type\": \"git\",\r\n    \"url\": \"https://github.com/aodesu/ui-cli.git\",\r\n    \"directory\": \"packages/aodesu\"\r\n  },\r\n  \"files\": [\r\n    \"dist\"\r\n  ],\r\n  \"keywords\": [\r\n    \"components\",\r\n    \"ui\",\r\n    \"tailwind\",\r\n    \"radix-ui\",\r\n    \"uidesu\"\r\n  ],\r\n  \"type\": \"module\",\r\n  \"exports\": {\r\n    \".\": {\r\n      \"types\": \"./dist/index.d.ts\",\r\n      \"default\": \"./dist/index.js\"\r\n    },\r\n    \"./schema\": {\r\n      \"types\": \"./dist/schema/index.d.ts\",\r\n      \"default\": \"./dist/schema/index.js\"\r\n    }\r\n  },\r\n  \"bin\": \"./dist/index.js\",\r\n  \"scripts\": {\r\n    \"dev\": \"tsup --watch\",\r\n    \"start:dev\": \"cross-env REGISTRY_URL=https://localhost:4000/r node dist/index.js\"\r\n  },\r\n  \"dependencies\": {\r\n    \"@antfu/ni\": \"^25.0.0\",\r\n    \"@babel/core\": \"^7.28.0\",\r\n    \"@babel/parser\": \"^7.28.0\",\r\n    \"@babel/plugin-transform-typescript\": \"^7.28.0\",\r\n    \"@babel/preset-typescript\": \"^7.27.1\",\r\n    \"@dotenvx/dotenvx\": \"^1.48.4\",\r\n    \"commander\": \"^14.0.0\",\r\n    \"cosmiconfig\": \"^9.0.0\",\r\n    \"deepmerge\": \"^4.3.1\",\r\n    \"execa\": \"^9.6.0\",\r\n    \"fast-glob\": \"^3.3.3\",\r\n    \"fs-extra\": \"^11.3.1\",\r\n    \"https-proxy-agent\": \"^7.0.6\",\r\n    \"kleur\": \"^4.1.5\",\r\n    \"node-fetch\": \"^3.3.2\",\r\n    \"ora\": \"^8.2.0\",\r\n    \"postcss\": \"^8.5.6\",\r\n    \"prompts\": \"^2.4.2\",\r\n    \"recast\": \"^0.23.11\",\r\n    \"stringify-object\": \"^5.0.0\",\r\n    \"ts-morph\": \"^26.0.0\",\r\n    \"tsconfig-paths\": \"^4.2.0\",\r\n    \"zod\": \"^3.24.1\",\r\n    \"zod-to-json-schema\": \"3.24.6\"\r\n  },\r\n  \"devDependencies\": {\r\n    \"@types/babel__core\": \"^7.20.5\",\r\n    \"@types/fs-extra\": \"^11.0.4\",\r\n    \"@types/prompts\": \"^2.4.9\",\r\n    \"@types/stringify-object\": \"^4.0.5\",\r\n    \"rimraf\": \"^6.0.1\",\r\n    \"tsup\": \"^8.5.0\",\r\n    \"type-fest\": \"^4.41.0\",\r\n    \"typescript\": \"^5.9.2\"\r\n  }\r\n}\r\n","import { z } from \"zod\"\r\n\r\n// Error codes for programmatic error handling\r\nexport const RegistryErrorCode = {\r\n  // Network errors\r\n  NETWORK_ERROR: \"NETWORK_ERROR\",\r\n  NOT_FOUND: \"NOT_FOUND\",\r\n  UNAUTHORIZED: \"UNAUTHORIZED\",\r\n  FORBIDDEN: \"FORBIDDEN\",\r\n  FETCH_ERROR: \"FETCH_ERROR\",\r\n\r\n  // Configuration errors\r\n  NOT_CONFIGURED: \"NOT_CONFIGURED\",\r\n  INVALID_CONFIG: \"INVALID_CONFIG\",\r\n  MISSING_ENV_VARS: \"MISSING_ENV_VARS\",\r\n\r\n  // File system errors\r\n  LOCAL_FILE_ERROR: \"LOCAL_FILE_ERROR\",\r\n\r\n  // Parsing errors\r\n  PARSE_ERROR: \"PARSE_ERROR\",\r\n  VALIDATION_ERROR: \"VALIDATION_ERROR\",\r\n\r\n  // Generic errors\r\n  UNKNOWN_ERROR: \"UNKNOWN_ERROR\",\r\n} as const\r\n\r\nexport type RegistryErrorCode =\r\n  (typeof RegistryErrorCode)[keyof typeof RegistryErrorCode]\r\n\r\nexport class RegistryError extends Error {\r\n  public readonly code: RegistryErrorCode\r\n  public readonly statusCode?: number\r\n  public readonly context?: Record<string, unknown>\r\n  public readonly suggestion?: string\r\n  public readonly timestamp: Date\r\n  public readonly cause?: unknown\r\n\r\n  constructor(\r\n    message: string,\r\n    options: {\r\n      code?: RegistryErrorCode\r\n      statusCode?: number\r\n      cause?: unknown\r\n      context?: Record<string, unknown>\r\n      suggestion?: string\r\n    } = {}\r\n  ) {\r\n    super(message)\r\n    this.name = \"RegistryError\"\r\n    this.code = options.code || RegistryErrorCode.UNKNOWN_ERROR\r\n    this.statusCode = options.statusCode\r\n    this.cause = options.cause\r\n    this.context = options.context\r\n    this.suggestion = options.suggestion\r\n    this.timestamp = new Date()\r\n\r\n    if (Error.captureStackTrace) {\r\n      Error.captureStackTrace(this, this.constructor)\r\n    }\r\n  }\r\n\r\n  toJSON() {\r\n    return {\r\n      name: this.name,\r\n      message: this.message,\r\n      code: this.code,\r\n      statusCode: this.statusCode,\r\n      context: this.context,\r\n      suggestion: this.suggestion,\r\n      timestamp: this.timestamp,\r\n      stack: this.stack,\r\n    }\r\n  }\r\n}\r\n\r\nexport class RegistryNotFoundError extends RegistryError {\r\n  constructor(public readonly url: string, cause?: unknown) {\r\n    const message = `The item at ${url} was not found. It may not exist at the registry.`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.NOT_FOUND,\r\n      statusCode: 404,\r\n      cause,\r\n      context: { url },\r\n      suggestion:\r\n        \"Check if the item name is correct and the registry URL is accessible.\",\r\n    })\r\n    this.name = \"RegistryNotFoundError\"\r\n  }\r\n}\r\n\r\nexport class RegistryUnauthorizedError extends RegistryError {\r\n  constructor(public readonly url: string, cause?: unknown) {\r\n    const message = `You are not authorized to access the item at ${url}. If this is a remote registry, you may need to authenticate.`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.UNAUTHORIZED,\r\n      statusCode: 401,\r\n      cause,\r\n      context: { url },\r\n      suggestion:\r\n        \"Check your authentication credentials and environment variables.\",\r\n    })\r\n    this.name = \"RegistryUnauthorizedError\"\r\n  }\r\n}\r\n\r\nexport class RegistryForbiddenError extends RegistryError {\r\n  constructor(public readonly url: string, cause?: unknown) {\r\n    const message = `You are not authorized to access the item at ${url}. If this is a remote registry, you may need to authenticate.`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.FORBIDDEN,\r\n      statusCode: 403,\r\n      cause,\r\n      context: { url },\r\n      suggestion:\r\n        \"Check your authentication credentials and environment variables.\",\r\n    })\r\n    this.name = \"RegistryForbiddenError\"\r\n  }\r\n}\r\n\r\nexport class RegistryFetchError extends RegistryError {\r\n  constructor(\r\n    public readonly url: string,\r\n    statusCode?: number,\r\n    public readonly responseBody?: string,\r\n    cause?: unknown\r\n  ) {\r\n    // Use the error detail from the server if available\r\n    const baseMessage = statusCode\r\n      ? `Failed to fetch from registry (${statusCode}): ${url}`\r\n      : `Failed to fetch from registry: ${url}`\r\n\r\n    const message =\r\n      typeof cause === \"string\" && cause\r\n        ? `${baseMessage} - ${cause}`\r\n        : baseMessage\r\n\r\n    let suggestion = \"Check your network connection and try again.\"\r\n    if (statusCode === 404) {\r\n      suggestion =\r\n        \"The requested resource was not found. Check the URL or item name.\"\r\n    } else if (statusCode === 500) {\r\n      suggestion = \"The registry server encountered an error. Try again later.\"\r\n    } else if (statusCode && statusCode >= 400 && statusCode < 500) {\r\n      suggestion = \"There was a client error. Check your request parameters.\"\r\n    }\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.FETCH_ERROR,\r\n      statusCode,\r\n      cause,\r\n      context: { url, responseBody },\r\n      suggestion,\r\n    })\r\n    this.name = \"RegistryFetchError\"\r\n  }\r\n}\r\n\r\nexport class RegistryNotConfiguredError extends RegistryError {\r\n  constructor(public readonly registryName: string | null) {\r\n    const message = registryName\r\n      ? `Unknown registry \"${registryName}\". Make sure it is defined in components.json as follows:\r\n{\r\n  \"registries\": {\r\n    \"${registryName}\": \"[URL_TO_REGISTRY]\"\r\n  }\r\n}`\r\n      : `Unknown registry. Make sure it is defined in components.json under \"registries\".`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.NOT_CONFIGURED,\r\n      context: { registryName },\r\n      suggestion:\r\n        \"Add the registry configuration to your components.json file. Consult the registry documentation for the correct format.\",\r\n    })\r\n    this.name = \"RegistryNotConfiguredError\"\r\n  }\r\n}\r\n\r\nexport class RegistryLocalFileError extends RegistryError {\r\n  constructor(public readonly filePath: string, cause?: unknown) {\r\n    super(`Failed to read local registry file: ${filePath}`, {\r\n      code: RegistryErrorCode.LOCAL_FILE_ERROR,\r\n      cause,\r\n      context: { filePath },\r\n      suggestion: \"Check if the file exists and you have read permissions.\",\r\n    })\r\n    this.name = \"RegistryLocalFileError\"\r\n  }\r\n}\r\n\r\nexport class RegistryParseError extends RegistryError {\r\n  public readonly parseError: unknown\r\n\r\n  constructor(public readonly item: string, parseError: unknown) {\r\n    let message = `Failed to parse registry item: ${item}`\r\n\r\n    if (parseError instanceof z.ZodError) {\r\n      message = `Failed to parse registry item: ${item}\\n${parseError.errors\r\n        .map((e) => `  - ${e.path.join(\".\")}: ${e.message}`)\r\n        .join(\"\\n\")}`\r\n    }\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.PARSE_ERROR,\r\n      cause: parseError,\r\n      context: { item },\r\n      suggestion:\r\n        \"The registry item may be corrupted or have an invalid format. Please make sure it returns a valid JSON object. See https://ui.aodesu.com/schema/registry-item.json.\",\r\n    })\r\n\r\n    this.parseError = parseError\r\n    this.name = \"RegistryParseError\"\r\n  }\r\n}\r\n\r\nexport class RegistryMissingEnvironmentVariablesError extends RegistryError {\r\n  constructor(\r\n    public readonly registryName: string,\r\n    public readonly missingVars: string[]\r\n  ) {\r\n    const message =\r\n      `Registry \"${registryName}\" requires the following environment variables:\\n\\n` +\r\n      missingVars.map((v) => `   ${v}`).join(\"\\n\")\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.MISSING_ENV_VARS,\r\n      context: { registryName, missingVars },\r\n      suggestion:\r\n        \"Set the required environment variables to your .env or .env.local file.\",\r\n    })\r\n    this.name = \"RegistryMissingEnvironmentVariablesError\"\r\n  }\r\n}\r\n\r\nexport class RegistryInvalidNamespaceError extends RegistryError {\r\n  constructor(public readonly name: string) {\r\n    const message = `Invalid registry namespace: \"${name}\". Registry names must start with @ (e.g., @aodesu, @v0).`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.VALIDATION_ERROR,\r\n      context: { name },\r\n      suggestion:\r\n        \"Use a valid registry name starting with @ or provide a direct URL to the registry.\",\r\n    })\r\n    this.name = \"RegistryInvalidNamespaceError\"\r\n  }\r\n}\r\n\r\nexport class ConfigMissingError extends RegistryError {\r\n  constructor(public readonly cwd: string) {\r\n    const message = `No components.json found in ${cwd} or parent directories.`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.NOT_CONFIGURED,\r\n      context: { cwd },\r\n      suggestion:\r\n        \"Run 'npx aodesu@latest init' to create a components.json file, or check that you're in the correct directory.\",\r\n    })\r\n    this.name = \"ConfigMissingError\"\r\n  }\r\n}\r\n\r\nexport class ConfigParseError extends RegistryError {\r\n  constructor(public readonly cwd: string, parseError: unknown) {\r\n    let message = `Invalid components.json configuration in ${cwd}.`\r\n\r\n    if (parseError instanceof z.ZodError) {\r\n      message = `Invalid components.json configuration in ${cwd}:\\n${parseError.errors\r\n        .map((e) => `  - ${e.path.join(\".\")}: ${e.message}`)\r\n        .join(\"\\n\")}`\r\n    }\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.INVALID_CONFIG,\r\n      cause: parseError,\r\n      context: { cwd },\r\n      suggestion:\r\n        \"Check your components.json file for syntax errors or invalid configuration. Run 'npx aodesu@latest init' to regenerate a valid configuration.\",\r\n    })\r\n    this.name = \"ConfigParseError\"\r\n  }\r\n}\r\n\r\nexport class RegistriesIndexParseError extends RegistryError {\r\n  public readonly parseError: unknown\r\n\r\n  constructor(parseError: unknown) {\r\n    let message = \"Failed to parse registries index\"\r\n\r\n    if (parseError instanceof z.ZodError) {\r\n      const invalidNamespaces = parseError.errors\r\n        .filter((e) => e.path.length > 0)\r\n        .map((e) => `\"${e.path[0]}\"`)\r\n        .filter((v, i, arr) => arr.indexOf(v) === i) // remove duplicates\r\n\r\n      if (invalidNamespaces.length > 0) {\r\n        message = `Failed to parse registries index. Invalid registry namespace(s): ${invalidNamespaces.join(\r\n          \", \"\r\n        )}\\n${parseError.errors\r\n          .map((e) => `  - ${e.path.join(\".\")}: ${e.message}`)\r\n          .join(\"\\n\")}`\r\n      } else {\r\n        message = `Failed to parse registries index:\\n${parseError.errors\r\n          .map((e) => `  - ${e.path.join(\".\")}: ${e.message}`)\r\n          .join(\"\\n\")}`\r\n      }\r\n    }\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.PARSE_ERROR,\r\n      cause: parseError,\r\n      context: { parseError },\r\n      suggestion:\r\n        \"The registries index may be corrupted or have invalid registry namespace format. Registry names must start with @ (e.g., @aodesu, @example).\",\r\n    })\r\n\r\n    this.parseError = parseError\r\n    this.name = \"RegistriesIndexParseError\"\r\n  }\r\n}\r\n","import { cyan, green, red, yellow } from \"kleur/colors\";\r\n\r\nexport const highlighter = {\r\n  error: red,\r\n  warn: yellow,\r\n  info: cyan,\r\n  success: green,\r\n};\r\n","import { highlighter } from \"./highlighter\";\r\n\r\nexport const logger = {\r\n  error(...args: unknown[]) {\r\n    console.log(highlighter.error(args.join(\" \")))\r\n  },\r\n  warn(...args: unknown[]) {\r\n    console.log(highlighter.warn(args.join(\" \")))\r\n  },\r\n  info(...args: unknown[]) {\r\n    console.log(highlighter.info(args.join(\" \")))\r\n  },\r\n  success(...args: unknown[]) {\r\n    console.log(highlighter.success(args.join(\" \")))\r\n  },\r\n  log(...args: unknown[]) {\r\n    console.log(args.join(\" \"))\r\n  },\r\n  break() {\r\n    console.log(\"\")\r\n  },\r\n};\r\n","import z from \"zod\";\r\nimport { RegistryError } from \"../registry/errors\";\r\nimport { highlighter } from \"./highlighter\";\r\nimport { logger } from \"./logger\";\r\n\r\nexport function handleError(error: unknown) {\r\n  logger.break();\r\n  logger.error(\"Something went wrong. Please check the error below for more details.\");\r\n  logger.error(\"If the problem persist, please open an issue on GitHub.\");\r\n  logger.error(\"\");\r\n\r\n  if (typeof error === \"string\") {\r\n    logger.error(error);\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  if (error instanceof RegistryError) {\r\n    if (error.message) {\r\n      logger.error(error.cause ? \"Error\" : \"Message:\");\r\n      logger.error(error.message);\r\n    }\r\n\r\n    if (error.cause) {\r\n      logger.error(\"\\nMessage:\");\r\n      logger.error(error.cause);\r\n    }\r\n\r\n    if (error.suggestion) {\r\n      logger.error(\"\\nSuggestion:\");\r\n      logger.error(error.suggestion);\r\n    }\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  if (error instanceof z.ZodError) {\r\n    logger.error(\"Validation failed:\");\r\n    for (const [key, value] of Object.entries(error.flatten().fieldErrors)) {\r\n      logger.error(`- ${highlighter.info(key)}: ${value}`);\r\n    }\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  if (error instanceof Error) {\r\n    logger.error(error.message);\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  logger.break();\r\n  process.exit(1);\r\n}\r\n","import z from \"zod\";\r\nimport { registryConfigSchema } from \"./schema\";\r\n\r\nexport const REGISTRY_URL =\r\n  process.env.REGISTRY_URL ?? \"https://ui.aodesu.com/r\";\r\n\r\nexport const FALLBACK_STYLE = \"aodesu\";\r\n\r\nexport const BASE_COLORS = [\r\n  {\r\n    name: \"neutral\",\r\n    label: \"Neutral\"\r\n  }\r\n]\r\n\r\nexport const BUILTIN_REGISTRIES: z.infer<typeof registryConfigSchema> = {\r\n  \"@uidesu\": `${REGISTRY_URL}/styles/{style}/{name}.json`,\r\n}\r\n","export function expandEnvVars(value: string) {\r\n  return value.replace(/\\${(\\w+)}/g, (_match, key) => process.env[key] || \"\")\r\n}\r\n\r\nexport function extractEnvVars(value: string) {\r\n  const vars: string[] = []\r\n  const regex = /\\${(\\w+)}/g\r\n  let match: RegExpExecArray | null\r\n\r\n  while ((match = regex.exec(value)) !== null) {\r\n    vars.push(match[1])\r\n  }\r\n\r\n  return vars\r\n}\r\n","// Valid registry name pattern: @namespace where namespace is alphanumeric with hyphens/underscores\r\nconst REGISTRY_PATTERN = /^(@[a-zA-Z0-9](?:[a-zA-Z0-9-_]*[a-zA-Z0-9])?)\\/(.+)$/\r\n\r\nexport function parseRegistryAndItemFromString(name: string) {\r\n  if (!name.startsWith(\"@\")) {\r\n    return {\r\n      registry: null,\r\n      item: name,\r\n    }\r\n  }\r\n\r\n  const match = name.match(REGISTRY_PATTERN)\r\n  if (match) {\r\n    return {\r\n      registry: match[1],\r\n      item: match[2],\r\n    }\r\n  }\r\n\r\n  return {\r\n    registry: null,\r\n    item: name,\r\n  }\r\n}\r\n","export const FRAMEWORKS = {\r\n  \"next-app\": {\r\n    name: \"next-app\",\r\n    label: \"Next.js\",\r\n    links: {\r\n      installation: \"https://ui.aodesu.com/docs/installation/next\",\r\n      tailwind: \"https://tailwindcss.com/docs/guides/nextjs\",\r\n    },\r\n  },\r\n  \"next-pages\": {\r\n    name: \"next-pages\",\r\n    label: \"Next.js\",\r\n    links: {\r\n      installation: \"https://ui.aodesu.com/docs/installation/next\",\r\n      tailwind: \"https://tailwindcss.com/docs/guides/nextjs\",\r\n    },\r\n  },\r\n  vite: {\r\n    name: \"vite\",\r\n    label: \"vite\",\r\n    links: {\r\n      installation: \"https://ui.aodesu.com/docs/installation/vite\",\r\n      tailwind: \"https://tailwindcss.com/docs/guides/vite\",\r\n    },\r\n  },\r\n  manual: {\r\n    name: \"manual\",\r\n    label: \"Manual\",\r\n    links: {\r\n      installation: \"https://ui.aodesu.com/docs/installation/manual\",\r\n      tailwind: \"https://tailwindcss.com/docs/installation\",\r\n    },\r\n  },\r\n} as const;\r\n\r\nexport type Framework = (typeof FRAMEWORKS)[keyof typeof FRAMEWORKS];\r\n","import { createMatchPath, type ConfigLoaderSuccessResult } from \"tsconfig-paths\";\r\n\r\nexport async function resolveImport(\r\n  importPath: string,\r\n  config: Pick<ConfigLoaderSuccessResult, \"absoluteBaseUrl\" | \"paths\">\r\n) {\r\n  return createMatchPath(config.absoluteBaseUrl, config.paths)(\r\n    importPath,\r\n    undefined,\r\n    () => true,\r\n    [\".ts\", \".tsx\", \".jsx\", \".js\", \".css\"]\r\n  )\r\n}\r\n","import { cosmiconfig } from \"cosmiconfig\";\r\nimport fg from \"fast-glob\";\r\nimport path from \"path\";\r\nimport { loadConfig } from \"tsconfig-paths\";\r\nimport z from \"zod\";\r\nimport { BUILTIN_REGISTRIES } from \"../registry/constants\";\r\nimport { configSchema, rawConfigSchema, workspaceConfigSchema } from \"../schema\";\r\nimport { getProjectInfo } from \"./get-project-info\";\r\nimport { highlighter } from \"./highlighter\";\r\nimport { resolveImport } from \"./resolve-import\";\r\n\r\n// TODO: Figure out if we want to support all cosmiconfig formats.\r\n// A simple components.json file would be nice.\r\nexport const explorer = cosmiconfig(\"components\", {\r\n  searchPlaces: [\"components.json\"]\r\n});\r\n\r\nexport type Config = z.infer<typeof configSchema>\r\n\r\nexport async function getConfig(cwd: string) {\r\n  const config = await getRawConfig(cwd);\r\n\r\n  if (!config) {\r\n    return null;\r\n  }\r\n\r\n  // Set default icon library if not provided.\r\n  if (!config.iconLibrary) {\r\n    config.iconLibrary = config.style === \"aodesu\" ? \"radix\" : \"lucide\";\r\n  }\r\n\r\n  return await resolveConfigPaths(cwd, config);\r\n}\r\n\r\nexport async function resolveConfigPaths(\r\n  cwd: string,\r\n  config: z.infer<typeof rawConfigSchema>\r\n) {\r\n  // Merge built-in registries with user registries\r\n  config.registries = {\r\n    ...BUILTIN_REGISTRIES,\r\n    ...(config.registries || {}),\r\n  };\r\n\r\n  // Read tsconfig.json\r\n  const tsConfig = await loadConfig(cwd);\r\n\r\n  if (tsConfig.resultType === \"failed\") {\r\n    throw new Error(\r\n      `Failed to load ${config.tsx ? \"tsconfig\" : \"jsconfig\"}.json ${\r\n        tsConfig.message ?? \"\"\r\n      }`.trim()\r\n    );\r\n  }\r\n\r\n  return configSchema.parse({\r\n    ...config,\r\n    resolvedPaths: {\r\n      cwd,\r\n      tailwindConfig: config.tailwind.config\r\n        ? path.resolve(cwd, config.tailwind.config)\r\n        : \"\",\r\n      tailwindCss: path.resolve(cwd, config.tailwind.css),\r\n      utils: await resolveImport(config.aliases[\"utils\"], tsConfig),\r\n      components: await resolveImport(config.aliases[\"components\"], tsConfig),\r\n      ui: config.aliases[\"ui\"]\r\n        ? await resolveImport(config.aliases[\"ui\"], tsConfig)\r\n        : path.resolve(\r\n          (await resolveImport(config.aliases[\"components\"], tsConfig)) ??\r\n          cwd,\r\n          \"ui\"\r\n        ),\r\n      // TODO: Make this configurable\r\n      // For now, we assume the lib and hooks directories are one level up from the components directory.\r\n      lib: config.aliases[\"lib\"]\r\n        ? await resolveImport(config.aliases[\"lib\"], tsConfig)\r\n        : path.resolve(\r\n          (await resolveImport(config.aliases[\"utils\"], tsConfig)) ?? cwd,\r\n          \"..\"\r\n        ),\r\n      hooks: config.aliases[\"hooks\"]\r\n        ? await resolveImport(config.aliases[\"hooks\"], tsConfig)\r\n        : path.resolve(\r\n          (await resolveImport(config.aliases[\"components\"], tsConfig)) ??\r\n            cwd,\r\n          \"..\",\r\n          \"hooks\"\r\n        ),\r\n    },\r\n  })\r\n};\r\n\r\nexport async function getRawConfig(\r\n  cwd: string\r\n): Promise<z.infer<typeof rawConfigSchema> | null> {\r\n  try {\r\n    const configResult = await explorer.search(cwd);\r\n\r\n    if (!configResult) {\r\n      return null;\r\n    }\r\n\r\n    const config = rawConfigSchema.parse(configResult.config);\r\n\r\n    // Check if user is trying to override built-in registries\r\n    if (config.registries) {\r\n      for (const registryName of Object.keys(config.registries)) {\r\n        if (registryName in BUILTIN_REGISTRIES) {\r\n          throw new Error(\r\n            `\"${registryName}\" is a built-in registry and cannot be overriden.`\r\n          )\r\n        }\r\n      }\r\n    }\r\n\r\n    return config;\r\n  } catch (error) {\r\n    const componentPath = `${cwd}/components.json`;\r\n    if (error instanceof Error && error.message.includes(\"reserved registry\")) {\r\n      throw error;\r\n    }\r\n    throw new Error(\r\n      `Invalid configuration found in ${highlighter.info(componentPath)}`\r\n    );\r\n  }\r\n}\r\n\r\nexport async function getWorkspaceConfig(config: Config) {\r\n  let resolvedAliases: any = {};\r\n\r\n  for (const key of Object.keys(config.aliases)) {\r\n    if (!isAliasKey(key, config)) {\r\n      continue;\r\n    }\r\n\r\n    const resolvedPath = config.resolvedPaths[key];\r\n    const packageRoot = await findPackageRoot(\r\n      config.resolvedPaths.cwd,\r\n      resolvedPath\r\n    );\r\n\r\n    if (!packageRoot) {\r\n      resolvedAliases[key] = config;\r\n      continue;\r\n    }\r\n\r\n    resolvedAliases[key] = await getConfig(packageRoot);\r\n  }\r\n\r\n  const result = workspaceConfigSchema.safeParse(resolvedAliases)\r\n  if (!result.success) {\r\n    return null;\r\n  }\r\n\r\n  return result.data;\r\n}\r\n\r\nexport async function findPackageRoot(cwd: string, resolvedPath: string) {\r\n  const commonRoot = findCommonRoot(cwd, resolvedPath);\r\n  const relativePath = path.relative(commonRoot, resolvedPath);\r\n\r\n  const packageRoots = await fg.glob(\"**/package.json\", {\r\n    cwd: commonRoot,\r\n    deep: 3,\r\n    ignore: [\"**/node_modules/**\", \"**/dist/**\", \"**/build/**\", \"**/public/**\"],\r\n  });\r\n\r\n  const matchingPackageRoot = packageRoots\r\n    .map((pkgPath) => path.dirname(pkgPath))\r\n    .find((pkgDir) => relativePath.startsWith(pkgDir));\r\n\r\n  return matchingPackageRoot ? path.join(commonRoot, matchingPackageRoot) : null;\r\n}\r\n\r\nfunction isAliasKey(\r\n  key: string,\r\n  config: Config\r\n): key is keyof Config[\"aliases\"] {\r\n  return Object.keys(config.resolvedPaths)\r\n    .filter((key) => key !== \"utils\")\r\n    .includes(key);\r\n}\r\n\r\nexport function findCommonRoot(cwd: string, resolvedPath: string) {\r\n  const parts1 = cwd.split(path.sep);\r\n  const parts2 = resolvedPath.split(path.sep);\r\n  const commonParts = [];\r\n\r\n  for (let i = 0; i < Math.min(parts1.length, parts2.length); i++) {\r\n    if (parts1[i] !== parts2[i]) {\r\n      break\r\n    }\r\n    commonParts.push(parts1[i])\r\n  }\r\n\r\n  return commonParts.join(path.sep);\r\n}\r\n\r\n// TODO: Cache this call.\r\nexport async function getTargetStyleFromConfig(cwd: string, fallback: string) {\r\n  const projectInfo = await getProjectInfo(cwd)\r\n  return projectInfo?.tailwindVersion === \"v4\" ? \"new-york-v4\" : fallback\r\n}\r\n\r\ntype DeepPartial<T> = {\r\n  [P in keyof T]?: T[P] extends object ? DeepPartial<T[P]> : T[P]\r\n}\r\n\r\nexport function createConfig(partial?: DeepPartial<Config>): Config {\r\n  const defaultConfig: Config = {\r\n    resolvedPaths: {\r\n      cwd: process.cwd(),\r\n      tailwindConfig: \"\",\r\n      tailwindCss: \"\",\r\n      utils: \"\",\r\n      components: \"\",\r\n      ui: \"\",\r\n      lib: \"\",\r\n      hooks: \"\",\r\n    },\r\n    style: \"\",\r\n    tailwind: {\r\n      config: \"\",\r\n      css: \"\",\r\n      baseColor: \"\",\r\n      cssVariables: false,\r\n    },\r\n    rsc: false,\r\n    tsx: true,\r\n    aliases: {\r\n      components: \"\",\r\n      utils: \"\",\r\n    },\r\n    registries: {\r\n      ...BUILTIN_REGISTRIES,\r\n    },\r\n  }\r\n\r\n  // Deep merge the partial config with defaults\r\n  if (partial) {\r\n    return {\r\n      ...defaultConfig,\r\n      ...partial,\r\n      resolvedPaths: {\r\n        ...defaultConfig.resolvedPaths,\r\n        ...(partial.resolvedPaths|| {}),\r\n      },\r\n      tailwind: {\r\n        ...defaultConfig.tailwind,\r\n        ...(partial.tailwind || {}),\r\n      },\r\n      aliases: {\r\n        ...defaultConfig.aliases,\r\n        ...(partial.aliases || {}),\r\n      },\r\n      registries: {\r\n        ...defaultConfig.registries,\r\n        ...(partial.registries || {}),\r\n      },\r\n    }\r\n  }\r\n\r\n  return defaultConfig;\r\n}\r\n","import fs from \"fs-extra\";\r\nimport path from \"path\";\r\nimport { type PackageJson } from \"type-fest\";\r\n\r\nexport function getPackageInfo(\r\n  cwd: string = \"\",\r\n  shouldThrow: boolean = true\r\n): PackageJson | null {\r\n  const packageJsonPath = path.join(cwd, \"package.json\");\r\n\r\n  return fs.readJSONSync(packageJsonPath, {\r\n    throws: shouldThrow,\r\n  }) as PackageJson;\r\n}\r\n","import { Framework, FRAMEWORKS } from \"@/src/utils/frameworks\";\r\nimport { Config, getConfig, resolveConfigPaths } from \"@/src/utils/get-config\";\r\nimport { getPackageInfo } from \"@/src/utils/get-package-info\";\r\nimport fg from \"fast-glob\";\r\nimport fs from \"fs-extra\";\r\nimport path from \"path\";\r\nimport { loadConfig } from \"tsconfig-paths\";\r\nimport { z } from \"zod\";\r\nimport { rawConfigSchema } from \"../schema\";\r\n\r\nexport type TailwindVersion = \"v3\" | \"v4\" | null;\r\n\r\nexport type ProjectInfo = {\r\n  framework: Framework;\r\n  isSrcDir: boolean;\r\n  isRSC: boolean;\r\n  isTsx: boolean;\r\n  tailwindConfigFile: string | null;\r\n  tailwindCssFile: string | null;\r\n  tailwindVersion: TailwindVersion;\r\n  frameworkVersion: string | null;\r\n  aliasPrefix: string | null;\r\n}\r\n\r\nconst PROJECT_SHARED_IGNORE = [\r\n  \"**/node_modules/**\",\r\n  \".next\",\r\n  \"public\",\r\n  \"dist\",\r\n  \"build\",\r\n];\r\n\r\nconst TS_CONFIG_SCHEMA = z.object({\r\n  compilerOptions: z.object({\r\n    paths: z.record(z.string().or(z.array(z.string()))),\r\n  }),\r\n});\r\n\r\nexport async function getProjectInfo(cwd: string): Promise<ProjectInfo | null> {\r\n  const [\r\n    configFiles,\r\n    isSrcDir,\r\n    isTsx,\r\n    tailwindConfigFile,\r\n    tailwindCssFile,\r\n    tailwindVersion,\r\n    aliasPrefix,\r\n    packageJson,\r\n  ] = await Promise.all([\r\n    fg.glob(\r\n      \"**/{vite,app,next}.config.*|gatsby-config.*|composer.json|react-router.config.*\",\r\n      {\r\n        cwd,\r\n        deep: 3,\r\n        ignore: PROJECT_SHARED_IGNORE,\r\n      }\r\n    ),\r\n    fs.pathExists(path.resolve(cwd, \"src\")),\r\n    isTypeScriptProject(cwd),\r\n    getTailwindConfigFile(cwd),\r\n    getTailwindCssFile(cwd),\r\n    getTailwindVersion(cwd),\r\n    getTsConfigAliasPrefix(cwd),\r\n    getPackageInfo(cwd, false),\r\n  ]);\r\n\r\n  const isUsingAppDir = await fs.pathExists(\r\n    path.resolve(cwd, `${isSrcDir ? \"src/\" : \"\"}app`)\r\n  );\r\n\r\n  const type: ProjectInfo = {\r\n    framework: FRAMEWORKS[\"manual\"],\r\n    isSrcDir,\r\n    isRSC: false,\r\n    isTsx,\r\n    tailwindConfigFile,\r\n    tailwindCssFile,\r\n    tailwindVersion,\r\n    frameworkVersion: null,\r\n    aliasPrefix,\r\n  }\r\n\r\n  // Next.js.\r\n  if (configFiles.find((file) => file.startsWith(\"next.config.\"))?.length) {\r\n    type.framework = isUsingAppDir\r\n      ? FRAMEWORKS[\"next-app\"]\r\n      : FRAMEWORKS[\"next-pages\"];\r\n    type.isRSC = isUsingAppDir;\r\n    type.frameworkVersion = await getFrameworkVersion(\r\n      type.framework,\r\n      packageJson\r\n    );\r\n    return type;\r\n  }\r\n\r\n  // Vite.\r\n  if (configFiles.find((file) => file.startsWith(\"vite.config.\"))?.length) {\r\n    type.framework = FRAMEWORKS[\"vite\"];\r\n    return type;\r\n  }\r\n\r\n  return type;\r\n};\r\n\r\nexport async function getFrameworkVersion(\r\n  framework: Framework,\r\n  packageJson: ReturnType<typeof getPackageInfo>\r\n) {\r\n  if (!packageJson) {\r\n    return null;\r\n  }\r\n\r\n  // Only detect Next.js version for now.\r\n  if (![\"next-app\", \"next-pages\"].includes(framework.name)) {\r\n    return null;\r\n  }\r\n\r\n  const version =\r\n    packageJson.dependencies?.next || packageJson.devDependencies?.next;\r\n\r\n  if (!version) {\r\n    return null;\r\n  }\r\n\r\n  // Extract full semver (major.minor.patch), handling ^, ~, etc.\r\n  const versionMatch = version.match(/^[\\^~]?(\\d+\\.\\d+\\.\\d+)/)\r\n  if (versionMatch) {\r\n    return versionMatch[1] // e.g., \"16.0.0\"\r\n  }\r\n\r\n  // For ranges like \">=15.0.0 <16.0.0\", extract the first version.\r\n  const rangeMatch = version.match(/(\\d+\\.\\d+\\.\\d+)/)\r\n  if (rangeMatch) {\r\n    return rangeMatch[1]\r\n  }\r\n\r\n  // For \"latest\", \"canary\", \"rc\", etc., return the tag as-is.\r\n  return version\r\n}\r\n\r\nexport async function getTailwindVersion(\r\n  cwd: string\r\n): Promise<ProjectInfo[\"tailwindVersion\"]> {\r\n  const [packageInfo, config] = await Promise.all([\r\n    getPackageInfo(cwd, false),\r\n    getConfig(cwd),\r\n  ]);\r\n\r\n  // If the config file is empty, we can assume that it's a v4 project\r\n  if (config?.tailwind?.config === \"\") {\r\n    return \"v4\";\r\n  }\r\n\r\n  if (\r\n    !packageInfo?.dependencies?.tailwindcss &&\r\n    !packageInfo?.devDependencies?.tailwindcss\r\n  ) {\r\n    return null;\r\n  }\r\n\r\n  if (\r\n    /^(?:\\^|~)?3(?:\\.\\d+)*(?:-.*)?$/.test(\r\n      packageInfo?.dependencies?.tailwindcss ||\r\n        packageInfo?.devDependencies?.tailwindcss ||\r\n        \"\"\r\n    )\r\n  ) {\r\n    return \"v3\"\r\n  }\r\n\r\n  return \"v4\"\r\n}\r\n\r\nexport async function getTailwindCssFile(cwd: string) {\r\n  const [files, tailwindVersion] = await Promise.all([\r\n    fg.glob([\"**/*.css\", \"**/*.scss\"], {\r\n      cwd,\r\n      deep: 5,\r\n      ignore: PROJECT_SHARED_IGNORE,\r\n    }),\r\n    getTailwindVersion(cwd),\r\n  ]);\r\n\r\n  if (!files.length) {\r\n    return null;\r\n  }\r\n\r\n  for (const file of files) {\r\n    const contents = await fs.readFile(path.resolve(cwd, file), \"utf8\");\r\n    if (\r\n      contents.includes(`@import \"tailwindcss\"`) ||\r\n      contents.includes(`@import 'tailwindcss'`) ||\r\n      contents.includes(`@tailwind base`)\r\n    ) {\r\n      return file;\r\n    }\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\nexport async function getTailwindConfigFile(cwd: string) {\r\n  const files = await fg.glob(\"tailwind.config.*\", {\r\n    cwd,\r\n    deep: 3,\r\n    ignore: PROJECT_SHARED_IGNORE,\r\n  });\r\n\r\n  if (!files.length) {\r\n    return null;\r\n  }\r\n\r\n  return files[0];\r\n}\r\n\r\nexport async function getTsConfigAliasPrefix(cwd: string) {\r\n  const tsConfig = await loadConfig(cwd);\r\n\r\n  if (\r\n    tsConfig?.resultType === \"failed\" ||\r\n    !Object.entries(tsConfig?.paths).length\r\n  ) {\r\n    return null;\r\n  }\r\n\r\n  // This assume that the first alias is the prefix.\r\n  for (const [alias, paths] of Object.entries(tsConfig.paths)) {\r\n    if (\r\n      paths.includes(\"./*\") ||\r\n      paths.includes(\"./src/*\") ||\r\n      paths.includes(\"./app/*\") ||\r\n      paths.includes(\"./resources/js/*\") // Laravel.\r\n    ) {\r\n      return alias.replace(/\\/\\*$/, \"\") ?? null\r\n    }\r\n  }\r\n\r\n  // Use the first alias as the prefix.\r\n  return Object.keys(tsConfig?.paths)?.[0].replace(/\\/\\*$/, \"\") ?? null;\r\n}\r\n\r\nexport async function isTypeScriptProject(cwd: string) {\r\n  const files = await fg.glob(\"tsconfig.*\", {\r\n    cwd,\r\n    deep: 1,\r\n    ignore: PROJECT_SHARED_IGNORE,\r\n  });\r\n\r\n  return files.length > 0;\r\n}\r\n\r\nexport async function getProjectConfig(\r\n  cwd: string,\r\n  defaultProjectInfo: ProjectInfo | null = null\r\n): Promise<Config | null> {\r\n  // Check for existing component file.\r\n  const [existingConfig, projectInfo] = await Promise.all([\r\n    getConfig(cwd),\r\n    !defaultProjectInfo\r\n      ? getProjectInfo(cwd)\r\n      : Promise.resolve(defaultProjectInfo)\r\n  ]);\r\n\r\n  if (existingConfig) {\r\n    return existingConfig;\r\n  }\r\n\r\n  if(\r\n    !projectInfo ||\r\n    !projectInfo.tailwindCssFile ||\r\n    (projectInfo.tailwindVersion === \"v3\" && !projectInfo.tailwindConfigFile)\r\n  ) {\r\n    return null;\r\n  }\r\n\r\n  const config: z.infer<typeof rawConfigSchema> = {\r\n    $schema: \"https://ui.aodesu.com/schema.json\",\r\n    rsc: projectInfo.isRSC,\r\n    tsx: projectInfo.isTsx,\r\n    style: \"aodesu\",\r\n    tailwind: {\r\n      config: projectInfo.tailwindConfigFile ?? \"\",\r\n      baseColor: \"zinc\",\r\n      css: projectInfo.tailwindCssFile,\r\n      cssVariables: true,\r\n      prefix: \"\",\r\n    },\r\n    iconLibrary: \"lucide\",\r\n    aliases: {\r\n      components: `${projectInfo.aliasPrefix}/components`,\r\n      ui: `${projectInfo.aliasPrefix}/components/ui`,\r\n      hooks: `${projectInfo.aliasPrefix}/hooks`,\r\n      lib: `${projectInfo.aliasPrefix}/lib`,\r\n      utils: `${projectInfo.aliasPrefix}/lib/utils`,\r\n    },\r\n  }\r\n\r\n  return await resolveConfigPaths(cwd, config)\r\n}\r\n\r\nexport async function getProjectTailwindVersionFromConfig(config: {\r\n  resolvedPaths: Pick<Config[\"resolvedPaths\"], \"cwd\">\r\n}): Promise<TailwindVersion> {\r\n  if (!config.resolvedPaths?.cwd) {\r\n    return \"v3\";\r\n  }\r\n\r\n  const projectInfo = await getProjectInfo(config.resolvedPaths.cwd);\r\n\r\n  if (!projectInfo?.tailwindVersion) {\r\n    return null;\r\n  }\r\n\r\n  return projectInfo.tailwindVersion;\r\n}\r\n","export function isContentSame(\r\n  existingContent: string,\r\n  newContent: string,\r\n  options: {\r\n    ignoreImports?: boolean\r\n  } = {}\r\n) {\r\n  const { ignoreImports = false } = options\r\n\r\n  // Normalize line endings and whitespace.\r\n  const normalizedExisting = existingContent.replace(/\\r\\n/g, \"\\n\").trim()\r\n  const normalizedNew = newContent.replace(/\\r\\n/g, \"\\n\").trim()\r\n\r\n  // First, try exact match after normalization.\r\n  if (normalizedExisting === normalizedNew) {\r\n    return true\r\n  }\r\n\r\n  // If not ignoring imports or exact match failed, return false\r\n  if (!ignoreImports) {\r\n    return false\r\n  }\r\n\r\n  // Compare with import statements normalized.\r\n  // This regex matches various import patterns including:\r\n  // - import defaultExport from \"module\"\r\n  // - import * as name from \"module\"\r\n  // - import { export1, export2 } from \"module\"\r\n  // - import { export1 as alias1 } from \"module\"\r\n  // - import defaultExport, { export1 } from \"module\"\r\n  // - import type { Type } from \"module\"\r\n  // - This Regex written by Claude Code.\r\n  const importRegex =\r\n    /^(import\\s+(?:type\\s+)?(?:\\*\\s+as\\s+\\w+|\\{[^}]*\\}|\\w+)?(?:\\s*,\\s*(?:\\{[^}]*\\}|\\w+))?\\s+from\\s+[\"'])([^\"']+)([\"'])/gm\r\n\r\n  // Function to normalize import paths - remove alias differences.\r\n  const normalizeImports = (content: string) => {\r\n    return content.replace(\r\n      importRegex,\r\n      (_match, prefix, importPath, suffix) => {\r\n        // Keep relative imports as-is.\r\n        if (importPath.startsWith(\".\")) {\r\n          return `${prefix}${importPath}${suffix}`\r\n        }\r\n\r\n        // For aliased imports, normalize to a common format.\r\n        // Extract the last meaningful part of the path.\r\n        const parts = importPath.split(\"/\")\r\n        const lastPart = parts[parts.length - 1]\r\n\r\n        // Normalize to a consistent format.\r\n        return `${prefix}@normalized/${lastPart}${suffix}`\r\n      }\r\n    )\r\n  }\r\n\r\n  const existingNormalized = normalizeImports(normalizedExisting)\r\n  const newNormalized = normalizeImports(normalizedNew)\r\n\r\n  return existingNormalized === newNormalized\r\n}\r\n","import { existsSync } from \"fs\"\r\nimport path from \"path\"\r\n\r\nexport function isEnvFile(filePath: string) {\r\n  const fileName = path.basename(filePath)\r\n  return /^\\.env(\\.|$)/.test(fileName)\r\n}\r\n\r\n/**\r\n * Finds a file variant in the project.\r\n * TODO: abstract this to a more generic function.\r\n */\r\nexport function findExistingEnvFile(targetDir: string) {\r\n  const variants = [\r\n    \".env.local\",\r\n    \".env\",\r\n    \".env.development.local\",\r\n    \".env.development\",\r\n  ]\r\n\r\n  for (const variant of variants) {\r\n    const filePath = path.join(targetDir, variant)\r\n    if (existsSync(filePath)) {\r\n      return filePath\r\n    }\r\n  }\r\n\r\n  return null\r\n}\r\n\r\n/**\r\n * Parse .env content into key-value pairs.\r\n */\r\nexport function parseEnvContent(content: string) {\r\n  const lines = content.split(\"\\n\")\r\n  const env: Record<string, string> = {}\r\n\r\n  for (const line of lines) {\r\n    const trimmed = line.trim()\r\n\r\n    if (!trimmed || trimmed.startsWith(\"#\")) {\r\n      continue\r\n    }\r\n\r\n    // Find the first = and split there\r\n    const equalIndex = trimmed.indexOf(\"=\")\r\n    if (equalIndex === -1) {\r\n      continue\r\n    }\r\n\r\n    const key = trimmed.substring(0, equalIndex).trim()\r\n    const value = trimmed.substring(equalIndex + 1).trim()\r\n\r\n    if (key) {\r\n      env[key] = value.replace(/^[\"']|[\"']$/g, \"\")\r\n    }\r\n  }\r\n\r\n  return env\r\n}\r\n\r\n/**\r\n * Get the list of new keys that would be added when merging env content.\r\n */\r\nexport function getNewEnvKeys(existingContent: string, newContent: string) {\r\n  const existingEnv = parseEnvContent(existingContent)\r\n  const newEnv = parseEnvContent(newContent)\r\n\r\n  const newKeys = []\r\n  for (const key of Object.keys(newEnv)) {\r\n    if (!(key in existingEnv)) {\r\n      newKeys.push(key)\r\n    }\r\n  }\r\n\r\n  return newKeys\r\n}\r\n\r\n/**\r\n * Merge env content by appending ONLY new keys that don't exist in the existing content.\r\n * Existing keys are preserved with their original values.\r\n */\r\nexport function mergeEnvContent(existingContent: string, newContent: string) {\r\n  const existingEnv = parseEnvContent(existingContent)\r\n  const newEnv = parseEnvContent(newContent)\r\n\r\n  let result = existingContent.trimEnd()\r\n  if (result && !result.endsWith(\"\\n\")) {\r\n    result += \"\\n\"\r\n  }\r\n\r\n  const newKeys: string[] = []\r\n  for (const [key, value] of Object.entries(newEnv)) {\r\n    if (!(key in existingEnv)) {\r\n      newKeys.push(`${key}=${value}`)\r\n    }\r\n  }\r\n\r\n  if (newKeys.length > 0) {\r\n    if (result) {\r\n      result += \"\\n\"\r\n    }\r\n    result += newKeys.join(\"\\n\")\r\n    return result + \"\\n\"\r\n  }\r\n\r\n  // Ensure existing content ends with newline.\r\n  if (result && !result.endsWith(\"\\n\")) {\r\n    return result + \"\\n\"\r\n  }\r\n\r\n  return result\r\n}\r\n","import ora, { type Options } from \"ora\";\r\n\r\nexport function spinner(\r\n  text: Options[\"text\"],\r\n  options?: {\r\n    silent?: boolean\r\n  }\r\n) {\r\n  return ora({\r\n    text,\r\n    isSilent: options?.silent,\r\n  });\r\n}\r\n","import { registryBaseColorSchema } from \"@/src/schema\"\r\nimport { Transformer } from \"@/src/utils/transformers\"\r\nimport { ScriptKind, SyntaxKind } from \"ts-morph\"\r\nimport { z } from \"zod\"\r\n\r\nexport const transformCssVars: Transformer = async ({\r\n  sourceFile,\r\n  config,\r\n  baseColor,\r\n}) => {\r\n  // No transform if using css variables.\r\n  if (config.tailwind?.cssVariables || !baseColor?.inlineColors) {\r\n    return sourceFile\r\n  }\r\n\r\n  // Find jsx attributes with the name className.\r\n  // const openingElements = sourceFile.getDescendantsOfKind(SyntaxKind.JsxElement)\r\n  // console.log(openingElements)\r\n  // const jsxAttributes = sourceFile\r\n  //   .getDescendantsOfKind(SyntaxKind.JsxAttribute)\r\n  //   .filter((node) => node.getName() === \"className\")\r\n\r\n  // for (const jsxAttribute of jsxAttributes) {\r\n  //   const value = jsxAttribute.getInitializer()?.getText()\r\n  //   if (value) {\r\n  //     const valueWithColorMapping = applyColorMapping(\r\n  //       value.replace(/\"/g, \"\"),\r\n  //       baseColor.inlineColors\r\n  //     )\r\n  //     jsxAttribute.setInitializer(`\"${valueWithColorMapping}\"`)\r\n  //   }\r\n  // }\r\n  sourceFile.getDescendantsOfKind(SyntaxKind.StringLiteral).forEach((node) => {\r\n    const raw = node.getLiteralText()\r\n    const mapped = applyColorMapping(raw, baseColor.inlineColors).trim()\r\n    if (mapped !== raw) {\r\n      node.setLiteralValue(mapped)\r\n    }\r\n  })\r\n\r\n  return sourceFile\r\n}\r\n\r\n// export default function transformer(file: FileInfo, api: API) {\r\n//   const j = api.jscodeshift.withParser(\"tsx\")\r\n\r\n//   // Replace bg-background with \"bg-white dark:bg-slate-950\"\r\n//   const $j = j(file.source)\r\n//   return $j\r\n//     .find(j.JSXAttribute, {\r\n//       name: {\r\n//         name: \"className\",\r\n//       },\r\n//     })\r\n//     .forEach((path) => {\r\n//       const { node } = path\r\n//       if (node?.value?.type) {\r\n//         if (node.value.type === \"StringLiteral\") {\r\n//           node.value.value = applyColorMapping(node.value.value)\r\n//           console.log(node.value.value)\r\n//         }\r\n\r\n//         if (\r\n//           node.value.type === \"JSXExpressionContainer\" &&\r\n//           node.value.expression.type === \"CallExpression\"\r\n//         ) {\r\n//           const callee = node.value.expression.callee\r\n//           if (callee.type === \"Identifier\" && callee.name === \"cn\") {\r\n//             node.value.expression.arguments.forEach((arg) => {\r\n//               if (arg.type === \"StringLiteral\") {\r\n//                 arg.value = applyColorMapping(arg.value)\r\n//               }\r\n\r\n//               if (\r\n//                 arg.type === \"LogicalExpression\" &&\r\n//                 arg.right.type === \"StringLiteral\"\r\n//               ) {\r\n//                 arg.right.value = applyColorMapping(arg.right.value)\r\n//               }\r\n//             })\r\n//           }\r\n//         }\r\n//       }\r\n//     })\r\n//     .toSource()\r\n// }\r\n\r\n// // export function splitClassName(input: string): (string | null)[] {\r\n// //   const parts = input.split(\":\")\r\n// //   const classNames = parts.map((part) => {\r\n// //     const match = part.match(/^\\[?(.+)\\]$/)\r\n// //     if (match) {\r\n// //       return match[1]\r\n// //     } else {\r\n// //       return null\r\n// //     }\r\n// //   })\r\n\r\n// //   return classNames\r\n// // }\r\n\r\n// Splits a className into variant-name-alpha.\r\n// eg. hover:bg-primary-100 -> [hover, bg-primary, 100]\r\nexport function splitClassName(className: string): (string | null)[] {\r\n  if (!className.includes(\"/\") && !className.includes(\":\")) {\r\n    return [null, className, null]\r\n  }\r\n\r\n  const parts: (string | null)[] = []\r\n  // First we split to find the alpha.\r\n  let [rest, alpha] = className.split(\"/\")\r\n\r\n  // Check if rest has a colon.\r\n  if (!rest.includes(\":\")) {\r\n    return [null, rest, alpha]\r\n  }\r\n\r\n  // Next we split the rest by the colon.\r\n  const split = rest.split(\":\")\r\n\r\n  // We take the last item from the split as the name.\r\n  const name = split.pop()\r\n\r\n  // We glue back the rest of the split.\r\n  const variant = split.join(\":\")\r\n\r\n  // Finally we push the variant, name and alpha.\r\n  parts.push(variant ?? null, name ?? null, alpha ?? null)\r\n\r\n  return parts\r\n}\r\n\r\nconst PREFIXES = [\"bg-\", \"text-\", \"border-\", \"ring-offset-\", \"ring-\"]\r\n\r\nexport function applyColorMapping(\r\n  input: string,\r\n  mapping: z.infer<typeof registryBaseColorSchema>[\"inlineColors\"]\r\n) {\r\n  // Handle border classes.\r\n  if (input.includes(\" border \")) {\r\n    input = input.replace(\" border \", \" border border-border \")\r\n  }\r\n\r\n  // Build color mappings.\r\n  const classNames = input.split(\" \")\r\n  const lightMode = new Set<string>()\r\n  const darkMode = new Set<string>()\r\n  for (let className of classNames) {\r\n    const [variant, value, modifier] = splitClassName(className)\r\n    const prefix = PREFIXES.find((prefix) => value?.startsWith(prefix))\r\n    if (!prefix) {\r\n      if (!lightMode.has(className)) {\r\n        lightMode.add(className)\r\n      }\r\n      continue\r\n    }\r\n\r\n    const needle = value?.replace(prefix, \"\")\r\n    if (needle && needle in mapping.light) {\r\n      lightMode.add(\r\n        [variant, `${prefix}${mapping.light[needle]}`]\r\n          .filter(Boolean)\r\n          .join(\":\") + (modifier ? `/${modifier}` : \"\")\r\n      )\r\n\r\n      darkMode.add(\r\n        [\"dark\", variant, `${prefix}${mapping.dark[needle]}`]\r\n          .filter(Boolean)\r\n          .join(\":\") + (modifier ? `/${modifier}` : \"\")\r\n      )\r\n      continue\r\n    }\r\n\r\n    if (!lightMode.has(className)) {\r\n      lightMode.add(className)\r\n    }\r\n  }\r\n\r\n  return [...Array.from(lightMode), ...Array.from(darkMode)].join(\" \").trim()\r\n}\r\n","export const ICON_LIBRARIES = {\r\n  lucide: {\r\n    name: \"lucide-react\",\r\n    package: \"lucide-react\",\r\n    import: \"lucide-react\",\r\n  },\r\n  radix: {\r\n    name: \"@radix-ui/react-icons\",\r\n    package: \"@radix-ui/react-icons\",\r\n    import: \"@radix-ui/react-icons\",\r\n  },\r\n}\r\n","import { getRegistryIcons } from \"@/src/registry/api\"\r\nimport { ICON_LIBRARIES } from \"@/src/utils/icon-libraries\"\r\nimport { Transformer } from \"@/src/utils/transformers\"\r\nimport { SourceFile, SyntaxKind } from \"ts-morph\"\r\n\r\n// Lucide is the default icon library in the registry.\r\nconst SOURCE_LIBRARY = \"lucide\"\r\n\r\nexport const transformIcons: Transformer = async ({ sourceFile, config }) => {\r\n  // No transform if we cannot read the icon library.\r\n  if (!config.iconLibrary || !(config.iconLibrary in ICON_LIBRARIES)) {\r\n    return sourceFile\r\n  }\r\n\r\n  const registryIcons = await getRegistryIcons()\r\n  const sourceLibrary = SOURCE_LIBRARY\r\n  const targetLibrary = config.iconLibrary\r\n\r\n  if (sourceLibrary === targetLibrary) {\r\n    return sourceFile\r\n  }\r\n\r\n  let targetedIcons: string[] = []\r\n  for (const importDeclaration of sourceFile.getImportDeclarations() ?? []) {\r\n    if (\r\n      importDeclaration.getModuleSpecifier()?.getText() !==\r\n      `\"${ICON_LIBRARIES[SOURCE_LIBRARY].import}\"`\r\n    ) {\r\n      continue\r\n    }\r\n\r\n    for (const specifier of importDeclaration.getNamedImports() ?? []) {\r\n      const iconName = specifier.getName()\r\n\r\n      const targetedIcon = registryIcons[iconName]?.[targetLibrary]\r\n\r\n      if (!targetedIcon || targetedIcons.includes(targetedIcon)) {\r\n        continue\r\n      }\r\n\r\n      targetedIcons.push(targetedIcon)\r\n\r\n      // Remove the named import.\r\n      specifier.remove()\r\n\r\n      // Replace with the targeted icon.\r\n      sourceFile\r\n        .getDescendantsOfKind(SyntaxKind.JsxSelfClosingElement)\r\n        .filter((node) => node.getTagNameNode()?.getText() === iconName)\r\n        .forEach((node) => node.getTagNameNode()?.replaceWithText(targetedIcon))\r\n    }\r\n\r\n    // If the named import is empty, remove the import declaration.\r\n    if (importDeclaration.getNamedImports()?.length === 0) {\r\n      importDeclaration.remove()\r\n    }\r\n  }\r\n\r\n  if (targetedIcons.length > 0) {\r\n    const iconImportDeclaration = sourceFile.addImportDeclaration({\r\n      moduleSpecifier:\r\n        ICON_LIBRARIES[targetLibrary as keyof typeof ICON_LIBRARIES]?.import,\r\n      namedImports: targetedIcons.map((icon) => ({\r\n        name: icon,\r\n      })),\r\n    })\r\n\r\n    if (!_useSemicolon(sourceFile)) {\r\n      iconImportDeclaration.replaceWithText(\r\n        iconImportDeclaration.getText().replace(\";\", \"\")\r\n      )\r\n    }\r\n  }\r\n\r\n  return sourceFile\r\n}\r\n\r\nfunction _useSemicolon(sourceFile: SourceFile) {\r\n  return (\r\n    sourceFile.getImportDeclarations()?.[0]?.getText().endsWith(\";\") ?? false\r\n  )\r\n}\r\n","import { Config } from \"@/src/utils/get-config\"\r\nimport { Transformer } from \"@/src/utils/transformers\"\r\nimport { SyntaxKind } from \"ts-morph\"\r\n\r\nexport const transformImport: Transformer = async ({\r\n  sourceFile,\r\n  config,\r\n  isRemote,\r\n}) => {\r\n  const utilsAlias = config.aliases?.utils\r\n  const workspaceAlias =\r\n    typeof utilsAlias === \"string\" && utilsAlias.includes(\"/\")\r\n      ? utilsAlias.split(\"/\")[0]\r\n      : \"@\"\r\n  const utilsImport = `${workspaceAlias}/lib/utils`\r\n\r\n  if (![\".tsx\", \".ts\", \".jsx\", \".js\"].includes(sourceFile.getExtension())) {\r\n    return sourceFile\r\n  }\r\n\r\n  for (const specifier of sourceFile.getImportStringLiterals()) {\r\n    const updated = updateImportAliases(\r\n      specifier.getLiteralValue(),\r\n      config,\r\n      isRemote\r\n    )\r\n    specifier.setLiteralValue(updated)\r\n\r\n    // Replace `import { cn } from \"@/lib/utils\"`\r\n    if (utilsImport === updated || updated === \"@/lib/utils\") {\r\n      const importDeclaration = specifier.getFirstAncestorByKind(\r\n        SyntaxKind.ImportDeclaration\r\n      )\r\n      const isCnImport = importDeclaration\r\n        ?.getNamedImports()\r\n        .some((namedImport) => namedImport.getName() === \"cn\")\r\n\r\n      if (!isCnImport || !config.aliases.utils) {\r\n        continue\r\n      }\r\n\r\n      specifier.setLiteralValue(\r\n        utilsImport === updated\r\n          ? updated.replace(utilsImport, config.aliases.utils)\r\n          : config.aliases.utils\r\n      )\r\n    }\r\n  }\r\n\r\n  return sourceFile\r\n}\r\n\r\nfunction updateImportAliases(\r\n  moduleSpecifier: string,\r\n  config: Config,\r\n  isRemote: boolean = false\r\n) {\r\n  // Not a local import.\r\n  if (!moduleSpecifier.startsWith(\"@/\") && !isRemote) {\r\n    return moduleSpecifier\r\n  }\r\n\r\n  // This treats the remote as coming from a faux registry.\r\n  if (isRemote && moduleSpecifier.startsWith(\"@/\")) {\r\n    moduleSpecifier = moduleSpecifier.replace(/^@\\//, `@/registry/new-york/`)\r\n  }\r\n\r\n  // Not a registry import.\r\n  if (!moduleSpecifier.startsWith(\"@/registry/\")) {\r\n    // We fix the alias and return.\r\n    const alias = config.aliases.components.split(\"/\")[0]\r\n    return moduleSpecifier.replace(/^@\\//, `${alias}/`)\r\n  }\r\n\r\n  if (moduleSpecifier.match(/^@\\/registry\\/(.+)\\/ui/)) {\r\n    return moduleSpecifier.replace(\r\n      /^@\\/registry\\/(.+)\\/ui/,\r\n      config.aliases.ui ?? `${config.aliases.components}/ui`\r\n    )\r\n  }\r\n\r\n  if (\r\n    config.aliases.components &&\r\n    moduleSpecifier.match(/^@\\/registry\\/(.+)\\/components/)\r\n  ) {\r\n    return moduleSpecifier.replace(\r\n      /^@\\/registry\\/(.+)\\/components/,\r\n      config.aliases.components\r\n    )\r\n  }\r\n\r\n  if (config.aliases.lib && moduleSpecifier.match(/^@\\/registry\\/(.+)\\/lib/)) {\r\n    return moduleSpecifier.replace(\r\n      /^@\\/registry\\/(.+)\\/lib/,\r\n      config.aliases.lib\r\n    )\r\n  }\r\n\r\n  if (\r\n    config.aliases.hooks &&\r\n    moduleSpecifier.match(/^@\\/registry\\/(.+)\\/hooks/)\r\n  ) {\r\n    return moduleSpecifier.replace(\r\n      /^@\\/registry\\/(.+)\\/hooks/,\r\n      config.aliases.hooks\r\n    )\r\n  }\r\n\r\n  return moduleSpecifier.replace(\r\n    /^@\\/registry\\/[^/]+/,\r\n    config.aliases.components\r\n  )\r\n}\r\n","import { type Transformer } from \"@/src/utils/transformers\"\r\nimport { transformFromAstSync } from \"@babel/core\"\r\nimport { ParserOptions, parse } from \"@babel/parser\"\r\n// @ts-ignore\r\nimport transformTypescript from \"@babel/plugin-transform-typescript\"\r\nimport * as recast from \"recast\"\r\n\r\n// TODO.\r\n// I'm using recast for the AST here.\r\n// Figure out if ts-morph AST is compatible with Babel.\r\n\r\n// This is a copy of the babel options from recast/parser.\r\n// The goal here is to tolerate as much syntax as possible.\r\n// We want to be able to parse any valid tsx code.\r\n// See https://github.com/benjamn/recast/blob/master/parsers/_babel_options.ts.\r\nconst PARSE_OPTIONS: ParserOptions = {\r\n  sourceType: \"module\",\r\n  allowImportExportEverywhere: true,\r\n  allowReturnOutsideFunction: true,\r\n  startLine: 1,\r\n  tokens: true,\r\n  plugins: [\r\n    \"asyncGenerators\",\r\n    \"bigInt\",\r\n    \"classPrivateMethods\",\r\n    \"classPrivateProperties\",\r\n    \"classProperties\",\r\n    \"classStaticBlock\",\r\n    \"decimal\",\r\n    \"decorators-legacy\",\r\n    \"doExpressions\",\r\n    \"dynamicImport\",\r\n    \"exportDefaultFrom\",\r\n    \"exportNamespaceFrom\",\r\n    \"functionBind\",\r\n    \"functionSent\",\r\n    \"importAssertions\",\r\n    \"importMeta\",\r\n    \"nullishCoalescingOperator\",\r\n    \"numericSeparator\",\r\n    \"objectRestSpread\",\r\n    \"optionalCatchBinding\",\r\n    \"optionalChaining\",\r\n    [\r\n      \"pipelineOperator\",\r\n      {\r\n        proposal: \"minimal\",\r\n      },\r\n    ],\r\n    [\r\n      \"recordAndTuple\",\r\n      {\r\n        syntaxType: \"hash\",\r\n      },\r\n    ],\r\n    \"throwExpressions\",\r\n    \"topLevelAwait\",\r\n    \"v8intrinsic\",\r\n    \"typescript\",\r\n    \"jsx\",\r\n  ],\r\n}\r\n\r\nexport const transformJsx: Transformer<string> = async ({\r\n  sourceFile,\r\n  config,\r\n}) => {\r\n  const output = sourceFile.getFullText()\r\n\r\n  if (config.tsx) {\r\n    return output\r\n  }\r\n\r\n  const ast = recast.parse(output, {\r\n    parser: {\r\n      parse: (code: string) => {\r\n        return parse(code, PARSE_OPTIONS)\r\n      },\r\n    },\r\n  })\r\n\r\n  const result = transformFromAstSync(ast, output, {\r\n    cloneInputAst: false,\r\n    code: false,\r\n    ast: true,\r\n    plugins: [transformTypescript],\r\n    configFile: false,\r\n  })\r\n\r\n  if (!result || !result.ast) {\r\n    throw new Error(\"Failed to transform JSX\")\r\n  }\r\n\r\n  return recast.print(result.ast).code\r\n}\r\n","import { Transformer } from \"@/src/utils/transformers\"\r\nimport { SyntaxKind } from \"ts-morph\"\r\n\r\nconst directiveRegex = /^[\"']use client[\"']$/g\r\n\r\nexport const transformRsc: Transformer = async ({ sourceFile, config }) => {\r\n  if (config.rsc) {\r\n    return sourceFile\r\n  }\r\n\r\n  // Remove \"use client\" from the top of the file.\r\n  const first = sourceFile.getFirstChildByKind(SyntaxKind.ExpressionStatement)\r\n  if (first && directiveRegex.test(first.getText())) {\r\n    first.remove()\r\n  }\r\n\r\n  return sourceFile\r\n}\r\n","import { Transformer } from \"@/src/utils/transformers\"\r\nimport { SyntaxKind } from \"ts-morph\"\r\n\r\nimport {\r\n  TailwindVersion,\r\n  getProjectTailwindVersionFromConfig,\r\n} from \"../get-project-info\"\r\nimport { splitClassName } from \"./transform-css-vars\"\r\n\r\nexport const transformTwPrefixes: Transformer = async ({\r\n  sourceFile,\r\n  config,\r\n}) => {\r\n  if (!config.tailwind?.prefix) {\r\n    return sourceFile\r\n  }\r\n  const tailwindVersion = await getProjectTailwindVersionFromConfig(config)\r\n\r\n  // Find the cva function calls.\r\n  sourceFile\r\n    .getDescendantsOfKind(SyntaxKind.CallExpression)\r\n    .filter((node) => node.getExpression().getText() === \"cva\")\r\n    .forEach((node) => {\r\n      // cva(base, ...)\r\n      if (node.getArguments()[0]?.isKind(SyntaxKind.StringLiteral)) {\r\n        const defaultClassNames = node.getArguments()[0]\r\n        if (defaultClassNames) {\r\n          defaultClassNames.replaceWithText(\r\n            `\"${applyPrefix(\r\n              defaultClassNames.getText()?.replace(/\"|'/g, \"\"),\r\n              config.tailwind.prefix,\r\n              tailwindVersion\r\n            )}\"`\r\n          )\r\n        }\r\n      }\r\n\r\n      // cva(..., { variants: { ... } })\r\n      if (node.getArguments()[1]?.isKind(SyntaxKind.ObjectLiteralExpression)) {\r\n        node\r\n          .getArguments()[1]\r\n          ?.getDescendantsOfKind(SyntaxKind.PropertyAssignment)\r\n          .find((node) => node.getName() === \"variants\")\r\n          ?.getDescendantsOfKind(SyntaxKind.PropertyAssignment)\r\n          .forEach((node) => {\r\n            node\r\n              .getDescendantsOfKind(SyntaxKind.PropertyAssignment)\r\n              .forEach((node) => {\r\n                const classNames = node.getInitializerIfKind(\r\n                  SyntaxKind.StringLiteral\r\n                )\r\n                if (classNames) {\r\n                  classNames?.replaceWithText(\r\n                    `\"${applyPrefix(\r\n                      classNames.getText()?.replace(/\"|'/g, \"\"),\r\n                      config.tailwind.prefix,\r\n                      tailwindVersion\r\n                    )}\"`\r\n                  )\r\n                }\r\n              })\r\n          })\r\n      }\r\n    })\r\n\r\n  // Find all jsx attributes with the name className.\r\n  sourceFile.getDescendantsOfKind(SyntaxKind.JsxAttribute).forEach((node) => {\r\n    if (node.getNameNode().getText() === \"className\") {\r\n      // className=\"...\"\r\n      if (node.getInitializer()?.isKind(SyntaxKind.StringLiteral)) {\r\n        const value = node.getInitializer()\r\n        if (value) {\r\n          value.replaceWithText(\r\n            `\"${applyPrefix(\r\n              value.getText()?.replace(/\"|'/g, \"\"),\r\n              config.tailwind.prefix,\r\n              tailwindVersion\r\n            )}\"`\r\n          )\r\n        }\r\n      }\r\n\r\n      // className={...}\r\n      if (node.getInitializer()?.isKind(SyntaxKind.JsxExpression)) {\r\n        // Check if it's a call to cn().\r\n        const callExpression = node\r\n          .getInitializer()\r\n          ?.getDescendantsOfKind(SyntaxKind.CallExpression)\r\n          .find((node) => node.getExpression().getText() === \"cn\")\r\n        if (callExpression) {\r\n          // Loop through the arguments.\r\n          callExpression.getArguments().forEach((node) => {\r\n            if (\r\n              node.isKind(SyntaxKind.ConditionalExpression) ||\r\n              node.isKind(SyntaxKind.BinaryExpression)\r\n            ) {\r\n              node\r\n                .getChildrenOfKind(SyntaxKind.StringLiteral)\r\n                .forEach((node) => {\r\n                  node.replaceWithText(\r\n                    `\"${applyPrefix(\r\n                      node.getText()?.replace(/\"|'/g, \"\"),\r\n                      config.tailwind.prefix,\r\n                      tailwindVersion\r\n                    )}\"`\r\n                  )\r\n                })\r\n            }\r\n\r\n            if (node.isKind(SyntaxKind.StringLiteral)) {\r\n              node.replaceWithText(\r\n                `\"${applyPrefix(\r\n                  node.getText()?.replace(/\"|'/g, \"\"),\r\n                  config.tailwind.prefix,\r\n                  tailwindVersion\r\n                )}\"`\r\n              )\r\n            }\r\n          })\r\n        }\r\n      }\r\n    }\r\n\r\n    // classNames={...}\r\n    if (node.getNameNode().getText() === \"classNames\") {\r\n      if (node.getInitializer()?.isKind(SyntaxKind.JsxExpression)) {\r\n        node\r\n          .getDescendantsOfKind(SyntaxKind.PropertyAssignment)\r\n          .forEach((node) => {\r\n            if (node.getInitializer()?.isKind(SyntaxKind.CallExpression)) {\r\n              const callExpression = node.getInitializerIfKind(\r\n                SyntaxKind.CallExpression\r\n              )\r\n              if (callExpression) {\r\n                // Loop through the arguments.\r\n                callExpression.getArguments().forEach((arg) => {\r\n                  if (arg.isKind(SyntaxKind.ConditionalExpression)) {\r\n                    arg\r\n                      .getChildrenOfKind(SyntaxKind.StringLiteral)\r\n                      .forEach((node) => {\r\n                        node.replaceWithText(\r\n                          `\"${applyPrefix(\r\n                            node.getText()?.replace(/\"|'/g, \"\"),\r\n                            config.tailwind.prefix,\r\n                            tailwindVersion\r\n                          )}\"`\r\n                        )\r\n                      })\r\n                  }\r\n\r\n                  if (arg.isKind(SyntaxKind.StringLiteral)) {\r\n                    arg.replaceWithText(\r\n                      `\"${applyPrefix(\r\n                        arg.getText()?.replace(/\"|'/g, \"\"),\r\n                        config.tailwind.prefix,\r\n                        tailwindVersion\r\n                      )}\"`\r\n                    )\r\n                  }\r\n                })\r\n              }\r\n            }\r\n\r\n            if (node.getInitializer()?.isKind(SyntaxKind.StringLiteral)) {\r\n              if (node.getNameNode().getText() !== \"variant\") {\r\n                const classNames = node.getInitializer()\r\n                if (classNames) {\r\n                  classNames.replaceWithText(\r\n                    `\"${applyPrefix(\r\n                      classNames.getText()?.replace(/\"|'/g, \"\"),\r\n                      config.tailwind.prefix,\r\n                      tailwindVersion\r\n                    )}\"`\r\n                  )\r\n                }\r\n              }\r\n            }\r\n          })\r\n      }\r\n    }\r\n  })\r\n\r\n  return sourceFile\r\n}\r\n\r\nexport function applyPrefix(\r\n  input: string,\r\n  prefix: string = \"\",\r\n  tailwindVersion: TailwindVersion\r\n) {\r\n  if (tailwindVersion === \"v3\") {\r\n    return input\r\n      .split(\" \")\r\n      .map((className) => {\r\n        const [variant, value, modifier] = splitClassName(className)\r\n        if (variant) {\r\n          return modifier\r\n            ? `${variant}:${prefix}${value}/${modifier}`\r\n            : `${variant}:${prefix}${value}`\r\n        } else {\r\n          return modifier\r\n            ? `${prefix}${value}/${modifier}`\r\n            : `${prefix}${value}`\r\n        }\r\n      })\r\n      .join(\" \")\r\n  }\r\n\r\n  return input\r\n    .split(\" \")\r\n    .map((className) =>\r\n      className.indexOf(`${prefix}:`) === 0\r\n        ? className\r\n        : `${prefix}:${className.trim()}`\r\n    )\r\n    .join(\" \")\r\n}\r\n\r\nexport function applyPrefixesCss(\r\n  css: string,\r\n  prefix: string,\r\n  tailwindVersion: TailwindVersion\r\n) {\r\n  const lines = css.split(\"\\n\")\r\n  for (let line of lines) {\r\n    if (line.includes(\"@apply\")) {\r\n      const originalTWCls = line.replace(\"@apply\", \"\").trim()\r\n      const prefixedTwCls = applyPrefix(originalTWCls, prefix, tailwindVersion)\r\n      css = css.replace(originalTWCls, prefixedTwCls)\r\n    }\r\n  }\r\n  return css\r\n}\r\n","import { registryBaseColorSchema } from \"@/src/schema\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\nimport { transformCssVars } from \"@/src/utils/transformers/transform-css-vars\"\r\nimport { transformIcons } from \"@/src/utils/transformers/transform-icons\"\r\nimport { transformImport } from \"@/src/utils/transformers/transform-import\"\r\nimport { transformJsx } from \"@/src/utils/transformers/transform-jsx\"\r\nimport { transformRsc } from \"@/src/utils/transformers/transform-rsc\"\r\nimport { promises as fs } from \"fs\"\r\nimport { tmpdir } from \"os\"\r\nimport path from \"path\"\r\nimport { Project, ScriptKind, type SourceFile } from \"ts-morph\"\r\nimport { z } from \"zod\"\r\n\r\nimport { transformTwPrefixes } from \"./transform-tw-prefix\"\r\n\r\nexport type TransformOpts = {\r\n  filename: string\r\n  raw: string\r\n  config: Config\r\n  baseColor?: z.infer<typeof registryBaseColorSchema>\r\n  transformJsx?: boolean\r\n  isRemote?: boolean\r\n}\r\n\r\nexport type Transformer<Output = SourceFile> = (\r\n  opts: TransformOpts & {\r\n    sourceFile: SourceFile\r\n  }\r\n) => Promise<Output>\r\n\r\nconst project = new Project({\r\n  compilerOptions: {},\r\n})\r\n\r\nasync function createTempSourceFile(filename: string) {\r\n  const dir = await fs.mkdtemp(path.join(tmpdir(), \"uidesu-\"))\r\n  return path.join(dir, filename)\r\n}\r\n\r\nexport async function transform(\r\n  opts: TransformOpts,\r\n  transformers: Transformer[] = [\r\n    transformImport,\r\n    transformRsc,\r\n    transformCssVars,\r\n    transformTwPrefixes,\r\n    transformIcons,\r\n  ]\r\n) {\r\n  const tempFile = await createTempSourceFile(opts.filename)\r\n  const sourceFile = project.createSourceFile(tempFile, opts.raw, {\r\n    scriptKind: ScriptKind.TSX,\r\n  })\r\n\r\n  for (const transformer of transformers) {\r\n    await transformer({ sourceFile, ...opts })\r\n  }\r\n\r\n  if (opts.transformJsx) {\r\n    return await transformJsx({\r\n      sourceFile,\r\n      ...opts,\r\n    })\r\n  }\r\n\r\n  return sourceFile.getText()\r\n}\r\n","import { Transformer } from \"@/src/utils/transformers\"\r\n\r\nexport const transformNext: Transformer = async ({ sourceFile }) => {\r\n  // export function middleware.\r\n  sourceFile.getFunctions().forEach((func) => {\r\n    if (func.getName() === \"middleware\") {\r\n      func.rename(\"proxy\")\r\n    }\r\n  })\r\n\r\n  // export const middleware.\r\n  sourceFile.getVariableDeclarations().forEach((variable) => {\r\n    if (variable.getName() === \"middleware\") {\r\n      variable.rename(\"proxy\")\r\n    }\r\n  })\r\n\r\n  // export { handler as middleware }.\r\n  sourceFile.getExportDeclarations().forEach((exportDecl) => {\r\n    const namedExports = exportDecl.getNamedExports()\r\n    namedExports.forEach((namedExport) => {\r\n      if (namedExport.getName() === \"middleware\") {\r\n        namedExport.setName(\"proxy\")\r\n      }\r\n      const aliasNode = namedExport.getAliasNode()\r\n      if (aliasNode?.getText() === \"middleware\") {\r\n        namedExport.setAlias(\"proxy\")\r\n      }\r\n    })\r\n  })\r\n\r\n  return sourceFile\r\n}\r\n","import { getRegistryBaseColor } from \"@/src/registry/api\"\r\nimport { RegistryItem, registryItemFileSchema } from \"@/src/schema\"\r\nimport { isContentSame } from \"@/src/utils/compare\"\r\nimport {\r\n  findExistingEnvFile,\r\n  getNewEnvKeys,\r\n  isEnvFile,\r\n  mergeEnvContent,\r\n  parseEnvContent,\r\n} from \"@/src/utils/env-helpers\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\nimport { ProjectInfo, getProjectInfo } from \"@/src/utils/get-project-info\"\r\nimport { highlighter } from \"@/src/utils/highlighter\"\r\nimport { logger } from \"@/src/utils/logger\"\r\nimport { resolveImport } from \"@/src/utils/resolve-import\"\r\nimport { spinner } from \"@/src/utils/spinner\"\r\nimport { transform } from \"@/src/utils/transformers\"\r\nimport { transformCssVars } from \"@/src/utils/transformers/transform-css-vars\"\r\nimport { transformIcons } from \"@/src/utils/transformers/transform-icons\"\r\nimport { transformImport } from \"@/src/utils/transformers/transform-import\"\r\nimport { transformNext } from \"@/src/utils/transformers/transform-next\"\r\nimport { transformRsc } from \"@/src/utils/transformers/transform-rsc\"\r\nimport { transformTwPrefixes } from \"@/src/utils/transformers/transform-tw-prefix\"\r\nimport { existsSync, promises as fs, statSync } from \"fs\"\r\nimport { tmpdir } from \"os\"\r\nimport path, { basename } from \"path\"\r\nimport prompts from \"prompts\"\r\nimport { Project, ScriptKind } from \"ts-morph\"\r\nimport { loadConfig } from \"tsconfig-paths\"\r\nimport { z } from \"zod\"\r\n\r\nexport async function updateFiles(\r\n  files: RegistryItem[\"files\"],\r\n  config: Config,\r\n  options: {\r\n    overwrite?: boolean\r\n    force?: boolean\r\n    silent?: boolean\r\n    rootSpinner?: ReturnType<typeof spinner>\r\n    isRemote?: boolean\r\n    isWorkspace?: boolean\r\n    path?: string\r\n  }\r\n) {\r\n  if (!files?.length) {\r\n    return {\r\n      filesCreated: [],\r\n      filesUpdated: [],\r\n      filesSkipped: [],\r\n    }\r\n  }\r\n  options = {\r\n    overwrite: false,\r\n    force: false,\r\n    silent: false,\r\n    isRemote: false,\r\n    isWorkspace: false,\r\n    ...options,\r\n  }\r\n  const filesCreatedSpinner = spinner(`Updating files.`, {\r\n    silent: options.silent,\r\n  })?.start()\r\n\r\n  const [projectInfo, baseColor] = await Promise.all([\r\n    getProjectInfo(config.resolvedPaths.cwd),\r\n    config.tailwind.baseColor\r\n      ? getRegistryBaseColor(config.tailwind.baseColor)\r\n      : Promise.resolve(undefined),\r\n  ])\r\n\r\n  let filesCreated: string[] = []\r\n  let filesUpdated: string[] = []\r\n  let filesSkipped: string[] = []\r\n  let envVarsAdded: string[] = []\r\n  let envFile: string | null = null\r\n\r\n  for (let index = 0; index < files.length; index++) {\r\n    const file = files[index]\r\n    if (!file.content) {\r\n      continue\r\n    }\r\n\r\n    let filePath = resolveFilePath(file, config, {\r\n      isSrcDir: projectInfo?.isSrcDir,\r\n      framework: projectInfo?.framework.name,\r\n      commonRoot: findCommonRoot(\r\n        files.map((f) => f.path),\r\n        file.path\r\n      ),\r\n      path: options.path,\r\n      fileIndex: index,\r\n    })\r\n\r\n    if (!filePath) {\r\n      continue\r\n    }\r\n\r\n    const fileName = basename(file.path)\r\n    const targetDir = path.dirname(filePath)\r\n\r\n    if (!config.tsx) {\r\n      filePath = filePath.replace(/\\.tsx?$/, (match) =>\r\n        match === \".tsx\" ? \".jsx\" : \".js\"\r\n      )\r\n    }\r\n\r\n    if (isEnvFile(filePath) && !existsSync(filePath)) {\r\n      const alternativeEnvFile = findExistingEnvFile(targetDir)\r\n      if (alternativeEnvFile) {\r\n        filePath = alternativeEnvFile\r\n      }\r\n    }\r\n\r\n    const existingFile = existsSync(filePath)\r\n\r\n    // Check if the path exists and is a directory - we can't write to directories.\r\n    if (existingFile && statSync(filePath).isDirectory()) {\r\n      throw new Error(\r\n        `Cannot write to ${filePath}: path exists and is a directory. Please provide a file path instead.`\r\n      )\r\n    }\r\n\r\n    // Run our transformers.\r\n    // Skip transformers for .env files to preserve exact content\r\n    const content = isEnvFile(filePath)\r\n      ? file.content\r\n      : await transform(\r\n          {\r\n            filename: file.path,\r\n            raw: file.content,\r\n            config,\r\n            baseColor,\r\n            transformJsx: !config.tsx,\r\n            isRemote: options.isRemote,\r\n          },\r\n          [\r\n            transformImport,\r\n            transformRsc,\r\n            transformCssVars,\r\n            transformTwPrefixes,\r\n            transformIcons,\r\n            ...(_isNext16Middleware(filePath, projectInfo, config)\r\n              ? [transformNext]\r\n              : []),\r\n          ]\r\n        )\r\n\r\n    // Skip the file if it already exists and the content is the same.\r\n    // Exception: Don't skip .env files as we merge content instead of replacing\r\n    if (existingFile && !isEnvFile(filePath)) {\r\n      const existingFileContent = await fs.readFile(filePath, \"utf-8\")\r\n\r\n      if (\r\n        isContentSame(existingFileContent, content, {\r\n          // Ignore import differences for workspace components.\r\n          // TODO: figure out if we always want this.\r\n          ignoreImports: options.isWorkspace,\r\n        })\r\n      ) {\r\n        filesSkipped.push(path.relative(config.resolvedPaths.cwd, filePath))\r\n        continue\r\n      }\r\n    }\r\n\r\n    // Skip overwrite prompt for .env files - we'll handle them specially\r\n    if (existingFile && !options.overwrite && !isEnvFile(filePath)) {\r\n      filesCreatedSpinner.stop()\r\n      if (options.rootSpinner) {\r\n        options.rootSpinner.stop()\r\n      }\r\n      const { overwrite } = await prompts({\r\n        type: \"confirm\",\r\n        name: \"overwrite\",\r\n        message: `The file ${highlighter.info(\r\n          fileName\r\n        )} already exists. Would you like to overwrite?`,\r\n        initial: false,\r\n      })\r\n\r\n      if (!overwrite) {\r\n        filesSkipped.push(path.relative(config.resolvedPaths.cwd, filePath))\r\n        if (options.rootSpinner) {\r\n          options.rootSpinner.start()\r\n        }\r\n        continue\r\n      }\r\n      filesCreatedSpinner?.start()\r\n      if (options.rootSpinner) {\r\n        options.rootSpinner.start()\r\n      }\r\n    }\r\n\r\n    // Rename middleware.ts to proxy.ts for Next.js 16+.\r\n    if (_isNext16Middleware(filePath, projectInfo, config)) {\r\n      filePath = filePath.replace(/middleware\\.(ts|js)$/, \"proxy.$1\")\r\n    }\r\n\r\n    // Create the target directory if it doesn't exist.\r\n    if (!existsSync(targetDir)) {\r\n      await fs.mkdir(targetDir, { recursive: true })\r\n    }\r\n\r\n    // Special handling for .env files - append only new keys\r\n    if (isEnvFile(filePath) && existingFile) {\r\n      const existingFileContent = await fs.readFile(filePath, \"utf-8\")\r\n      const mergedContent = mergeEnvContent(existingFileContent, content)\r\n      envVarsAdded = getNewEnvKeys(existingFileContent, content)\r\n      envFile = path.relative(config.resolvedPaths.cwd, filePath)\r\n\r\n      if (!envVarsAdded.length) {\r\n        filesSkipped.push(path.relative(config.resolvedPaths.cwd, filePath))\r\n        continue\r\n      }\r\n\r\n      await fs.writeFile(filePath, mergedContent, \"utf-8\")\r\n      filesUpdated.push(path.relative(config.resolvedPaths.cwd, filePath))\r\n      continue\r\n    }\r\n\r\n    await fs.writeFile(filePath, content, \"utf-8\")\r\n\r\n    // Handle file creation logging\r\n    if (!existingFile) {\r\n      filesCreated.push(path.relative(config.resolvedPaths.cwd, filePath))\r\n\r\n      if (isEnvFile(filePath)) {\r\n        envVarsAdded = Object.keys(parseEnvContent(content))\r\n        envFile = path.relative(config.resolvedPaths.cwd, filePath)\r\n      }\r\n    } else {\r\n      filesUpdated.push(path.relative(config.resolvedPaths.cwd, filePath))\r\n    }\r\n  }\r\n\r\n  const allFiles = [...filesCreated, ...filesUpdated, ...filesSkipped]\r\n  const updatedFiles = await resolveImports(allFiles, config)\r\n\r\n  // Let's update filesUpdated with the updated files.\r\n  filesUpdated.push(...updatedFiles)\r\n\r\n  // If a file is in filesCreated and filesUpdated, we should remove it from filesUpdated.\r\n  filesUpdated = filesUpdated.filter((file) => !filesCreated.includes(file))\r\n\r\n  const hasUpdatedFiles = filesCreated.length || filesUpdated.length\r\n  if (!hasUpdatedFiles && !filesSkipped.length) {\r\n    filesCreatedSpinner?.info(\"No files updated.\")\r\n  }\r\n\r\n  // Remove duplicates.\r\n  filesCreated = Array.from(new Set(filesCreated))\r\n  filesUpdated = Array.from(new Set(filesUpdated))\r\n  filesSkipped = Array.from(new Set(filesSkipped))\r\n\r\n  if (filesCreated.length) {\r\n    filesCreatedSpinner?.succeed(\r\n      `Created ${filesCreated.length} ${\r\n        filesCreated.length === 1 ? \"file\" : \"files\"\r\n      }:`\r\n    )\r\n    if (!options.silent) {\r\n      for (const file of filesCreated) {\r\n        logger.log(`  - ${file}`)\r\n      }\r\n    }\r\n  } else {\r\n    filesCreatedSpinner?.stop()\r\n  }\r\n\r\n  if (filesUpdated.length) {\r\n    spinner(\r\n      `Updated ${filesUpdated.length} ${\r\n        filesUpdated.length === 1 ? \"file\" : \"files\"\r\n      }:`,\r\n      {\r\n        silent: options.silent,\r\n      }\r\n    )?.info()\r\n    if (!options.silent) {\r\n      for (const file of filesUpdated) {\r\n        logger.log(`  - ${file}`)\r\n      }\r\n    }\r\n  }\r\n\r\n  if (filesSkipped.length) {\r\n    spinner(\r\n      `Skipped ${filesSkipped.length} ${\r\n        filesUpdated.length === 1 ? \"file\" : \"files\"\r\n      }: (files might be identical, use --overwrite to overwrite)`,\r\n      {\r\n        silent: options.silent,\r\n      }\r\n    )?.info()\r\n    if (!options.silent) {\r\n      for (const file of filesSkipped) {\r\n        logger.log(`  - ${file}`)\r\n      }\r\n    }\r\n  }\r\n\r\n  if (envVarsAdded.length && envFile) {\r\n    spinner(\r\n      `Added the following variables to ${highlighter.info(envFile)}:`\r\n    )?.info()\r\n    if (!options.silent) {\r\n      for (const key of envVarsAdded) {\r\n        logger.log(`  ${highlighter.success(\"+\")} ${key}`)\r\n      }\r\n    }\r\n  }\r\n\r\n  if (!options.silent) {\r\n    logger.break()\r\n  }\r\n\r\n  return {\r\n    filesCreated,\r\n    filesUpdated,\r\n    filesSkipped,\r\n  }\r\n}\r\n\r\nexport function resolveFilePath(\r\n  file: z.infer<typeof registryItemFileSchema>,\r\n  config: Config,\r\n  options: {\r\n    isSrcDir?: boolean\r\n    commonRoot?: string\r\n    framework?: ProjectInfo[\"framework\"][\"name\"]\r\n    path?: string\r\n    fileIndex?: number\r\n  }\r\n) {\r\n  // Handle custom path if provided.\r\n  if (options.path) {\r\n    const resolvedPath = path.isAbsolute(options.path)\r\n      ? options.path\r\n      : path.join(config.resolvedPaths.cwd, options.path)\r\n\r\n    const isFilePath = /\\.[^/\\\\]+$/.test(resolvedPath)\r\n\r\n    if (isFilePath) {\r\n      // We'll only use the custom path for the first file.\r\n      // This is for registry items with multiple files.\r\n      if (options.fileIndex === 0) {\r\n        return resolvedPath\r\n      }\r\n    } else {\r\n      // If the custom path is a directory,\r\n      // We'll place all files in the directory.\r\n      const fileName = path.basename(file.path)\r\n      return path.join(resolvedPath, fileName)\r\n    }\r\n  }\r\n\r\n  if (file.target) {\r\n    if (file.target.startsWith(\"~/\")) {\r\n      return path.join(config.resolvedPaths.cwd, file.target.replace(\"~/\", \"\"))\r\n    }\r\n\r\n    let target = file.target\r\n\r\n    if (file.type === \"registry:page\") {\r\n      target = resolvePageTarget(target, options.framework)\r\n      if (!target) {\r\n        return \"\"\r\n      }\r\n    }\r\n\r\n    return options.isSrcDir\r\n      ? path.join(config.resolvedPaths.cwd, \"src\", target.replace(\"src/\", \"\"))\r\n      : path.join(config.resolvedPaths.cwd, target.replace(\"src/\", \"\"))\r\n  }\r\n\r\n  const targetDir = resolveFileTargetDirectory(file, config)\r\n\r\n  const relativePath = resolveNestedFilePath(file.path, targetDir)\r\n  return path.join(targetDir, relativePath)\r\n}\r\n\r\nfunction resolveFileTargetDirectory(\r\n  file: z.infer<typeof registryItemFileSchema>,\r\n  config: Config\r\n) {\r\n  if (file.type === \"registry:ui\") {\r\n    return config.resolvedPaths.ui\r\n  }\r\n\r\n  if (file.type === \"registry:lib\") {\r\n    return config.resolvedPaths.lib\r\n  }\r\n\r\n  if (file.type === \"registry:block\" || file.type === \"registry:component\") {\r\n    return config.resolvedPaths.components\r\n  }\r\n\r\n  if (file.type === \"registry:hook\") {\r\n    return config.resolvedPaths.hooks\r\n  }\r\n\r\n  return config.resolvedPaths.components\r\n}\r\n\r\nexport function findCommonRoot(paths: string[], needle: string): string {\r\n  // Remove leading slashes for consistent handling\r\n  const normalizedPaths = paths.map((p) => p.replace(/^\\//, \"\"))\r\n  const normalizedNeedle = needle.replace(/^\\//, \"\")\r\n\r\n  // Get the directory path of the needle by removing the file name\r\n  const needleDir = normalizedNeedle.split(\"/\").slice(0, -1).join(\"/\")\r\n\r\n  // If needle is at root level, return empty string\r\n  if (!needleDir) {\r\n    return \"\"\r\n  }\r\n\r\n  // Split the needle directory into segments\r\n  const needleSegments = needleDir.split(\"/\")\r\n\r\n  // Start from the full path and work backwards\r\n  for (let i = needleSegments.length; i > 0; i--) {\r\n    const testPath = needleSegments.slice(0, i).join(\"/\")\r\n    // Check if this is a common root by verifying if any other paths start with it\r\n    const hasRelatedPaths = normalizedPaths.some(\r\n      (path) => path !== normalizedNeedle && path.startsWith(testPath + \"/\")\r\n    )\r\n    if (hasRelatedPaths) {\r\n      return \"/\" + testPath // Add leading slash back for the result\r\n    }\r\n  }\r\n\r\n  // If no common root found with other files, return the parent directory of the needle\r\n  return \"/\" + needleDir // Add leading slash back for the result\r\n}\r\n\r\nexport function resolveNestedFilePath(\r\n  filePath: string,\r\n  targetDir: string\r\n): string {\r\n  // Normalize paths by removing leading/trailing slashes\r\n  const normalizedFilePath = filePath.replace(/^\\/|\\/$/g, \"\")\r\n  const normalizedTargetDir = targetDir.replace(/^\\/|\\/$/g, \"\")\r\n\r\n  // Split paths into segments\r\n  const fileSegments = normalizedFilePath.split(\"/\")\r\n  const targetSegments = normalizedTargetDir.split(\"/\")\r\n\r\n  // Find the last matching segment from targetDir in filePath\r\n  const lastTargetSegment = targetSegments[targetSegments.length - 1]\r\n  const commonDirIndex = fileSegments.findIndex(\r\n    (segment) => segment === lastTargetSegment\r\n  )\r\n\r\n  if (commonDirIndex === -1) {\r\n    // Return just the filename if no common directory is found\r\n    return fileSegments[fileSegments.length - 1]\r\n  }\r\n\r\n  // Return everything after the common directory\r\n  return fileSegments.slice(commonDirIndex + 1).join(\"/\")\r\n}\r\n\r\nexport function resolvePageTarget(\r\n  target: string,\r\n  framework?: ProjectInfo[\"framework\"][\"name\"]\r\n) {\r\n  if (!framework) {\r\n    return \"\"\r\n  }\r\n\r\n  if (framework === \"next-app\") {\r\n    return target\r\n  }\r\n\r\n  if (framework === \"next-pages\") {\r\n    let result = target.replace(/^app\\//, \"pages/\")\r\n    result = result.replace(/\\/page(\\.[jt]sx?)$/, \"$1\")\r\n\r\n    return result\r\n  }\r\n\r\n  return \"\"\r\n}\r\n\r\nasync function resolveImports(filePaths: string[], config: Config) {\r\n  const project = new Project({\r\n    compilerOptions: {},\r\n  })\r\n  const projectInfo = await getProjectInfo(config.resolvedPaths.cwd)\r\n  const tsConfig = loadConfig(config.resolvedPaths.cwd)\r\n  const updatedFiles = []\r\n\r\n  if (!projectInfo || tsConfig.resultType === \"failed\") {\r\n    return []\r\n  }\r\n\r\n  for (const filepath of filePaths) {\r\n    const resolvedPath = path.resolve(config.resolvedPaths.cwd, filepath)\r\n\r\n    // Check if the file exists.\r\n    if (!existsSync(resolvedPath)) {\r\n      continue\r\n    }\r\n\r\n    const content = await fs.readFile(resolvedPath, \"utf-8\")\r\n\r\n    const dir = await fs.mkdtemp(path.join(tmpdir(), \"shadcn-\"))\r\n    const sourceFile = project.createSourceFile(\r\n      path.join(dir, basename(resolvedPath)),\r\n      content,\r\n      {\r\n        scriptKind: ScriptKind.TSX,\r\n      }\r\n    )\r\n\r\n    // Skip if the file extension is not one of the supported extensions.\r\n    if (![\".tsx\", \".ts\", \".jsx\", \".js\"].includes(sourceFile.getExtension())) {\r\n      continue\r\n    }\r\n\r\n    const importDeclarations = sourceFile.getImportDeclarations()\r\n    for (const importDeclaration of importDeclarations) {\r\n      const moduleSpecifier = importDeclaration.getModuleSpecifierValue()\r\n\r\n      // Filter out non-local imports.\r\n      if (\r\n        projectInfo?.aliasPrefix &&\r\n        !moduleSpecifier.startsWith(`${projectInfo.aliasPrefix}/`)\r\n      ) {\r\n        continue\r\n      }\r\n\r\n      // Find the probable import file path.\r\n      // This is where we expect to find the file on disk.\r\n      const probableImportFilePath = await resolveImport(\r\n        moduleSpecifier,\r\n        tsConfig\r\n      )\r\n\r\n      if (!probableImportFilePath) {\r\n        continue\r\n      }\r\n\r\n      // Find the actual import file path.\r\n      // This is the path where the file has been installed.\r\n      const resolvedImportFilePath = resolveModuleByProbablePath(\r\n        probableImportFilePath,\r\n        filePaths,\r\n        config\r\n      )\r\n\r\n      if (!resolvedImportFilePath) {\r\n        continue\r\n      }\r\n\r\n      // Convert the resolved import file path to an aliased import.\r\n      const newImport = toAliasedImport(\r\n        resolvedImportFilePath,\r\n        config,\r\n        projectInfo\r\n      )\r\n\r\n      if (!newImport || newImport === moduleSpecifier) {\r\n        continue\r\n      }\r\n\r\n      importDeclaration.setModuleSpecifier(newImport)\r\n\r\n      // Write the updated content to the file.\r\n      await fs.writeFile(resolvedPath, sourceFile.getFullText(), \"utf-8\")\r\n\r\n      // Track the updated file.\r\n      updatedFiles.push(filepath)\r\n    }\r\n  }\r\n\r\n  return updatedFiles\r\n}\r\n\r\n/**\r\n * Given an absolute \"probable\" import path (no ext),\r\n * plus an array of absolute file paths you already know about,\r\n * return 0N matches (best match first), and also check disk for any missing ones.\r\n */\r\nexport function resolveModuleByProbablePath(\r\n  probableImportFilePath: string,\r\n  files: string[],\r\n  config: Config,\r\n  extensions: string[] = [\".tsx\", \".ts\", \".js\", \".jsx\", \".css\"]\r\n) {\r\n  const cwd = path.normalize(config.resolvedPaths.cwd)\r\n\r\n  // 1) Build a set of POSIX-normalized, project-relative files\r\n  const relativeFiles = files.map((f) => f.split(path.sep).join(path.posix.sep))\r\n  const fileSet = new Set(relativeFiles)\r\n\r\n  // 2) Strip any existing extension off the absolute base path\r\n  const extInPath = path.extname(probableImportFilePath)\r\n  const hasExt = extInPath !== \"\"\r\n  const absBase = hasExt\r\n    ? probableImportFilePath.slice(0, -extInPath.length)\r\n    : probableImportFilePath\r\n\r\n  // 3) Compute the project-relative \"base\" directory for strong matching\r\n  const relBaseRaw = path.relative(cwd, absBase)\r\n  const relBase = relBaseRaw.split(path.sep).join(path.posix.sep)\r\n\r\n  // 4) Decide which extensions to try\r\n  const tryExts = hasExt ? [extInPath] : extensions\r\n\r\n  // 5) Collect candidates\r\n  const candidates = new Set<string>()\r\n\r\n  // 5a) Fastpath: [base + ext] and [base/index + ext]\r\n  for (const e of tryExts) {\r\n    const absCand = absBase + e\r\n    const relCand = path.posix.normalize(path.relative(cwd, absCand))\r\n    if (fileSet.has(relCand) || existsSync(absCand)) {\r\n      candidates.add(relCand)\r\n    }\r\n\r\n    const absIdx = path.join(absBase, `index${e}`)\r\n    const relIdx = path.posix.normalize(path.relative(cwd, absIdx))\r\n    if (fileSet.has(relIdx) || existsSync(absIdx)) {\r\n      candidates.add(relIdx)\r\n    }\r\n  }\r\n\r\n  // 5b) Fallback: scan known files by basename\r\n  const name = path.basename(absBase)\r\n  for (const f of relativeFiles) {\r\n    if (tryExts.some((e) => f.endsWith(`/${name}${e}`))) {\r\n      candidates.add(f)\r\n    }\r\n  }\r\n\r\n  // 6) If no matches, bail\r\n  if (candidates.size === 0) return null\r\n\r\n  // 7) Sort by (1) extension priority, then (2) \"strong\" base match\r\n  const sorted = Array.from(candidates).sort((a, b) => {\r\n    // a) extension order\r\n    const aExt = path.posix.extname(a)\r\n    const bExt = path.posix.extname(b)\r\n    const ord = tryExts.indexOf(aExt) - tryExts.indexOf(bExt)\r\n    if (ord !== 0) return ord\r\n    // b) strong match if path starts with relBase\r\n    const aStrong = relBase && a.startsWith(relBase) ? -1 : 1\r\n    const bStrong = relBase && b.startsWith(relBase) ? -1 : 1\r\n    return aStrong - bStrong\r\n  })\r\n\r\n  // 8) Return the first (best) candidate\r\n  return sorted[0]\r\n}\r\n\r\nexport function toAliasedImport(\r\n  filePath: string,\r\n  config: Config,\r\n  projectInfo: ProjectInfo\r\n): string | null {\r\n  const abs = path.normalize(path.join(config.resolvedPaths.cwd, filePath))\r\n\r\n  // 1 Find the longest matching alias root in resolvedPaths\r\n  //    e.g. key=\"ui\", root=\"//components/ui\" beats key=\"components\"\r\n  const matches = Object.entries(config.resolvedPaths)\r\n    .filter(\r\n      ([, root]) => root && abs.startsWith(path.normalize(root + path.sep))\r\n    )\r\n    .sort((a, b) => b[1].length - a[1].length)\r\n\r\n  if (matches.length === 0) {\r\n    return null\r\n  }\r\n  const [aliasKey, rootDir] = matches[0]\r\n\r\n  // 2 Compute the path UNDER that root\r\n  let rel = path.relative(rootDir, abs)\r\n  // force POSIX-style separators\r\n  rel = rel.split(path.sep).join(\"/\") // e.g. \"button/index.tsx\"\r\n\r\n  // 3 Strip code-file extensions, keep others (css, json, etc.)\r\n  const ext = path.posix.extname(rel)\r\n  const codeExts = [\".ts\", \".tsx\", \".js\", \".jsx\"]\r\n  const keepExt = codeExts.includes(ext) ? \"\" : ext\r\n  let noExt = rel.slice(0, rel.length - ext.length)\r\n\r\n  // 4 Collapse \"/index\" to its directory\r\n  if (noExt.endsWith(\"/index\")) {\r\n    noExt = noExt.slice(0, -\"/index\".length)\r\n  }\r\n\r\n  // 5 Build the aliased path\r\n  //    config.aliases[aliasKey] is e.g. \"@/components/ui\"\r\n  const aliasBase =\r\n    aliasKey === \"cwd\"\r\n      ? projectInfo.aliasPrefix\r\n      : config.aliases[aliasKey as keyof typeof config.aliases]\r\n  if (!aliasBase) {\r\n    return null\r\n  }\r\n  // if noExt is empty (i.e. file was exactly at the root), we import the root\r\n  let suffix = noExt === \"\" ? \"\" : `/${noExt}`\r\n\r\n  // Remove /src from suffix.\r\n  // Alias will handle this.\r\n  suffix = suffix.replace(\"/src\", \"\")\r\n\r\n  // 6 Prepend the prefix from projectInfo (e.g. \"@\") if needed\r\n  //    but usually config.aliases already include it.\r\n  return `${aliasBase}${suffix}${keepExt}`\r\n}\r\n\r\nfunction _isNext16Middleware(\r\n  filePath: string,\r\n  projectInfo: ProjectInfo | null,\r\n  config: Config\r\n) {\r\n  const isRootMiddleware =\r\n    filePath === path.join(config.resolvedPaths.cwd, \"middleware.ts\") ||\r\n    filePath === path.join(config.resolvedPaths.cwd, \"middleware.js\")\r\n\r\n  const isNextJs =\r\n    projectInfo?.framework.name === \"next-app\" ||\r\n    projectInfo?.framework.name === \"next-pages\"\r\n\r\n  if (!isRootMiddleware || !isNextJs || !projectInfo?.frameworkVersion) {\r\n    return false\r\n  }\r\n\r\n  const majorVersion = parseInt(projectInfo.frameworkVersion.split(\".\")[0])\r\n  const isNext16Plus = !isNaN(majorVersion) && majorVersion >= 16\r\n\r\n  return isNext16Plus\r\n}\r\n","import z from \"zod\";\r\nimport { Config } from \"../utils/get-config\";\r\nimport { getProjectInfo } from \"../utils/get-project-info\";\r\nimport { findCommonRoot, resolveFilePath } from \"../utils/updaters/update-files\";\r\nimport { registryItemFileSchema, registryItemSchema } from \"./schema\";\r\n\r\nexport function isUrl(path: string) {\r\n  try {\r\n    new URL(path);\r\n    return true;\r\n  } catch (error) {\r\n    return false;\r\n  }\r\n}\r\n\r\nexport function isLocalFile(path: string) {\r\n  return path.endsWith(\".json\") && !isUrl(path);\r\n}\r\n\r\nexport function isUniversalRegistryItem(\r\n  registryItem:\r\n    | Pick<z.infer<typeof registryItemSchema>, \"files\" | \"type\">\r\n    | null\r\n    | undefined\r\n): boolean {\r\n  if (!registryItem) {\r\n    return false;\r\n  }\r\n\r\n  if (\r\n    registryItem.type !== \"registry:item\" &&\r\n    registryItem.type !== \"registry:file\"\r\n  ) {\r\n    return false;\r\n  }\r\n\r\n  const files = registryItem.files ?? [];\r\n\r\n  return files.every(\r\n    (file) =>\r\n      !!file.target &&\r\n    (file.type === \"registry:file\" || file.type === \"registry:item\")\r\n  );\r\n}\r\n\r\n// Deduplicates files based on their resolved target paths.\r\n// When multiple files resolve to the same target path, the last one wins.\r\nexport async function deduplicateFilesByTarget(\r\n  filesArrays: Array<z.infer<typeof registryItemFileSchema>[] | undefined>,\r\n  config: Config\r\n) {\r\n  // Fallback to simple concatenation when we don't have complete config.\r\n  if (!canDeduplicateFiles(config)) {\r\n    return z\r\n      .array(registryItemFileSchema)\r\n      .parse(filesArrays.flat().filter(Boolean))\r\n  }\r\n\r\n  // Get project info for file resolution.\r\n  const projectInfo = await getProjectInfo(config.resolvedPaths.cwd)\r\n  const targetMap = new Map<string, z.infer<typeof registryItemFileSchema>>()\r\n  const allFiles = z\r\n    .array(registryItemFileSchema)\r\n    .parse(filesArrays.flat().filter(Boolean))\r\n\r\n  allFiles.forEach((file) => {\r\n    const resolvedPath = resolveFilePath(file, config, {\r\n      isSrcDir: projectInfo?.isSrcDir,\r\n      framework: projectInfo?.framework.name,\r\n      commonRoot: findCommonRoot(\r\n        allFiles.map((f) => f.path),\r\n        file.path\r\n      ),\r\n    })\r\n\r\n    if (resolvedPath) {\r\n      // Last one wins - overwrites previous entry.\r\n      targetMap.set(resolvedPath, file)\r\n    }\r\n  })\r\n\r\n  return Array.from(targetMap.values())\r\n}\r\n\r\n// Checks if the config has the minimum required paths for file deduplication.\r\nexport function canDeduplicateFiles(config: Config) {\r\n  return !!(\r\n    config?.resolvedPaths?.cwd &&\r\n    (config?.resolvedPaths?.ui ||\r\n      config?.resolvedPaths?.lib ||\r\n      config?.resolvedPaths?.components ||\r\n      config?.resolvedPaths?.hooks)\r\n  )\r\n}\r\n","import deepmerge from \"deepmerge\";\r\nimport { Config, createConfig } from \"../utils/get-config\";\r\nimport { BUILTIN_REGISTRIES, FALLBACK_STYLE } from \"./constants\";\r\nimport { configSchema } from \"./schema\";\r\n\r\nfunction resolveStyleFromConfig(config: Partial<Config> | Config) {\r\n  if (!config.style) {\r\n    return FALLBACK_STYLE;\r\n  }\r\n\r\n  // Check if we should use aodesu for tailwind\r\n  // We assume that if tailwind.config is empty, we're using tailwind v4.\r\n  if (config.style === \"aodesu\" && config.tailwind?.config === \"\") {\r\n    return FALLBACK_STYLE;\r\n  }\r\n\r\n  return config.style;\r\n}\r\n\r\nexport function configWithDefaults(config?: Partial<Config> | Config) {\r\n  const baseConfig = createConfig({\r\n    style: FALLBACK_STYLE,\r\n    registries: BUILTIN_REGISTRIES,\r\n  });\r\n\r\n  if (!config) {\r\n    return baseConfig;\r\n  }\r\n\r\n  return configSchema.parse(\r\n    deepmerge(baseConfig, {\r\n      ...config,\r\n      style: resolveStyleFromConfig(config),\r\n      registries: { ...BUILTIN_REGISTRIES, ...config.registries },\r\n    })\r\n  )\r\n};\r\n","interface RegistryContext {\r\n  headers: Record<string, Record<string, string>>\r\n}\r\n\r\nlet context: RegistryContext = {\r\n  headers: {},\r\n}\r\n\r\nexport function setRegistryHeaders(\r\n  headers: Record<string, Record<string, string>>\r\n) {\r\n  // Merge new headers with existing ones to preserve headers for nested dependencies\r\n  context.headers = { ...context.headers, ...headers };\r\n}\r\n\r\nexport function getRegistryHeadersFromContext(\r\n  url: string\r\n): Record<string, string> {\r\n  return context.headers[url] || {}\r\n};\r\n\r\nexport function clearRegistryContext() {\r\n  context.headers = {};\r\n}\r\n","import z from \"zod\";\r\nimport { Config } from \"../utils/get-config\";\r\nimport { buildUrlAndHeadersForRegistryItem } from \"./builder\";\r\nimport { configWithDefaults } from \"./config\";\r\nimport { clearRegistryContext } from \"./context\";\r\nimport { extractEnvVars } from \"./env\";\r\nimport { RegistryMissingEnvironmentVariablesError } from \"./errors\";\r\nimport { registryConfigItemSchema } from \"./schema\";\r\n\r\nexport function extractEnvVarsFromRegistryConfig(\r\n  config: z.infer<typeof registryConfigItemSchema>\r\n): string[] {\r\n  const vars = new Set<string>();\r\n\r\n  if (typeof config === \"string\") {\r\n    extractEnvVars(config).forEach((v) => vars.add(v));\r\n  } else {\r\n    extractEnvVars(config.url).forEach((v) => vars.add(v));\r\n\r\n    if (config.params) {\r\n      Object.values(config.params).forEach((value) => {\r\n        extractEnvVars(value).forEach((v) => vars.add(v));\r\n      })\r\n    }\r\n\r\n    if (config.headers) {\r\n      Object.values(config.headers).forEach((value) => {\r\n        extractEnvVars(value).forEach((v) => vars.add(v));\r\n      })\r\n    }\r\n  }\r\n\r\n  return Array.from(vars);\r\n}\r\n\r\nexport function validateRegistryConfig(\r\n  registryName: string,\r\n  config: z.infer<typeof registryConfigItemSchema>\r\n): void {\r\n  const requiredVars = extractEnvVarsFromRegistryConfig(config);\r\n  const missing = requiredVars.filter((v) => !process.env[v]);\r\n\r\n  if (missing.length > 0) {\r\n    throw new RegistryMissingEnvironmentVariablesError(registryName, missing);\r\n  }\r\n}\r\n\r\nexport function validateRegistryConfigForItems(\r\n  items: string[],\r\n  config?: Config\r\n): void {\r\n  for (const item of items) {\r\n    buildUrlAndHeadersForRegistryItem(item, configWithDefaults(config));\r\n  }\r\n\r\n  // Clear registry context after validation.\r\n  clearRegistryContext();\r\n}\r\n","import z from \"zod\";\r\nimport { Config } from \"../utils/get-config\";\r\nimport { REGISTRY_URL } from \"./constants\";\r\nimport { expandEnvVars } from \"./env\";\r\nimport { RegistryNotConfiguredError } from \"./errors\";\r\nimport { parseRegistryAndItemFromString } from \"./parser\";\r\nimport { registryConfigItemSchema } from \"./schema\";\r\nimport { isUrl } from \"./utils\";\r\nimport { validateRegistryConfig } from \"./validator\";\r\n\r\nconst NAME_PLACEHOLDER = \"{name}\";\r\nconst STYLE_PLACEHOLDER = \"{style}\";\r\nconst ENV_VAR_PATTER = /\\${(\\w+)}/g\r\nconst QUERY_PARAM_SEPARATOR = \"?\";\r\nconst QUERY_PARAM_DELIMITER = \"&\";\r\n\r\nexport function buildUrlAndHeadersForRegistryItem(\r\n  name: string,\r\n  config?: Config\r\n) {\r\n  const { registry, item } = parseRegistryAndItemFromString(name);\r\n\r\n  if (!registry) {\r\n    return null;\r\n  }\r\n\r\n  const registries = config?.registries || {};\r\n  const registryConfig = registries[registry];\r\n  if (!registryConfig) {\r\n    throw new RegistryNotConfiguredError(registry);\r\n  }\r\n\r\n  validateRegistryConfig(registry, registryConfig);\r\n\r\n  return {\r\n    url: buildUrlFromRegistryConfig(item, registryConfig, config),\r\n    headers: buildHeadersFromRegistryConfig(registryConfig),\r\n  }\r\n}\r\n\r\nexport function buildUrlFromRegistryConfig(\r\n  item: string,\r\n  registryConfig: z.infer<typeof registryConfigItemSchema>,\r\n  config?: Config\r\n) {\r\n  if (typeof registryConfig === \"string\") {\r\n    let url = registryConfig.replace(NAME_PLACEHOLDER, item);\r\n    if (config?.style && url.includes(STYLE_PLACEHOLDER)) {\r\n      url = url.replace(STYLE_PLACEHOLDER, config.style);\r\n    }\r\n    return expandEnvVars(url);\r\n  }\r\n\r\n  let baseUrl = registryConfig.url.replace(NAME_PLACEHOLDER, item);\r\n  if (config?.style && baseUrl.includes(STYLE_PLACEHOLDER)) {\r\n    baseUrl = baseUrl.replace(STYLE_PLACEHOLDER, config.style);\r\n  }\r\n  baseUrl = expandEnvVars(baseUrl);\r\n\r\n  if (!registryConfig.params) {\r\n    return baseUrl;\r\n  }\r\n\r\n  return appendQueryParams(baseUrl, registryConfig.params);\r\n}\r\n\r\nexport function buildHeadersFromRegistryConfig(\r\n  config: z.infer<typeof registryConfigItemSchema>\r\n) {\r\n  if (typeof config === \"string\" || !config.headers) {\r\n    return {}\r\n  }\r\n\r\n  const headers: Record<string, string> = {};\r\n\r\n  for (const [key, value] of Object.entries(config.headers)) {\r\n    const expandedValue = expandEnvVars(value);\r\n\r\n    if (shouldIncludeHeader(value, expandedValue)) {\r\n      headers[key] = expandedValue;\r\n    }\r\n  }\r\n\r\n  return headers;\r\n}\r\n\r\nfunction appendQueryParams(baseUrl: string, params: Record<string, string>) {\r\n  const urlParams = new URLSearchParams();\r\n\r\n  for (const [key, value] of Object.entries(params)) {\r\n    const expandedValue = expandEnvVars(value);\r\n    if (expandedValue) {\r\n      urlParams.append(key, expandedValue);\r\n    }\r\n  }\r\n\r\n  const queryString = urlParams.toString();\r\n  if (!queryString) {\r\n    return baseUrl;\r\n  }\r\n\r\n  const separator = baseUrl.includes(QUERY_PARAM_SEPARATOR)\r\n    ? QUERY_PARAM_DELIMITER\r\n    : QUERY_PARAM_SEPARATOR;\r\n\r\n  return `${baseUrl}${separator}${queryString}`;\r\n}\r\n\r\nfunction shouldIncludeHeader(originalValue: string, expandedValue: string) {\r\n  const trimmedExpanded = expandedValue.trim();\r\n\r\n  if (!trimmedExpanded) {\r\n    return false;\r\n  }\r\n\r\n  // If the original value contains valid en vars, only include if expansion changed the value.\r\n  if (originalValue.includes(\"${\")) {\r\n    // Check if there are actual en vars in the string\r\n    const envVars = originalValue.match(ENV_VAR_PATTER);\r\n    if (envVars) {\r\n      const templateWithoutVars = originalValue\r\n        .replace(ENV_VAR_PATTER, \"\")\r\n        .trim();\r\n\r\n      return trimmedExpanded !== templateWithoutVars;\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nexport function resolveRegistryUrl(pathOrUrl: string) {\r\n  if (isUrl(pathOrUrl)) {\r\n    // If the url contains /chat/b, we assume it's the v0 registry.\r\n    // We need to add the /json suffix if it's missing.\r\n    const url = new URL(pathOrUrl);\r\n    if (url.pathname.match(/\\/chat\\/b\\//) && !url.pathname.endsWith(\"/json\")) {\r\n      url.pathname = `${url.pathname}/json`\r\n    }\r\n\r\n    return url.toString();\r\n  }\r\n\r\n  return `${REGISTRY_URL}/${pathOrUrl}`;\r\n}\r\n","import { resolveRegistryUrl } from \"@/src/registry/builder\"\r\nimport { getRegistryHeadersFromContext } from \"@/src/registry/context\"\r\nimport {\r\n  RegistryFetchError,\r\n  RegistryForbiddenError,\r\n  RegistryLocalFileError,\r\n  RegistryNotFoundError,\r\n  RegistryParseError,\r\n  RegistryUnauthorizedError,\r\n} from \"@/src/registry/errors\"\r\nimport { registryItemSchema } from \"@/src/schema\"\r\nimport { promises as fs } from \"fs\"\r\nimport { HttpsProxyAgent } from \"https-proxy-agent\"\r\nimport fetch from \"node-fetch\"\r\nimport { homedir } from \"os\"\r\nimport path from \"path\"\r\nimport { z } from \"zod\"\r\n\r\nconst agent = process.env.https_proxy\r\n  ? new HttpsProxyAgent(process.env.https_proxy)\r\n  : undefined\r\n\r\nconst registryCache = new Map<string, Promise<any>>()\r\n\r\nexport function clearRegistryCache() {\r\n  registryCache.clear()\r\n}\r\n\r\nexport async function fetchRegistry(\r\n  paths: string[],\r\n  options: { useCache?: boolean } = {}\r\n) {\r\n  options = {\r\n    useCache: true,\r\n    ...options,\r\n  }\r\n\r\n  try {\r\n    const results = await Promise.all(\r\n      paths.map(async (path) => {\r\n        const url = resolveRegistryUrl(path)\r\n\r\n        // Check cache first if caching is enabled\r\n        if (options.useCache && registryCache.has(url)) {\r\n          return registryCache.get(url)\r\n        }\r\n\r\n        // Store the promise in the cache before awaiting if caching is enabled.\r\n        const fetchPromise = (async () => {\r\n          // Get headers from context for this URL.\r\n          const headers = getRegistryHeadersFromContext(url)\r\n\r\n          const response = await fetch(url, {\r\n            agent,\r\n            headers: {\r\n              ...headers,\r\n            },\r\n          })\r\n\r\n          if (!response.ok) {\r\n            let messageFromServer = undefined\r\n\r\n            if (\r\n              response.headers.get(\"content-type\")?.includes(\"application/json\")\r\n            ) {\r\n              const json = await response.json()\r\n              const parsed = z\r\n                .object({\r\n                  // RFC 7807.\r\n                  detail: z.string().optional(),\r\n                  title: z.string().optional(),\r\n                  // Standard error response.\r\n                  message: z.string().optional(),\r\n                  error: z.string().optional(),\r\n                })\r\n                .safeParse(json)\r\n\r\n              if (parsed.success) {\r\n                // Prefer RFC 7807 detail field, then message field.\r\n                messageFromServer = parsed.data.detail || parsed.data.message\r\n\r\n                if (parsed.data.error) {\r\n                  messageFromServer = `[${parsed.data.error}] ${messageFromServer}`\r\n                }\r\n              }\r\n            }\r\n\r\n            if (response.status === 401) {\r\n              throw new RegistryUnauthorizedError(url, messageFromServer)\r\n            }\r\n\r\n            if (response.status === 404) {\r\n              throw new RegistryNotFoundError(url, messageFromServer)\r\n            }\r\n\r\n            if (response.status === 403) {\r\n              throw new RegistryForbiddenError(url, messageFromServer)\r\n            }\r\n\r\n            throw new RegistryFetchError(\r\n              url,\r\n              response.status,\r\n              messageFromServer\r\n            )\r\n          }\r\n\r\n          return response.json()\r\n        })()\r\n\r\n        if (options.useCache) {\r\n          registryCache.set(url, fetchPromise)\r\n        }\r\n        return fetchPromise\r\n      })\r\n    )\r\n\r\n    return results\r\n  } catch (error) {\r\n    throw error\r\n  }\r\n}\r\n\r\nexport async function fetchRegistryLocal(filePath: string) {\r\n  try {\r\n    // Handle tilde expansion for home directory\r\n    let expandedPath = filePath\r\n    if (filePath.startsWith(\"~/\")) {\r\n      expandedPath = path.join(homedir(), filePath.slice(2))\r\n    }\r\n\r\n    const resolvedPath = path.resolve(expandedPath)\r\n    const content = await fs.readFile(resolvedPath, \"utf8\")\r\n    const parsed = JSON.parse(content)\r\n\r\n    try {\r\n      return registryItemSchema.parse(parsed)\r\n    } catch (error) {\r\n      throw new RegistryParseError(filePath, error)\r\n    }\r\n  } catch (error) {\r\n    // Check if this is a file not found error\r\n    if (\r\n      error instanceof Error &&\r\n      (error.message.includes(\"ENOENT\") ||\r\n        error.message.includes(\"no such file\"))\r\n    ) {\r\n      throw new RegistryLocalFileError(filePath, error)\r\n    }\r\n    // Re-throw parse errors as-is\r\n    if (error instanceof RegistryParseError) {\r\n      throw error\r\n    }\r\n    // For other errors (like JSON parse errors), throw as local file error\r\n    throw new RegistryLocalFileError(filePath, error)\r\n  }\r\n}\r\n","import {\r\n  registryItemCssVarsSchema,\r\n  registryItemTailwindSchema,\r\n} from \"@/src/schema\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\nimport { TailwindVersion } from \"@/src/utils/get-project-info\"\r\nimport { highlighter } from \"@/src/utils/highlighter\"\r\nimport { spinner } from \"@/src/utils/spinner\"\r\nimport deepmerge from \"deepmerge\"\r\nimport { promises as fs } from \"fs\"\r\nimport { tmpdir } from \"os\"\r\nimport path from \"path\"\r\nimport objectToString from \"stringify-object\"\r\nimport { type Config as TailwindConfig } from \"tailwindcss\"\r\nimport {\r\n  ArrayLiteralExpression,\r\n  ObjectLiteralExpression,\r\n  Project,\r\n  PropertyAssignment,\r\n  QuoteKind,\r\n  ScriptKind,\r\n  SyntaxKind,\r\n  VariableStatement,\r\n} from \"ts-morph\"\r\nimport { z } from \"zod\"\r\n\r\nexport type UpdaterTailwindConfig = Omit<TailwindConfig, \"plugins\"> & {\r\n  // We only want string plugins for now.\r\n  plugins?: string[]\r\n}\r\n\r\nexport async function updateTailwindConfig(\r\n  tailwindConfig:\r\n    | z.infer<typeof registryItemTailwindSchema>[\"config\"]\r\n    | undefined,\r\n  config: Config,\r\n  options: {\r\n    silent?: boolean\r\n    tailwindVersion?: TailwindVersion\r\n  }\r\n) {\r\n  if (!tailwindConfig) {\r\n    return\r\n  }\r\n\r\n  options = {\r\n    silent: false,\r\n    tailwindVersion: \"v3\",\r\n    ...options,\r\n  }\r\n\r\n  // No tailwind config in v4.\r\n  if (options.tailwindVersion === \"v4\") {\r\n    return\r\n  }\r\n\r\n  const tailwindFileRelativePath = path.relative(\r\n    config.resolvedPaths.cwd,\r\n    config.resolvedPaths.tailwindConfig\r\n  )\r\n  const tailwindSpinner = spinner(\r\n    `Updating ${highlighter.info(tailwindFileRelativePath)}`,\r\n    {\r\n      silent: options.silent,\r\n    }\r\n  ).start()\r\n  const raw = await fs.readFile(config.resolvedPaths.tailwindConfig, \"utf8\")\r\n  const output = await transformTailwindConfig(raw, tailwindConfig, config)\r\n  await fs.writeFile(config.resolvedPaths.tailwindConfig, output, \"utf8\")\r\n  tailwindSpinner?.succeed()\r\n}\r\n\r\nexport async function transformTailwindConfig(\r\n  input: string,\r\n  tailwindConfig: UpdaterTailwindConfig,\r\n  config: Config\r\n) {\r\n  const sourceFile = await _createSourceFile(input, config)\r\n  // Find the object with content property.\r\n  // This is faster than traversing the default export.\r\n  // TODO: maybe we do need to traverse the default export?\r\n  const configObject = sourceFile\r\n    .getDescendantsOfKind(SyntaxKind.ObjectLiteralExpression)\r\n    .find((node) =>\r\n      node\r\n        .getProperties()\r\n        .some(\r\n          (property) =>\r\n            property.isKind(SyntaxKind.PropertyAssignment) &&\r\n            property.getName() === \"content\"\r\n        )\r\n    )\r\n\r\n  // We couldn't find the config object, so we return the input as is.\r\n  if (!configObject) {\r\n    return input\r\n  }\r\n\r\n  const quoteChar = _getQuoteChar(configObject)\r\n\r\n  // Add darkMode.\r\n  addTailwindConfigProperty(\r\n    configObject,\r\n    {\r\n      name: \"darkMode\",\r\n      value: \"class\",\r\n    },\r\n    { quoteChar }\r\n  )\r\n\r\n  // Add Tailwind config plugins.\r\n  tailwindConfig.plugins?.forEach((plugin) => {\r\n    addTailwindConfigPlugin(configObject, plugin)\r\n  })\r\n\r\n  // Add Tailwind config theme.\r\n  if (tailwindConfig.theme) {\r\n    await addTailwindConfigTheme(configObject, tailwindConfig.theme)\r\n  }\r\n\r\n  return sourceFile.getFullText()\r\n}\r\n\r\nfunction addTailwindConfigProperty(\r\n  configObject: ObjectLiteralExpression,\r\n  property: {\r\n    name: string\r\n    value: string\r\n  },\r\n  {\r\n    quoteChar,\r\n  }: {\r\n    quoteChar: string\r\n  }\r\n) {\r\n  const existingProperty = configObject.getProperty(\"darkMode\")\r\n\r\n  if (!existingProperty) {\r\n    const newProperty = {\r\n      name: property.name,\r\n      initializer: `[${quoteChar}${property.value}${quoteChar}]`,\r\n    }\r\n\r\n    // We need to add darkMode as the first property.\r\n    if (property.name === \"darkMode\") {\r\n      configObject.insertPropertyAssignment(0, newProperty)\r\n      return configObject\r\n    }\r\n\r\n    configObject.addPropertyAssignment(newProperty)\r\n\r\n    return configObject\r\n  }\r\n\r\n  if (existingProperty.isKind(SyntaxKind.PropertyAssignment)) {\r\n    const initializer = existingProperty.getInitializer()\r\n    const newValue = `${quoteChar}${property.value}${quoteChar}`\r\n\r\n    // If property is a string, change it to an array and append.\r\n    if (initializer?.isKind(SyntaxKind.StringLiteral)) {\r\n      const initializerText = initializer.getText()\r\n      initializer.replaceWithText(`[${initializerText}, ${newValue}]`)\r\n      return configObject\r\n    }\r\n\r\n    // If property is an array, append.\r\n    if (initializer?.isKind(SyntaxKind.ArrayLiteralExpression)) {\r\n      // Check if the array already contains the value.\r\n      if (\r\n        initializer\r\n          .getElements()\r\n          .map((element) => element.getText())\r\n          .includes(newValue)\r\n      ) {\r\n        return configObject\r\n      }\r\n      initializer.addElement(newValue)\r\n    }\r\n\r\n    return configObject\r\n  }\r\n\r\n  return configObject\r\n}\r\n\r\nasync function addTailwindConfigTheme(\r\n  configObject: ObjectLiteralExpression,\r\n  theme: UpdaterTailwindConfig[\"theme\"]\r\n) {\r\n  // Ensure there is a theme property.\r\n  if (!configObject.getProperty(\"theme\")) {\r\n    configObject.addPropertyAssignment({\r\n      name: \"theme\",\r\n      initializer: \"{}\",\r\n    })\r\n  }\r\n\r\n  // Nest all spread properties.\r\n  nestSpreadProperties(configObject)\r\n\r\n  const themeProperty = configObject\r\n    .getPropertyOrThrow(\"theme\")\r\n    ?.asKindOrThrow(SyntaxKind.PropertyAssignment)\r\n\r\n  const themeInitializer = themeProperty.getInitializer()\r\n  if (themeInitializer?.isKind(SyntaxKind.ObjectLiteralExpression)) {\r\n    const themeObjectString = themeInitializer.getText()\r\n    const themeObject = await parseObjectLiteral(themeObjectString)\r\n    const result = deepmerge(themeObject, theme, {\r\n      arrayMerge: (dst, src) => src,\r\n    })\r\n    const resultString = objectToString(result)\r\n      .replace(/\\'\\.\\.\\.(.*)\\'/g, \"...$1\") // Remove quote around spread element\r\n      .replace(/\\'\\\"/g, \"'\") // Replace `\\\" with \"\r\n      .replace(/\\\"\\'/g, \"'\") // Replace `\\\" with \"\r\n      .replace(/\\'\\[/g, \"[\") // Replace `[ with [\r\n      .replace(/\\]\\'/g, \"]\") // Replace `] with ]\r\n      .replace(/\\'\\\\\\'/g, \"'\") // Replace `\\' with '\r\n      .replace(/\\\\\\'/g, \"'\") // Replace \\' with '\r\n      .replace(/\\\\\\'\\'/g, \"'\")\r\n      .replace(/\\'\\'/g, \"'\")\r\n    themeInitializer.replaceWithText(resultString)\r\n  }\r\n\r\n  // Unnest all spread properties.\r\n  unnestSpreadProperties(configObject)\r\n}\r\n\r\nfunction addTailwindConfigPlugin(\r\n  configObject: ObjectLiteralExpression,\r\n  plugin: string\r\n) {\r\n  const existingPlugins = configObject.getProperty(\"plugins\")\r\n\r\n  if (!existingPlugins) {\r\n    configObject.addPropertyAssignment({\r\n      name: \"plugins\",\r\n      initializer: `[${plugin}]`,\r\n    })\r\n\r\n    return configObject\r\n  }\r\n\r\n  if (existingPlugins.isKind(SyntaxKind.PropertyAssignment)) {\r\n    const initializer = existingPlugins.getInitializer()\r\n\r\n    if (initializer?.isKind(SyntaxKind.ArrayLiteralExpression)) {\r\n      if (\r\n        initializer\r\n          .getElements()\r\n          .map((element) => {\r\n            return element.getText().replace(/[\"']/g, \"\")\r\n          })\r\n          .includes(plugin.replace(/[\"']/g, \"\"))\r\n      ) {\r\n        return configObject\r\n      }\r\n      initializer.addElement(plugin)\r\n    }\r\n\r\n    return configObject\r\n  }\r\n\r\n  return configObject\r\n}\r\n\r\nexport async function _createSourceFile(input: string, config: Config | null) {\r\n  const dir = await fs.mkdtemp(path.join(tmpdir(), \"uidesu-\"))\r\n  const resolvedPath =\r\n    config?.resolvedPaths?.tailwindConfig || \"tailwind.config.ts\"\r\n  const tempFile = path.join(dir, `uidesu-${path.basename(resolvedPath)}`)\r\n\r\n  const project = new Project({\r\n    compilerOptions: {},\r\n  })\r\n  const sourceFile = project.createSourceFile(tempFile, input, {\r\n    // Note: .js and .mjs can still be valid for TS projects.\r\n    // We can't infer TypeScript from config.tsx.\r\n    scriptKind:\r\n      path.extname(resolvedPath) === \".ts\" ? ScriptKind.TS : ScriptKind.JS,\r\n  })\r\n\r\n  return sourceFile\r\n}\r\n\r\nexport function _getQuoteChar(configObject: ObjectLiteralExpression) {\r\n  return configObject\r\n    .getFirstDescendantByKind(SyntaxKind.StringLiteral)\r\n    ?.getQuoteKind() === QuoteKind.Single\r\n    ? \"'\"\r\n    : '\"'\r\n}\r\n\r\nexport function nestSpreadProperties(obj: ObjectLiteralExpression) {\r\n  const properties = obj.getProperties()\r\n\r\n  for (let i = 0; i < properties.length; i++) {\r\n    const prop = properties[i]\r\n    if (prop.isKind(SyntaxKind.SpreadAssignment)) {\r\n      const spreadAssignment = prop.asKindOrThrow(SyntaxKind.SpreadAssignment)\r\n      const spreadText = spreadAssignment.getExpression().getText()\r\n\r\n      // Replace spread with a property assignment\r\n      obj.insertPropertyAssignment(i, {\r\n        // Need to escape the name with \" so that deepmerge doesn't mishandle the key\r\n        name: `\"___${spreadText.replace(/^\\.\\.\\./, \"\")}\"`,\r\n        initializer: `\"...${spreadText.replace(/^\\.\\.\\./, \"\")}\"`,\r\n      })\r\n\r\n      // Remove the original spread assignment\r\n      spreadAssignment.remove()\r\n    } else if (prop.isKind(SyntaxKind.PropertyAssignment)) {\r\n      const propAssignment = prop.asKindOrThrow(SyntaxKind.PropertyAssignment)\r\n      const initializer = propAssignment.getInitializer()\r\n\r\n      if (\r\n        initializer &&\r\n        initializer.isKind(SyntaxKind.ObjectLiteralExpression)\r\n      ) {\r\n        // Recursively process nested object literals\r\n        nestSpreadProperties(\r\n          initializer.asKindOrThrow(SyntaxKind.ObjectLiteralExpression)\r\n        )\r\n      } else if (\r\n        initializer &&\r\n        initializer.isKind(SyntaxKind.ArrayLiteralExpression)\r\n      ) {\r\n        nestSpreadElements(\r\n          initializer.asKindOrThrow(SyntaxKind.ArrayLiteralExpression)\r\n        )\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport function nestSpreadElements(arr: ArrayLiteralExpression) {\r\n  const elements = arr.getElements()\r\n  for (let j = 0; j < elements.length; j++) {\r\n    const element = elements[j]\r\n    if (element.isKind(SyntaxKind.ObjectLiteralExpression)) {\r\n      // Recursive check on objects within arrays\r\n      nestSpreadProperties(\r\n        element.asKindOrThrow(SyntaxKind.ObjectLiteralExpression)\r\n      )\r\n    } else if (element.isKind(SyntaxKind.ArrayLiteralExpression)) {\r\n      // Recursive check on nested arrays\r\n      nestSpreadElements(\r\n        element.asKindOrThrow(SyntaxKind.ArrayLiteralExpression)\r\n      )\r\n    } else if (element.isKind(SyntaxKind.SpreadElement)) {\r\n      const spreadText = element.getText()\r\n      // Spread element within an array\r\n      arr.removeElement(j)\r\n      arr.insertElement(j, `\"${spreadText}\"`)\r\n    }\r\n  }\r\n}\r\n\r\nexport function unnestSpreadProperties(obj: ObjectLiteralExpression) {\r\n  const properties = obj.getProperties()\r\n\r\n  for (let i = 0; i < properties.length; i++) {\r\n    const prop = properties[i]\r\n    if (prop.isKind(SyntaxKind.PropertyAssignment)) {\r\n      const propAssignment = prop as PropertyAssignment\r\n      const initializer = propAssignment.getInitializer()\r\n\r\n      if (initializer && initializer.isKind(SyntaxKind.StringLiteral)) {\r\n        const value = initializer\r\n          .asKindOrThrow(SyntaxKind.StringLiteral)\r\n          .getLiteralValue()\r\n        if (value.startsWith(\"...\")) {\r\n          obj.insertSpreadAssignment(i, { expression: value.slice(3) })\r\n          propAssignment.remove()\r\n        }\r\n      } else if (initializer?.isKind(SyntaxKind.ObjectLiteralExpression)) {\r\n        unnestSpreadProperties(initializer as ObjectLiteralExpression)\r\n      } else if (\r\n        initializer &&\r\n        initializer.isKind(SyntaxKind.ArrayLiteralExpression)\r\n      ) {\r\n        unsetSpreadElements(\r\n          initializer.asKindOrThrow(SyntaxKind.ArrayLiteralExpression)\r\n        )\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport function unsetSpreadElements(arr: ArrayLiteralExpression) {\r\n  const elements = arr.getElements()\r\n  for (let j = 0; j < elements.length; j++) {\r\n    const element = elements[j]\r\n    if (element.isKind(SyntaxKind.ObjectLiteralExpression)) {\r\n      // Recursive check on objects within arrays\r\n      unnestSpreadProperties(\r\n        element.asKindOrThrow(SyntaxKind.ObjectLiteralExpression)\r\n      )\r\n    } else if (element.isKind(SyntaxKind.ArrayLiteralExpression)) {\r\n      // Recursive check on nested arrays\r\n      unsetSpreadElements(\r\n        element.asKindOrThrow(SyntaxKind.ArrayLiteralExpression)\r\n      )\r\n    } else if (element.isKind(SyntaxKind.StringLiteral)) {\r\n      const spreadText = element.getText()\r\n      // check if spread element\r\n      const spreadTest = /(?:^['\"])(\\.\\.\\..*)(?:['\"]$)/g\r\n      if (spreadTest.test(spreadText)) {\r\n        arr.removeElement(j)\r\n        arr.insertElement(j, spreadText.replace(spreadTest, \"$1\"))\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nasync function parseObjectLiteral(objectLiteralString: string): Promise<any> {\r\n  const sourceFile = await _createSourceFile(\r\n    `const theme = ${objectLiteralString}`,\r\n    null\r\n  )\r\n\r\n  const statement = sourceFile.getStatements()[0]\r\n  if (statement?.getKind() === SyntaxKind.VariableStatement) {\r\n    const declaration = (statement as VariableStatement)\r\n      .getDeclarationList()\r\n      ?.getDeclarations()[0]\r\n    const initializer = declaration.getInitializer()\r\n    if (initializer?.isKind(SyntaxKind.ObjectLiteralExpression)) {\r\n      return await parseObjectLiteralExpression(initializer)\r\n    }\r\n  }\r\n\r\n  throw new Error(\"Invalid input: not an object literal\")\r\n}\r\n\r\nfunction parseObjectLiteralExpression(node: ObjectLiteralExpression): any {\r\n  const result: any = {}\r\n  for (const property of node.getProperties()) {\r\n    if (property.isKind(SyntaxKind.PropertyAssignment)) {\r\n      const name = property.getName().replace(/\\'/g, \"\")\r\n      if (\r\n        property.getInitializer()?.isKind(SyntaxKind.ObjectLiteralExpression)\r\n      ) {\r\n        result[name] = parseObjectLiteralExpression(\r\n          property.getInitializer() as ObjectLiteralExpression\r\n        )\r\n      } else if (\r\n        property.getInitializer()?.isKind(SyntaxKind.ArrayLiteralExpression)\r\n      ) {\r\n        result[name] = parseArrayLiteralExpression(\r\n          property.getInitializer() as ArrayLiteralExpression\r\n        )\r\n      } else {\r\n        result[name] = parseValue(property.getInitializer())\r\n      }\r\n    }\r\n  }\r\n  return result\r\n}\r\n\r\nfunction parseArrayLiteralExpression(node: ArrayLiteralExpression): any[] {\r\n  const result: any[] = []\r\n  for (const element of node.getElements()) {\r\n    if (element.isKind(SyntaxKind.ObjectLiteralExpression)) {\r\n      result.push(\r\n        parseObjectLiteralExpression(\r\n          element.asKindOrThrow(SyntaxKind.ObjectLiteralExpression)\r\n        )\r\n      )\r\n    } else if (element.isKind(SyntaxKind.ArrayLiteralExpression)) {\r\n      result.push(\r\n        parseArrayLiteralExpression(\r\n          element.asKindOrThrow(SyntaxKind.ArrayLiteralExpression)\r\n        )\r\n      )\r\n    } else {\r\n      result.push(parseValue(element))\r\n    }\r\n  }\r\n  return result\r\n}\r\n\r\nfunction parseValue(node: any): any {\r\n  switch (node.getKind()) {\r\n    case SyntaxKind.StringLiteral:\r\n      return node.getText()\r\n    case SyntaxKind.NumericLiteral:\r\n      return Number(node.getText())\r\n    case SyntaxKind.TrueKeyword:\r\n      return true\r\n    case SyntaxKind.FalseKeyword:\r\n      return false\r\n    case SyntaxKind.NullKeyword:\r\n      return null\r\n    case SyntaxKind.ArrayLiteralExpression:\r\n      return node.getElements().map(parseValue)\r\n    case SyntaxKind.ObjectLiteralExpression:\r\n      return parseObjectLiteralExpression(node)\r\n    default:\r\n      return node.getText()\r\n  }\r\n}\r\n\r\nexport function buildTailwindThemeColorsFromCssVars(\r\n  cssVars: z.infer<typeof registryItemCssVarsSchema>\r\n) {\r\n  const result: Record<string, any> = {}\r\n\r\n  for (const key of Object.keys(cssVars)) {\r\n    const parts = key.split(\"-\")\r\n    const colorName = parts[0]\r\n    const subType = parts.slice(1).join(\"-\")\r\n\r\n    if (subType === \"\") {\r\n      if (typeof result[colorName] === \"object\") {\r\n        result[colorName].DEFAULT = `hsl(var(--${key}))`\r\n      } else {\r\n        result[colorName] = `hsl(var(--${key}))`\r\n      }\r\n    } else {\r\n      if (typeof result[colorName] !== \"object\") {\r\n        result[colorName] = { DEFAULT: `hsl(var(--${colorName}))` }\r\n      }\r\n      result[colorName][subType] = `hsl(var(--${key}))`\r\n    }\r\n  }\r\n\r\n  // Remove DEFAULT if it's not in the original cssVars\r\n  for (const [colorName, value] of Object.entries(result)) {\r\n    if (\r\n      typeof value === \"object\" &&\r\n      value.DEFAULT === `hsl(var(--${colorName}))` &&\r\n      !(colorName in cssVars)\r\n    ) {\r\n      delete value.DEFAULT\r\n    }\r\n  }\r\n\r\n  return result\r\n}\r\n","// Internal function that fetches registry items without clearing context.\r\nimport { Config, getTargetStyleFromConfig } from \"@/src/utils/get-config\";\r\nimport { getProjectTailwindVersionFromConfig } from \"@/src/utils/get-project-info\";\r\nimport { buildTailwindThemeColorsFromCssVars } from \"@/src/utils/updaters/update-tailwind-config\";\r\nimport { createHash } from \"crypto\";\r\nimport deepmerge from \"deepmerge\";\r\nimport path from \"path\";\r\nimport z from \"zod\";\r\nimport { getRegistryBaseColor, getUidesuRegistryIndex } from \"./api\";\r\nimport { buildUrlAndHeadersForRegistryItem, resolveRegistryUrl } from \"./builder\";\r\nimport { setRegistryHeaders } from \"./context\";\r\nimport { RegistryNotConfiguredError, RegistryParseError } from \"./errors\";\r\nimport { fetchRegistry, fetchRegistryLocal } from \"./fetcher\";\r\nimport { parseRegistryAndItemFromString } from \"./parser\";\r\nimport { registryItemSchema, registryResolvedItemsTreeSchema } from \"./schema\";\r\nimport { deduplicateFilesByTarget, isLocalFile, isUrl } from \"./utils\";\r\n\r\nexport function resolveRegistryItemsFromRegistries(\r\n  items: string[],\r\n  config: Config\r\n) {\r\n  const registryHeaders: Record<string, Record<string, string>> = {};\r\n  const resolvedItems = [...items];\r\n\r\n  if (!config?.registries) {\r\n    setRegistryHeaders({});\r\n    return resolvedItems;\r\n  }\r\n\r\n  for (let i = 0; i < resolvedItems.length; i++) {\r\n    const resolved = buildUrlAndHeadersForRegistryItem(resolvedItems[i], config);\r\n\r\n    if (resolved) {\r\n      resolvedItems[i] = resolved.url;\r\n\r\n      if (Object.keys(resolved.headers).length > 0) {\r\n        registryHeaders[resolved.url] = resolved.headers;\r\n      }\r\n    }\r\n  }\r\n\r\n  setRegistryHeaders(registryHeaders);\r\n\r\n  return resolvedItems;\r\n}\r\n\r\n// This is used for recursive dependecy resolution.\r\nexport async function fetchRegistryItems(\r\n  items: string[],\r\n  config: Config,\r\n  options: { useCache?: boolean } = {}\r\n) {\r\n  const results = await Promise.all(\r\n    items.map(async (item) => {\r\n      if (isLocalFile(item)) {\r\n        return fetchRegistryLocal(item);\r\n      }\r\n\r\n      if (isUrl(item)) {\r\n        const [result] = await fetchRegistry([item], options);\r\n        try {\r\n          return registryItemSchema.parse(result);\r\n        } catch (error) {\r\n          throw new RegistryParseError(item, error);\r\n        }\r\n      }\r\n\r\n      if (item.startsWith(\"@\") && config?.registries) {\r\n        const paths = resolveRegistryItemsFromRegistries([item], config);\r\n        const [result] = await fetchRegistry(paths, options);\r\n        try {\r\n          return registryItemSchema.parse(result);\r\n        } catch (error) {\r\n          throw new RegistryParseError(item, error);\r\n        }\r\n      }\r\n\r\n\r\n      const path = `styles/${config?.style ?? \"aodesu\"}/${item}.json`;\r\n      const [result] = await fetchRegistry([path], options);\r\n        console.log(\"TEST - LLEGO AKI\")\r\n      try {\r\n        return registryItemSchema.parse(result);\r\n      } catch (error) {\r\n        throw new RegistryParseError(item, error);\r\n      }\r\n    })\r\n  )\r\n\r\n  return results;\r\n}\r\n\r\n// Helper schema for items with source tracking\r\nconst registryItemWithSourceSchema = registryItemSchema.extend({\r\n  _source: z.string().optional(),\r\n});\r\n\r\n\r\n// Resolves a list of registry items with all their dependencies and returns\r\n// a complete installation bundle with merged configuration.\r\nexport async function resolveRegistryTree(\r\n  names: z.infer<typeof registryItemSchema>[\"name\"][],\r\n  config: Config,\r\n  options: { useCache?: boolean } = {}\r\n) {\r\n  options = {\r\n    useCache: true,\r\n    ...options,\r\n  }\r\n\r\n  let payload: z.infer<typeof registryItemWithSourceSchema>[] = []\r\n  let allDependencyItems: z.infer<typeof registryItemWithSourceSchema>[] = []\r\n  let allDependencyRegistryNames: string[] = []\r\n\r\n  const uniqueNames = Array.from(new Set(names))\r\n\r\n  const results = await fetchRegistryItems(uniqueNames, config, options)\r\n\r\n  const resultMap = new Map<string, z.infer<typeof registryItemSchema>>()\r\n  for (let i = 0; i < results.length; i++) {\r\n    if (results[i]) {\r\n      resultMap.set(uniqueNames[i], results[i])\r\n    }\r\n  }\r\n\r\n  for (const [sourceName, item] of Array.from(resultMap.entries())) {\r\n    // Add source tracking\r\n    const itemWithSource: z.infer<typeof registryItemWithSourceSchema> = {\r\n      ...item,\r\n      _source: sourceName,\r\n    }\r\n    payload.push(itemWithSource)\r\n\r\n    if (item.registryDependencies) {\r\n      // Resolve namespace syntax and set headers for dependencies\r\n      let resolvedDependencies = item.registryDependencies\r\n\r\n      // Check for namespaced dependencies when no registries are configured\r\n      if (!config?.registries) {\r\n        const namespacedDeps = item.registryDependencies.filter((dep: string) =>\r\n          dep.startsWith(\"@\")\r\n        )\r\n        if (namespacedDeps.length > 0) {\r\n          const { registry } = parseRegistryAndItemFromString(namespacedDeps[0])\r\n          throw new RegistryNotConfiguredError(registry)\r\n        }\r\n      } else {\r\n        resolvedDependencies = resolveRegistryItemsFromRegistries(\r\n          item.registryDependencies,\r\n          config\r\n        )\r\n      }\r\n\r\n      const { items, registryNames } = await resolveDependenciesRecursively(\r\n        resolvedDependencies,\r\n        config,\r\n        options,\r\n        new Set(uniqueNames)\r\n      )\r\n      allDependencyItems.push(...items)\r\n      allDependencyRegistryNames.push(...registryNames)\r\n    }\r\n  }\r\n\r\n  payload.push(...allDependencyItems)\r\n\r\n  // Handle any remaining registry names that need index resolution\r\n  if (allDependencyRegistryNames.length > 0) {\r\n    // Remove duplicates from registry names\r\n    const uniqueRegistryNames = Array.from(new Set(allDependencyRegistryNames))\r\n\r\n    // Separate namespaced and non-namespaced items\r\n    const nonNamespacedItems = uniqueRegistryNames.filter(\r\n      (name) => !name.startsWith(\"@\")\r\n    )\r\n    const namespacedDepItems = uniqueRegistryNames.filter((name) =>\r\n      name.startsWith(\"@\")\r\n    )\r\n\r\n    // Handle namespaced dependency items\r\n    if (namespacedDepItems.length > 0) {\r\n      // This will now throw specific errors on failure\r\n      const depResults = await fetchRegistryItems(\r\n        namespacedDepItems,\r\n        config,\r\n        options\r\n      )\r\n\r\n      for (let i = 0; i < depResults.length; i++) {\r\n        const item = depResults[i]\r\n        const itemWithSource: z.infer<typeof registryItemWithSourceSchema> = {\r\n          ...item,\r\n          _source: namespacedDepItems[i],\r\n        }\r\n        payload.push(itemWithSource)\r\n      }\r\n    }\r\n\r\n    // For non-namespaced items, we need the index and style resolution\r\n    if (nonNamespacedItems.length > 0) {\r\n      const index = await getUidesuRegistryIndex()\r\n      if (!index && payload.length === 0) {\r\n        return null\r\n      }\r\n\r\n      if (index) {\r\n        // If we're resolving the index, we want it to go first\r\n        if (nonNamespacedItems.includes(\"index\")) {\r\n          nonNamespacedItems.unshift(\"index\")\r\n        }\r\n\r\n        // Resolve non-namespaced items through the existing flow\r\n        // Get URLs for all registry items including their dependencies\r\n        const registryUrls: string[] = []\r\n        for (const name of nonNamespacedItems) {\r\n          const itemDependencies = await resolveRegistryDependencies(\r\n            name,\r\n            config,\r\n            options\r\n          )\r\n          registryUrls.push(...itemDependencies)\r\n        }\r\n\r\n        // Deduplicate URLs\r\n        const uniqueUrls = Array.from(new Set(registryUrls))\r\n        let result = await fetchRegistry(uniqueUrls, options)\r\n        const registryPayload = z.array(registryItemSchema).parse(result)\r\n        payload.push(...registryPayload)\r\n      }\r\n    }\r\n  }\r\n\r\n  if (!payload.length) {\r\n    return null\r\n  }\r\n\r\n  // No deduplication - we want to support multiple items with the same name from different sources\r\n\r\n  // If we're resolving the index, we want to fetch\r\n  // the theme item if a base color is provided.\r\n  // We do this for index only.\r\n  // Other components will ship with their theme tokens.\r\n  if (\r\n    uniqueNames.includes(\"index\") ||\r\n    allDependencyRegistryNames.includes(\"index\")\r\n  ) {\r\n    if (config.tailwind.baseColor) {\r\n      const theme = await registryGetTheme(config.tailwind.baseColor, config)\r\n      if (theme) {\r\n        payload.unshift(theme)\r\n      }\r\n    }\r\n  }\r\n\r\n  // Build source map for topological sort\r\n  const sourceMap = new Map<z.infer<typeof registryItemSchema>, string>()\r\n  payload.forEach((item) => {\r\n    // Use the _source property if it was added, otherwise use the name\r\n    const source = item._source || item.name\r\n    sourceMap.set(item, source)\r\n  })\r\n\r\n  // Apply topological sort to ensure dependencies come before dependents\r\n  payload = topologicalSortRegistryItems(payload, sourceMap)\r\n\r\n  // Sort the payload so that registry:theme items come first,\r\n  // while maintaining the relative order of all items.\r\n  payload.sort((a, b) => {\r\n    if (a.type === \"registry:theme\" && b.type !== \"registry:theme\") {\r\n      return -1\r\n    }\r\n    if (a.type !== \"registry:theme\" && b.type === \"registry:theme\") {\r\n      return 1\r\n    }\r\n    return 0\r\n  })\r\n\r\n  let tailwind = {}\r\n  payload.forEach((item) => {\r\n    tailwind = deepmerge(tailwind, item.tailwind ?? {})\r\n  })\r\n\r\n  let cssVars = {}\r\n  payload.forEach((item) => {\r\n    cssVars = deepmerge(cssVars, item.cssVars ?? {})\r\n  })\r\n\r\n  let css = {}\r\n  payload.forEach((item) => {\r\n    css = deepmerge(css, item.css ?? {})\r\n  })\r\n\r\n  let docs = \"\"\r\n  payload.forEach((item) => {\r\n    if (item.docs) {\r\n      docs += `${item.docs}\\n`\r\n    }\r\n  })\r\n\r\n  let envVars = {}\r\n  payload.forEach((item) => {\r\n    envVars = deepmerge(envVars, item.envVars ?? {})\r\n  })\r\n\r\n  // Deduplicate files based on resolved target paths.\r\n  const deduplicatedFiles = await deduplicateFilesByTarget(\r\n    payload.map((item) => item.files ?? []),\r\n    config\r\n  )\r\n\r\n  const parsed = registryResolvedItemsTreeSchema.parse({\r\n    dependencies: deepmerge.all(payload.map((item) => item.dependencies ?? [])),\r\n    devDependencies: deepmerge.all(\r\n      payload.map((item) => item.devDependencies ?? [])\r\n    ),\r\n    files: deduplicatedFiles,\r\n    tailwind,\r\n    cssVars,\r\n    css,\r\n    docs,\r\n  })\r\n\r\n  if (Object.keys(envVars).length > 0) {\r\n    parsed.envVars = envVars\r\n  }\r\n\r\n  return parsed\r\n}\r\n\r\nasync function resolveDependenciesRecursively(\r\n  dependencies: string[],\r\n  config: Config,\r\n  options: { useCache?: boolean } = {},\r\n  visited: Set<string> = new Set()\r\n) {\r\n  const items: z.infer<typeof registryItemSchema>[] = []\r\n  const registryNames: string[] = []\r\n\r\n  for (const dep of dependencies) {\r\n    if (visited.has(dep)) {\r\n      continue\r\n    }\r\n    visited.add(dep)\r\n\r\n    // Handle URLs and local files directly.\r\n    if (isUrl(dep) || isLocalFile(dep)) {\r\n      const [item] = await fetchRegistryItems([dep], config, options)\r\n      if (item) {\r\n        items.push(item)\r\n        if (item.registryDependencies) {\r\n          // Resolve namespaced dependencies to set proper headers.\r\n          const resolvedDeps = config?.registries\r\n            ? resolveRegistryItemsFromRegistries(\r\n                item.registryDependencies,\r\n                config\r\n              )\r\n            : item.registryDependencies\r\n\r\n          const nested = await resolveDependenciesRecursively(\r\n            resolvedDeps,\r\n            config,\r\n            options,\r\n            visited\r\n          )\r\n          items.push(...nested.items)\r\n          registryNames.push(...nested.registryNames)\r\n        }\r\n      }\r\n    }\r\n    // Handle namespaced items (e.g., @one/foo, @two/bar).\r\n    else if (dep.startsWith(\"@\") && config?.registries) {\r\n      // Check if the registry exists.\r\n      const { registry } = parseRegistryAndItemFromString(dep)\r\n      if (registry && !(registry in config.registries)) {\r\n        throw new RegistryNotConfiguredError(registry)\r\n      }\r\n\r\n      // Let getRegistryItem handle the namespaced item with config\r\n      // This ensures proper authentication headers are used\r\n      const [item] = await fetchRegistryItems([dep], config, options)\r\n      if (item) {\r\n        items.push(item)\r\n        if (item.registryDependencies) {\r\n          // Resolve namespaced dependencies to set proper headers.\r\n          const resolvedDeps = config?.registries\r\n            ? resolveRegistryItemsFromRegistries(\r\n                item.registryDependencies,\r\n                config\r\n              )\r\n            : item.registryDependencies\r\n\r\n          const nested = await resolveDependenciesRecursively(\r\n            resolvedDeps,\r\n            config,\r\n            options,\r\n            visited\r\n          )\r\n          items.push(...nested.items)\r\n          registryNames.push(...nested.registryNames)\r\n        }\r\n      }\r\n    }\r\n    // Handle regular component names.\r\n    else {\r\n      registryNames.push(dep)\r\n\r\n      if (config) {\r\n        try {\r\n          const [item] = await fetchRegistryItems([dep], config, options)\r\n          if (item && item.registryDependencies) {\r\n            // Resolve namespaced dependencies to set proper headers.\r\n            const resolvedDeps = config?.registries\r\n              ? resolveRegistryItemsFromRegistries(\r\n                  item.registryDependencies,\r\n                  config\r\n                )\r\n              : item.registryDependencies\r\n\r\n            const nested = await resolveDependenciesRecursively(\r\n              resolvedDeps,\r\n              config,\r\n              options,\r\n              visited\r\n            )\r\n            items.push(...nested.items)\r\n            registryNames.push(...nested.registryNames)\r\n          }\r\n        } catch (error) {\r\n          // If we can't fetch the registry item, that's okay - we'll still\r\n          // include the name.\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  return { items, registryNames }\r\n}\r\n\r\nasync function resolveRegistryDependencies(\r\n  url: string,\r\n  config: Config,\r\n  options: { useCache?: boolean } = {}\r\n) {\r\n  if (isUrl(url)) {\r\n    return [url]\r\n  }\r\n\r\n  const { registryNames } = await resolveDependenciesRecursively(\r\n    [url],\r\n    config,\r\n    options,\r\n    new Set()\r\n  )\r\n\r\n  const style = config.resolvedPaths?.cwd\r\n    ? await getTargetStyleFromConfig(config.resolvedPaths.cwd, config.style)\r\n    : config.style\r\n\r\n  const urls = registryNames.map((name) =>\r\n    resolveRegistryUrl(isUrl(name) ? name : `styles/${style}/${name}.json`)\r\n  )\r\n\r\n  return Array.from(new Set(urls))\r\n}\r\n\r\nasync function registryGetTheme(name: string, config: Config) {\r\n  const [baseColor, tailwindVersion] = await Promise.all([\r\n    getRegistryBaseColor(name),\r\n    getProjectTailwindVersionFromConfig(config),\r\n  ])\r\n  if (!baseColor) {\r\n    return null\r\n  }\r\n\r\n  // TODO: Move this to the registry i.e registry:theme.\r\n  const theme = {\r\n    name,\r\n    type: \"registry:theme\",\r\n    tailwind: {\r\n      config: {\r\n        theme: {\r\n          extend: {\r\n            borderRadius: {\r\n              lg: \"var(--radius)\",\r\n              md: \"calc(var(--radius) - 2px)\",\r\n              sm: \"calc(var(--radius) - 4px)\",\r\n            },\r\n            colors: {},\r\n          },\r\n        },\r\n      },\r\n    },\r\n    cssVars: {\r\n      theme: {},\r\n      light: {\r\n        radius: \"0.5rem\",\r\n      },\r\n      dark: {},\r\n    },\r\n  } satisfies z.infer<typeof registryItemSchema>\r\n\r\n  if (config.tailwind.cssVariables) {\r\n    theme.tailwind.config.theme.extend.colors = {\r\n      ...theme.tailwind.config.theme.extend.colors,\r\n      ...buildTailwindThemeColorsFromCssVars(baseColor.cssVars.dark ?? {}),\r\n    }\r\n    theme.cssVars = {\r\n      theme: {\r\n        ...baseColor.cssVars.theme,\r\n        ...theme.cssVars.theme,\r\n      },\r\n      light: {\r\n        ...baseColor.cssVars.light,\r\n        ...theme.cssVars.light,\r\n      },\r\n      dark: {\r\n        ...baseColor.cssVars.dark,\r\n        ...theme.cssVars.dark,\r\n      },\r\n    }\r\n\r\n    if (tailwindVersion === \"v4\" && baseColor.cssVarsV4) {\r\n      theme.cssVars = {\r\n        theme: {\r\n          ...baseColor.cssVarsV4.theme,\r\n          ...theme.cssVars.theme,\r\n        },\r\n        light: {\r\n          radius: \"0.625rem\",\r\n          ...baseColor.cssVarsV4.light,\r\n        },\r\n        dark: {\r\n          ...baseColor.cssVarsV4.dark,\r\n        },\r\n      }\r\n    }\r\n  }\r\n\r\n  return theme\r\n}\r\n\r\nfunction computeItemHash(\r\n  item: Pick<z.infer<typeof registryItemSchema>, \"name\">,\r\n  source?: string\r\n) {\r\n  const identifier = source || item.name\r\n\r\n  const hash = createHash(\"sha256\")\r\n    .update(identifier)\r\n    .digest(\"hex\")\r\n    .substring(0, 8)\r\n\r\n  return `${item.name}::${hash}`\r\n}\r\n\r\nfunction extractItemIdentifierFromDependency(dependency: string) {\r\n  if (isUrl(dependency)) {\r\n    const url = new URL(dependency)\r\n    const pathname = url.pathname\r\n    const match = pathname.match(/\\/([^/]+)\\.json$/)\r\n    const name = match ? match[1] : path.basename(pathname, \".json\")\r\n\r\n    return {\r\n      name,\r\n      hash: computeItemHash({ name }, dependency),\r\n    }\r\n  }\r\n\r\n  if (isLocalFile(dependency)) {\r\n    const match = dependency.match(/\\/([^/]+)\\.json$/)\r\n    const name = match ? match[1] : path.basename(dependency, \".json\")\r\n\r\n    return {\r\n      name,\r\n      hash: computeItemHash({ name }, dependency),\r\n    }\r\n  }\r\n\r\n  const { item } = parseRegistryAndItemFromString(dependency)\r\n  return {\r\n    name: item,\r\n    hash: computeItemHash({ name: item }, dependency),\r\n  }\r\n}\r\n\r\nfunction topologicalSortRegistryItems(\r\n  items: z.infer<typeof registryItemSchema>[],\r\n  sourceMap: Map<z.infer<typeof registryItemSchema>, string>\r\n) {\r\n  const itemMap = new Map<string, z.infer<typeof registryItemSchema>>()\r\n  const hashToItem = new Map<string, z.infer<typeof registryItemSchema>>()\r\n  const inDegree = new Map<string, number>()\r\n  const adjacencyList = new Map<string, string[]>()\r\n\r\n  items.forEach((item) => {\r\n    const source = sourceMap.get(item) || item.name\r\n    const hash = computeItemHash(item, source)\r\n\r\n    itemMap.set(hash, item)\r\n    hashToItem.set(hash, item)\r\n    inDegree.set(hash, 0)\r\n    adjacencyList.set(hash, [])\r\n  })\r\n\r\n  // Build a map of dependency to possible items.\r\n  const depToHashes = new Map<string, string[]>()\r\n  items.forEach((item) => {\r\n    const source = sourceMap.get(item) || item.name\r\n    const hash = computeItemHash(item, source)\r\n\r\n    if (!depToHashes.has(item.name)) {\r\n      depToHashes.set(item.name, [])\r\n    }\r\n    depToHashes.get(item.name)!.push(hash)\r\n\r\n    if (source !== item.name) {\r\n      if (!depToHashes.has(source)) {\r\n        depToHashes.set(source, [])\r\n      }\r\n      depToHashes.get(source)!.push(hash)\r\n    }\r\n  })\r\n\r\n  items.forEach((item) => {\r\n    const itemSource = sourceMap.get(item) || item.name\r\n    const itemHash = computeItemHash(item, itemSource)\r\n\r\n    if (item.registryDependencies) {\r\n      item.registryDependencies.forEach((dep) => {\r\n        let depHash: string | undefined\r\n\r\n        const exactMatches = depToHashes.get(dep) || []\r\n        if (exactMatches.length === 1) {\r\n          depHash = exactMatches[0]\r\n        } else if (exactMatches.length > 1) {\r\n          // Multiple matches - try to disambiguate.\r\n          // For now, just use the first one and warn.\r\n          depHash = exactMatches[0]\r\n        } else {\r\n          const { name } = extractItemIdentifierFromDependency(dep)\r\n          const nameMatches = depToHashes.get(name) || []\r\n          if (nameMatches.length > 0) {\r\n            depHash = nameMatches[0]\r\n          }\r\n        }\r\n\r\n        if (depHash && itemMap.has(depHash)) {\r\n          adjacencyList.get(depHash)!.push(itemHash)\r\n          inDegree.set(itemHash, inDegree.get(itemHash)! + 1)\r\n        }\r\n      })\r\n    }\r\n  })\r\n\r\n  // Implements Kahn's algorithm.\r\n  const queue: string[] = []\r\n  const sorted: z.infer<typeof registryItemSchema>[] = []\r\n\r\n  inDegree.forEach((degree, hash) => {\r\n    if (degree === 0) {\r\n      queue.push(hash)\r\n    }\r\n  })\r\n\r\n  while (queue.length > 0) {\r\n    const currentHash = queue.shift()!\r\n    const item = itemMap.get(currentHash)!\r\n    sorted.push(item)\r\n\r\n    adjacencyList.get(currentHash)!.forEach((dependentHash) => {\r\n      const newDegree = inDegree.get(dependentHash)! - 1\r\n      inDegree.set(dependentHash, newDegree)\r\n\r\n      if (newDegree === 0) {\r\n        queue.push(dependentHash)\r\n      }\r\n    })\r\n  }\r\n\r\n  if (sorted.length !== items.length) {\r\n    console.warn(\"Circular dependency detected in registry items\")\r\n    // Return all items even if there are circular dependencies\r\n    // Items not in sorted are part of circular dependencies\r\n    const sortedHashes = new Set(\r\n      sorted.map((item) => {\r\n        const source = sourceMap.get(item) || item.name\r\n        return computeItemHash(item, source)\r\n      })\r\n    )\r\n\r\n    items.forEach((item) => {\r\n      const source = sourceMap.get(item) || item.name\r\n      const hash = computeItemHash(item, source)\r\n      if (!sortedHashes.has(hash)) {\r\n        sorted.push(item)\r\n      }\r\n    })\r\n  }\r\n\r\n  return sorted\r\n}\r\n","import z from \"zod\";\r\nimport { Config } from \"../utils/get-config\";\r\nimport { handleError } from \"../utils/handle-error\";\r\nimport { logger } from \"../utils/logger\";\r\nimport { buildUrlAndHeadersForRegistryItem } from \"./builder\";\r\nimport { configWithDefaults } from \"./config\";\r\nimport { BASE_COLORS, REGISTRY_URL } from \"./constants\";\r\nimport { clearRegistryContext, setRegistryHeaders } from \"./context\";\r\nimport { RegistriesIndexParseError, RegistryInvalidNamespaceError, RegistryNotFoundError, RegistryParseError } from \"./errors\";\r\nimport { fetchRegistry } from \"./fetcher\";\r\nimport { fetchRegistryItems } from \"./resolver\";\r\nimport { iconsSchema, registriesIndexSchema, registryBaseColorSchema, registryIndexSchema, registrySchema, stylesSchema } from \"./schema\";\r\nimport { isUrl } from \"./utils\";\r\n\r\nexport async function getRegistry(\r\n  name: string,\r\n  options?: {\r\n    config?: Partial<Config>\r\n    useCache?: boolean\r\n  }\r\n) {\r\n  const { config, useCache } = options || {};\r\n\r\n  if (isUrl(name)) {\r\n    const [result] = await fetchRegistry([name], { useCache });\r\n    try {\r\n      return registrySchema.parse(result);\r\n    } catch (error) {\r\n      throw new RegistryParseError(name, error);\r\n    }\r\n  }\r\n\r\n  if (!name.startsWith(\"@\")) {\r\n    throw new RegistryInvalidNamespaceError(name);\r\n  }\r\n\r\n  let registryName = name;\r\n  if (!registryName.endsWith(\"/registry\")) {\r\n    registryName = `${registryName}/registry`\r\n  }\r\n\r\n  const urlAndHeaders = buildUrlAndHeadersForRegistryItem(\r\n    registryName as `@${string}`,\r\n    configWithDefaults(config)\r\n  );\r\n\r\n  if (!urlAndHeaders?.url) {\r\n    throw new RegistryNotFoundError(registryName);\r\n  }\r\n\r\n  if (urlAndHeaders.headers && Object.keys(urlAndHeaders.headers).length > 0) {\r\n    setRegistryHeaders({\r\n      [urlAndHeaders.url]: urlAndHeaders.headers,\r\n    })\r\n  }\r\n\r\n  const [result] = await fetchRegistry([urlAndHeaders.url], { useCache });\r\n\r\n  try {\r\n    return registrySchema.parse(result);\r\n  } catch (error) {\r\n    throw new RegistryParseError(registryName, error);\r\n  }\r\n}\r\n\r\nexport async function getRegistryItems(\r\n  items: string[],\r\n  options?: {\r\n    config?: Partial<Config>\r\n    useCache?: boolean\r\n  }\r\n) {\r\n  const { config, useCache } = options || {};\r\n\r\n  clearRegistryContext();\r\n\r\n  return fetchRegistryItems(items, configWithDefaults(config), { useCache })\r\n}\r\n\r\nexport async function getUidesuRegistryIndex() {\r\n  try {\r\n    const [result] = await fetchRegistry([\"index.json\"])\r\n\r\n    return registryIndexSchema.parse(result)\r\n  } catch (error) {\r\n    logger.error(\"\\n\")\r\n    handleError(error)\r\n  }\r\n}\r\n\r\nexport async function getRegistryStyles() {\r\n  try {\r\n    const [result] = await fetchRegistry([\"styles/index.json\"]);\r\n\r\n    return stylesSchema.parse(result);\r\n  } catch (error) {\r\n    logger.error(\"\\n\");\r\n    handleError(error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getRegistryIcons() {\r\n  try {\r\n    const [result] = await fetchRegistry([\"icons/index.json\"])\r\n    return iconsSchema.parse(result)\r\n  } catch (error) {\r\n    handleError(error)\r\n    return {}\r\n  }\r\n}\r\n\r\nexport async function getRegistryBaseColors() {\r\n  return BASE_COLORS\r\n}\r\n\r\nexport async function getRegistryBaseColor(baseColor: string) {\r\n  try {\r\n    const [result] = await fetchRegistry([`colors/${baseColor}.json`])\r\n\r\n    return registryBaseColorSchema.parse(result)\r\n  } catch (error) {\r\n    handleError(error)\r\n  }\r\n}\r\n\r\nexport async function getRegistriesIndex(options?: { useCache?: boolean }) {\r\n  options = {\r\n    useCache: true,\r\n    ...options,\r\n  }\r\n\r\n  const url = `${REGISTRY_URL}/registries.json`\r\n  const [data] = await fetchRegistry([url], {\r\n    useCache: options.useCache,\r\n  })\r\n\r\n  try {\r\n    return registriesIndexSchema.parse(data)\r\n  } catch (error) {\r\n    if (error instanceof z.ZodError) {\r\n      throw new RegistriesIndexParseError(error)\r\n    }\r\n\r\n    throw error\r\n  }\r\n}\r\n","import path from \"path\"\r\n\r\nexport function isSafeTarget(targetPath: string, cwd: string): boolean {\r\n  // Check for null bytes which can be used to bypass validations.\r\n  if (targetPath.includes(\"\\0\")) {\r\n    return false\r\n  }\r\n\r\n  // Decode URL-encoded sequences to catch encoded traversal attempts.\r\n  let decodedPath: string\r\n  try {\r\n    // Decode multiple times to catch double-encoded sequences.\r\n    decodedPath = targetPath\r\n    let prevPath = \"\"\r\n    while (decodedPath !== prevPath && decodedPath.includes(\"%\")) {\r\n      prevPath = decodedPath\r\n      decodedPath = decodeURIComponent(decodedPath)\r\n    }\r\n  } catch {\r\n    // If decoding fails, treat as unsafe.\r\n    return false\r\n  }\r\n\r\n  // Normalize both paths to handle different path separators.\r\n  // Convert Windows backslashes to forward slashes for consistent handling.\r\n  const normalizedTarget = path.normalize(decodedPath.replace(/\\\\/g, \"/\"))\r\n  const normalizedRoot = path.normalize(cwd)\r\n\r\n  // Check for explicit path traversal sequences in both encoded and decoded forms.\r\n  // Allow [...] pattern which is common in framework routing (e.g., [...slug])\r\n  const hasPathTraversal = (path: string) => {\r\n    // Remove [...] patterns before checking for ..\r\n    const withoutBrackets = path.replace(/\\[\\.\\.\\..*?\\]/g, \"\")\r\n    return withoutBrackets.includes(\"..\")\r\n  }\r\n\r\n  if (\r\n    hasPathTraversal(normalizedTarget) ||\r\n    hasPathTraversal(decodedPath) ||\r\n    hasPathTraversal(targetPath)\r\n  ) {\r\n    return false\r\n  }\r\n\r\n  // Check for current directory references that might be used in traversal.\r\n  // First, remove [...] patterns to avoid false positives\r\n  const cleanPath = (path: string) => path.replace(/\\[\\.\\.\\..*?\\]/g, \"\")\r\n  const cleanTarget = cleanPath(targetPath)\r\n  const cleanDecoded = cleanPath(decodedPath)\r\n\r\n  const suspiciousPatterns = [\r\n    /\\.\\.[\\/\\\\]/, // ../ or ..\\\r\n    /[\\/\\\\]\\.\\./, // /.. or \\..\r\n    /\\.\\./, // .. anywhere\r\n    /\\.\\.%/, // URL encoded traversal\r\n    /\\x00/, // null byte\r\n    /[\\x01-\\x1f]/, // control characters\r\n  ]\r\n\r\n  if (\r\n    suspiciousPatterns.some(\r\n      (pattern) => pattern.test(cleanTarget) || pattern.test(cleanDecoded)\r\n    )\r\n  ) {\r\n    return false\r\n  }\r\n\r\n  // Allow ~/ at the start (home directory expansion within project) but reject ~/../ patterns.\r\n  if (\r\n    (targetPath.includes(\"~\") || decodedPath.includes(\"~\")) &&\r\n    (targetPath.includes(\"../\") || decodedPath.includes(\"../\"))\r\n  ) {\r\n    return false\r\n  }\r\n\r\n  // Check for Windows drive letters (even on non-Windows systems for safety).\r\n  const driveLetterRegex = /^[a-zA-Z]:[\\/\\\\]/\r\n  if (driveLetterRegex.test(decodedPath)) {\r\n    // On Windows, check if it starts with the project root.\r\n    if (process.platform === \"win32\") {\r\n      return decodedPath.toLowerCase().startsWith(cwd.toLowerCase())\r\n    }\r\n    // On non-Windows systems, reject all Windows absolute paths.\r\n    return false\r\n  }\r\n\r\n  // If it's an absolute path, ensure it's within the project root.\r\n  if (path.isAbsolute(normalizedTarget)) {\r\n    return normalizedTarget.startsWith(normalizedRoot + path.sep)\r\n  }\r\n\r\n  // For relative paths, resolve and check if within project bounds.\r\n  const resolvedPath = path.resolve(normalizedRoot, normalizedTarget)\r\n  return (\r\n    resolvedPath.startsWith(normalizedRoot + path.sep) ||\r\n    resolvedPath === normalizedRoot\r\n  )\r\n}\r\n","import { registryItemCssSchema } from \"@/src/schema\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\nimport { highlighter } from \"@/src/utils/highlighter\"\r\nimport { spinner } from \"@/src/utils/spinner\"\r\nimport { promises as fs } from \"fs\"\r\nimport path from \"path\"\r\nimport postcss from \"postcss\"\r\nimport AtRule from \"postcss/lib/at-rule\"\r\nimport Declaration from \"postcss/lib/declaration\"\r\nimport Root from \"postcss/lib/root\"\r\nimport Rule from \"postcss/lib/rule\"\r\nimport { z } from \"zod\"\r\n\r\nexport async function updateCss(\r\n  css: z.infer<typeof registryItemCssSchema> | undefined,\r\n  config: Config,\r\n  options: {\r\n    silent?: boolean\r\n  }\r\n) {\r\n  if (\r\n    !config.resolvedPaths.tailwindCss ||\r\n    !css ||\r\n    Object.keys(css).length === 0\r\n  ) {\r\n    return\r\n  }\r\n\r\n  options = {\r\n    silent: false,\r\n    ...options,\r\n  }\r\n\r\n  const cssFilepath = config.resolvedPaths.tailwindCss\r\n  const cssFilepathRelative = path.relative(\r\n    config.resolvedPaths.cwd,\r\n    cssFilepath\r\n  )\r\n  const cssSpinner = spinner(\r\n    `Updating ${highlighter.info(cssFilepathRelative)}`,\r\n    {\r\n      silent: options.silent,\r\n    }\r\n  ).start()\r\n\r\n  const raw = await fs.readFile(cssFilepath, \"utf8\")\r\n  let output = await transformCss(raw, css)\r\n  await fs.writeFile(cssFilepath, output, \"utf8\")\r\n  cssSpinner.succeed()\r\n}\r\n\r\nexport async function transformCss(\r\n  input: string,\r\n  css: z.infer<typeof registryItemCssSchema>\r\n) {\r\n  const plugins = [updateCssPlugin(css)]\r\n\r\n  const result = await postcss(plugins).process(input, {\r\n    from: undefined,\r\n  })\r\n\r\n  let output = result.css\r\n\r\n  // PostCSS doesn't add semicolons to at-rules without bodies when they're the last node.\r\n  // We need to manually ensure they have semicolons.\r\n  const root = result.root\r\n  if (root.nodes && root.nodes.length > 0) {\r\n    const lastNode = root.nodes[root.nodes.length - 1]\r\n    if (\r\n      lastNode.type === \"atrule\" &&\r\n      !lastNode.nodes &&\r\n      !output.trimEnd().endsWith(\";\")\r\n    ) {\r\n      output = output.trimEnd() + \";\"\r\n    }\r\n  }\r\n\r\n  output = output.replace(/\\/\\* ---break--- \\*\\//g, \"\")\r\n  output = output.replace(/(\\n\\s*\\n)+/g, \"\\n\\n\")\r\n  output = output.trimEnd()\r\n\r\n  return output\r\n}\r\n\r\nfunction updateCssPlugin(css: z.infer<typeof registryItemCssSchema>) {\r\n  return {\r\n    postcssPlugin: \"update-css\",\r\n    Once(root: Root) {\r\n      for (const [selector, properties] of Object.entries(css)) {\r\n        if (selector.startsWith(\"@\")) {\r\n          // Handle at-rules (@layer, @utility, etc.)\r\n          const atRuleMatch = selector.match(/@([a-zA-Z-]+)\\s*(.*)/)\r\n          if (!atRuleMatch) continue\r\n\r\n          const [, name, params] = atRuleMatch\r\n\r\n          // Special handling for imports - place them at the top.\r\n          if (name === \"import\") {\r\n            // Check if this import already exists.\r\n            const existingImport = root.nodes?.find(\r\n              (node): node is AtRule =>\r\n                node.type === \"atrule\" &&\r\n                node.name === \"import\" &&\r\n                node.params === params\r\n            )\r\n\r\n            if (!existingImport) {\r\n              const importRule = postcss.atRule({\r\n                name: \"import\",\r\n                params,\r\n                raws: { semicolon: true },\r\n              })\r\n\r\n              // Find the last import to insert after, or insert at beginning.\r\n              const importNodes = root.nodes?.filter(\r\n                (node): node is AtRule =>\r\n                  node.type === \"atrule\" && node.name === \"import\"\r\n              )\r\n\r\n              if (importNodes && importNodes.length > 0) {\r\n                // Insert after the last existing import.\r\n                const lastImport = importNodes[importNodes.length - 1]\r\n                importRule.raws.before = \"\\n\"\r\n                root.insertAfter(lastImport, importRule)\r\n              } else {\r\n                // No imports exist, insert at the very beginning.\r\n                // Check if the file is empty.\r\n                if (!root.nodes || root.nodes.length === 0) {\r\n                  importRule.raws.before = \"\"\r\n                } else {\r\n                  importRule.raws.before = \"\"\r\n                }\r\n                root.prepend(importRule)\r\n              }\r\n            }\r\n          }\r\n          // Special handling for plugins - place them after imports.\r\n          else if (name === \"plugin\") {\r\n            // Ensure plugin name is quoted if not already.\r\n            let quotedParams = params\r\n            if (params && !params.startsWith('\"') && !params.startsWith(\"'\")) {\r\n              quotedParams = `\"${params}\"`\r\n            }\r\n\r\n            // Normalize params for comparison (remove quotes).\r\n            const normalizeParams = (p: string) => {\r\n              if (p.startsWith('\"') && p.endsWith('\"')) {\r\n                return p.slice(1, -1)\r\n              }\r\n              if (p.startsWith(\"'\") && p.endsWith(\"'\")) {\r\n                return p.slice(1, -1)\r\n              }\r\n              return p\r\n            }\r\n\r\n            // Find existing plugin with same normalized params.\r\n            const existingPlugin = root.nodes?.find((node): node is AtRule => {\r\n              if (node.type !== \"atrule\" || node.name !== \"plugin\") {\r\n                return false\r\n              }\r\n              return normalizeParams(node.params) === normalizeParams(params)\r\n            })\r\n\r\n            if (!existingPlugin) {\r\n              const pluginRule = postcss.atRule({\r\n                name: \"plugin\",\r\n                params: quotedParams,\r\n                raws: { semicolon: true, before: \"\\n\" },\r\n              })\r\n\r\n              // Find the last import or plugin node to insert after\r\n              const importNodes = root.nodes?.filter(\r\n                (node): node is AtRule =>\r\n                  node.type === \"atrule\" && node.name === \"import\"\r\n              )\r\n\r\n              const pluginNodes = root.nodes?.filter(\r\n                (node): node is AtRule =>\r\n                  node.type === \"atrule\" && node.name === \"plugin\"\r\n              )\r\n\r\n              if (pluginNodes && pluginNodes.length > 0) {\r\n                // Insert after the last existing plugin\r\n                const lastPlugin = pluginNodes[pluginNodes.length - 1]\r\n                root.insertAfter(lastPlugin, pluginRule)\r\n              } else if (importNodes && importNodes.length > 0) {\r\n                // Insert after the last import if no plugins exist\r\n                const lastImport = importNodes[importNodes.length - 1]\r\n                root.insertAfter(lastImport, pluginRule)\r\n                // Add a break comment before the first plugin to create spacing\r\n                root.insertBefore(\r\n                  pluginRule,\r\n                  postcss.comment({ text: \"---break---\" })\r\n                )\r\n                // Add a break comment after the plugin for spacing from other content\r\n                root.insertAfter(\r\n                  pluginRule,\r\n                  postcss.comment({ text: \"---break---\" })\r\n                )\r\n              } else {\r\n                // If no imports or plugins, insert at the beginning\r\n                root.prepend(pluginRule)\r\n                // Add a break comment before the first plugin for spacing\r\n                root.insertBefore(\r\n                  pluginRule,\r\n                  postcss.comment({ text: \"---break---\" })\r\n                )\r\n                // Add a break comment after the plugin for spacing from other content\r\n                root.insertAfter(\r\n                  pluginRule,\r\n                  postcss.comment({ text: \"---break---\" })\r\n                )\r\n              }\r\n            }\r\n          }\r\n          // Check if this is any at-rule with no body (empty object).\r\n          else if (\r\n            typeof properties === \"object\" &&\r\n            Object.keys(properties).length === 0\r\n          ) {\r\n            // Handle any at-rule with no body (e.g., @apply, @tailwind, etc.).\r\n            const atRule = root.nodes?.find(\r\n              (node): node is AtRule =>\r\n                node.type === \"atrule\" &&\r\n                node.name === name &&\r\n                node.params === params\r\n            ) as AtRule | undefined\r\n\r\n            if (!atRule) {\r\n              const newAtRule = postcss.atRule({\r\n                name,\r\n                params,\r\n                raws: { semicolon: true },\r\n              })\r\n\r\n              root.append(newAtRule)\r\n              root.insertBefore(\r\n                newAtRule,\r\n                postcss.comment({ text: \"---break---\" })\r\n              )\r\n            }\r\n          }\r\n          // Special handling for keyframes - place them under @theme inline.\r\n          else if (name === \"keyframes\") {\r\n            let themeInline = root.nodes?.find(\r\n              (node): node is AtRule =>\r\n                node.type === \"atrule\" &&\r\n                node.name === \"theme\" &&\r\n                node.params === \"inline\"\r\n            ) as AtRule | undefined\r\n\r\n            if (!themeInline) {\r\n              themeInline = postcss.atRule({\r\n                name: \"theme\",\r\n                params: \"inline\",\r\n                raws: { semicolon: true, between: \" \", before: \"\\n\" },\r\n              })\r\n              root.append(themeInline)\r\n              root.insertBefore(\r\n                themeInline,\r\n                postcss.comment({ text: \"---break---\" })\r\n              )\r\n            }\r\n\r\n            const keyframesRule = postcss.atRule({\r\n              name: \"keyframes\",\r\n              params,\r\n              raws: { semicolon: true, between: \" \", before: \"\\n  \" },\r\n            })\r\n\r\n            themeInline.append(keyframesRule)\r\n\r\n            if (typeof properties === \"object\") {\r\n              for (const [step, stepProps] of Object.entries(properties)) {\r\n                processRule(keyframesRule, step, stepProps)\r\n              }\r\n            }\r\n          }\r\n          // Special handling for utility classes to preserve property values\r\n          else if (name === \"utility\") {\r\n            const utilityAtRule = root.nodes?.find(\r\n              (node): node is AtRule =>\r\n                node.type === \"atrule\" &&\r\n                node.name === name &&\r\n                node.params === params\r\n            ) as AtRule | undefined\r\n\r\n            if (!utilityAtRule) {\r\n              const atRule = postcss.atRule({\r\n                name,\r\n                params,\r\n                raws: { semicolon: true, between: \" \", before: \"\\n\" },\r\n              })\r\n\r\n              root.append(atRule)\r\n              root.insertBefore(\r\n                atRule,\r\n                postcss.comment({ text: \"---break---\" })\r\n              )\r\n\r\n              // Add declarations with their values preserved\r\n              if (typeof properties === \"object\") {\r\n                for (const [prop, value] of Object.entries(properties)) {\r\n                  if (typeof value === \"string\") {\r\n                    const decl = postcss.decl({\r\n                      prop,\r\n                      value: value,\r\n                      raws: { semicolon: true, before: \"\\n    \" },\r\n                    })\r\n                    atRule.append(decl)\r\n                  } else if (typeof value === \"object\") {\r\n                    processRule(atRule, prop, value)\r\n                  }\r\n                }\r\n              }\r\n            } else {\r\n              // Update existing utility class\r\n              if (typeof properties === \"object\") {\r\n                for (const [prop, value] of Object.entries(properties)) {\r\n                  if (typeof value === \"string\") {\r\n                    const existingDecl = utilityAtRule.nodes?.find(\r\n                      (node): node is Declaration =>\r\n                        node.type === \"decl\" && node.prop === prop\r\n                    )\r\n\r\n                    const decl = postcss.decl({\r\n                      prop,\r\n                      value: value,\r\n                      raws: { semicolon: true, before: \"\\n    \" },\r\n                    })\r\n\r\n                    existingDecl\r\n                      ? existingDecl.replaceWith(decl)\r\n                      : utilityAtRule.append(decl)\r\n                  } else if (typeof value === \"object\") {\r\n                    processRule(utilityAtRule, prop, value)\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n          // Handle at-property as regular CSS rules\r\n          else if (name === \"property\") {\r\n            processRule(root, selector, properties)\r\n          } else {\r\n            // Handle other at-rules normally\r\n            processAtRule(root, name, params, properties)\r\n          }\r\n        } else {\r\n          // Handle regular CSS rules\r\n          processRule(root, selector, properties)\r\n        }\r\n      }\r\n    },\r\n  }\r\n}\r\n\r\nfunction processAtRule(\r\n  root: Root | AtRule,\r\n  name: string,\r\n  params: string,\r\n  properties: any\r\n) {\r\n  // Find or create the at-rule\r\n  let atRule = root.nodes?.find(\r\n    (node): node is AtRule =>\r\n      node.type === \"atrule\" && node.name === name && node.params === params\r\n  ) as AtRule | undefined\r\n\r\n  if (!atRule) {\r\n    atRule = postcss.atRule({\r\n      name,\r\n      params,\r\n      raws: { semicolon: true, between: \" \", before: \"\\n\" },\r\n    })\r\n    root.append(atRule)\r\n    root.insertBefore(atRule, postcss.comment({ text: \"---break---\" }))\r\n  }\r\n\r\n  // Process children of this at-rule\r\n  if (typeof properties === \"object\") {\r\n    for (const [childSelector, childProps] of Object.entries(properties)) {\r\n      if (childSelector.startsWith(\"@\")) {\r\n        // Nested at-rule\r\n        const nestedMatch = childSelector.match(/@([a-zA-Z-]+)\\s*(.*)/)\r\n        if (nestedMatch) {\r\n          const [, nestedName, nestedParams] = nestedMatch\r\n          processAtRule(atRule, nestedName, nestedParams, childProps)\r\n        }\r\n      } else {\r\n        // CSS rule within at-rule\r\n        processRule(atRule, childSelector, childProps)\r\n      }\r\n    }\r\n  } else if (typeof properties === \"string\") {\r\n    // Direct string content for the at-rule\r\n    try {\r\n      // Parse the CSS string with PostCSS\r\n      const parsed = postcss.parse(`.temp{${properties}}`)\r\n      const tempRule = parsed.first as Rule\r\n\r\n      if (tempRule && tempRule.nodes) {\r\n        // Create a rule for the at-rule if needed\r\n        const rule = postcss.rule({\r\n          selector: \"temp\",\r\n          raws: { semicolon: true, between: \" \", before: \"\\n  \" },\r\n        })\r\n\r\n        // Copy all declarations from the temp rule to our actual rule\r\n        tempRule.nodes.forEach((node) => {\r\n          if (node.type === \"decl\") {\r\n            const clone = node.clone()\r\n            clone.raws.before = \"\\n    \"\r\n            rule.append(clone)\r\n          }\r\n        })\r\n\r\n        // Only add the rule if it has declarations\r\n        if (rule.nodes?.length) {\r\n          atRule.append(rule)\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error parsing at-rule content:\", properties, error)\r\n      throw error\r\n    }\r\n  }\r\n}\r\n\r\nfunction processRule(parent: Root | AtRule, selector: string, properties: any) {\r\n  let rule = parent.nodes?.find(\r\n    (node): node is Rule => node.type === \"rule\" && node.selector === selector\r\n  ) as Rule | undefined\r\n\r\n  if (!rule) {\r\n    rule = postcss.rule({\r\n      selector,\r\n      raws: { semicolon: true, between: \" \", before: \"\\n  \" },\r\n    })\r\n    parent.append(rule)\r\n  }\r\n\r\n  if (typeof properties === \"object\") {\r\n    for (const [prop, value] of Object.entries(properties)) {\r\n      // Check if this is any at-rule with empty object (no body).\r\n      if (\r\n        prop.startsWith(\"@\") &&\r\n        typeof value === \"object\" &&\r\n        value !== null &&\r\n        Object.keys(value).length === 0\r\n      ) {\r\n        // Parse the at-rule.\r\n        const atRuleMatch = prop.match(/@([a-zA-Z-]+)\\s*(.*)/)\r\n        if (atRuleMatch) {\r\n          const [, atRuleName, atRuleParams] = atRuleMatch\r\n          const atRule = postcss.atRule({\r\n            name: atRuleName,\r\n            params: atRuleParams,\r\n            raws: { semicolon: true, before: \"\\n    \" },\r\n          })\r\n          rule.append(atRule)\r\n        }\r\n      } else if (typeof value === \"string\") {\r\n        const decl = postcss.decl({\r\n          prop,\r\n          value: value,\r\n          raws: { semicolon: true, before: \"\\n    \" },\r\n        })\r\n\r\n        // Replace existing property or add new one.\r\n        const existingDecl = rule.nodes?.find(\r\n          (node): node is Declaration =>\r\n            node.type === \"decl\" && node.prop === prop\r\n        )\r\n\r\n        existingDecl ? existingDecl.replaceWith(decl) : rule.append(decl)\r\n      } else if (typeof value === \"object\") {\r\n        // Nested selector (including & selectors).\r\n        const nestedSelector = prop.startsWith(\"&\")\r\n          ? selector.replace(/^([^:]+)/, `$1${prop.substring(1)}`)\r\n          : prop // Use the original selector for other nested elements.\r\n        processRule(parent, nestedSelector, value)\r\n      }\r\n    }\r\n  } else if (typeof properties === \"string\") {\r\n    // Direct string content for the rule\r\n    try {\r\n      // Parse the CSS string with PostCSS\r\n      const parsed = postcss.parse(`.temp{${properties}}`)\r\n      const tempRule = parsed.first as Rule\r\n\r\n      if (tempRule && tempRule.nodes) {\r\n        // Copy all declarations from the temp rule to our actual rule\r\n        tempRule.nodes.forEach((node) => {\r\n          if (node.type === \"decl\") {\r\n            const clone = node.clone()\r\n            clone.raws.before = \"\\n    \"\r\n            rule?.append(clone)\r\n          }\r\n        })\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error parsing rule content:\", selector, properties, error)\r\n      throw error\r\n    }\r\n  }\r\n}\r\n","import {\r\n  registryItemCssVarsSchema,\r\n  registryItemTailwindSchema,\r\n} from \"@/src/schema\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\nimport { getPackageInfo } from \"@/src/utils/get-package-info\"\r\nimport { TailwindVersion } from \"@/src/utils/get-project-info\"\r\nimport { highlighter } from \"@/src/utils/highlighter\"\r\nimport { spinner } from \"@/src/utils/spinner\"\r\nimport { promises as fs } from \"fs\"\r\nimport path from \"path\"\r\nimport postcss from \"postcss\"\r\nimport AtRule from \"postcss/lib/at-rule\"\r\nimport Root from \"postcss/lib/root\"\r\nimport Rule from \"postcss/lib/rule\"\r\nimport { z } from \"zod\"\r\n\r\nexport async function updateCssVars(\r\n  cssVars: z.infer<typeof registryItemCssVarsSchema> | undefined,\r\n  config: Config,\r\n  options: {\r\n    cleanupDefaultNextStyles?: boolean\r\n    overwriteCssVars?: boolean\r\n    initIndex?: boolean\r\n    silent?: boolean\r\n    tailwindVersion?: TailwindVersion\r\n    tailwindConfig?: z.infer<typeof registryItemTailwindSchema>[\"config\"]\r\n  }\r\n) {\r\n  if (!config.resolvedPaths.tailwindCss || !Object.keys(cssVars ?? {}).length) {\r\n    return\r\n  }\r\n\r\n  options = {\r\n    cleanupDefaultNextStyles: false,\r\n    silent: false,\r\n    tailwindVersion: \"v3\",\r\n    overwriteCssVars: false,\r\n    initIndex: true,\r\n    ...options,\r\n  }\r\n  const cssFilepath = config.resolvedPaths.tailwindCss\r\n  const cssFilepathRelative = path.relative(\r\n    config.resolvedPaths.cwd,\r\n    cssFilepath\r\n  )\r\n  const cssVarsSpinner = spinner(\r\n    `Updating CSS variables in ${highlighter.info(cssFilepathRelative)}`,\r\n    {\r\n      silent: options.silent,\r\n    }\r\n  ).start()\r\n  const raw = await fs.readFile(cssFilepath, \"utf8\")\r\n  let output = await transformCssVars(raw, cssVars ?? {}, config, {\r\n    cleanupDefaultNextStyles: options.cleanupDefaultNextStyles,\r\n    tailwindVersion: options.tailwindVersion,\r\n    tailwindConfig: options.tailwindConfig,\r\n    overwriteCssVars: options.overwriteCssVars,\r\n    initIndex: options.initIndex,\r\n  })\r\n  await fs.writeFile(cssFilepath, output, \"utf8\")\r\n  cssVarsSpinner.succeed()\r\n}\r\n\r\nexport async function transformCssVars(\r\n  input: string,\r\n  cssVars: z.infer<typeof registryItemCssVarsSchema>,\r\n  config: Config,\r\n  options: {\r\n    cleanupDefaultNextStyles?: boolean\r\n    tailwindVersion?: TailwindVersion\r\n    tailwindConfig?: z.infer<typeof registryItemTailwindSchema>[\"config\"]\r\n    overwriteCssVars?: boolean\r\n    initIndex?: boolean\r\n  } = {\r\n    cleanupDefaultNextStyles: false,\r\n    tailwindVersion: \"v3\",\r\n    tailwindConfig: undefined,\r\n    overwriteCssVars: false,\r\n    initIndex: true,\r\n  }\r\n) {\r\n  options = {\r\n    cleanupDefaultNextStyles: false,\r\n    tailwindVersion: \"v3\",\r\n    tailwindConfig: undefined,\r\n    overwriteCssVars: false,\r\n    initIndex: true,\r\n    ...options,\r\n  }\r\n\r\n  let plugins = [updateCssVarsPlugin(cssVars)]\r\n\r\n  if (options.cleanupDefaultNextStyles) {\r\n    plugins.push(cleanupDefaultNextStylesPlugin())\r\n  }\r\n\r\n  if (options.tailwindVersion === \"v4\") {\r\n    plugins = []\r\n\r\n    // Only add tw-animate-css if project does not have tailwindcss-animate\r\n    if (config.resolvedPaths?.cwd) {\r\n      const packageInfo = getPackageInfo(config.resolvedPaths.cwd)\r\n      if (\r\n        !packageInfo?.dependencies?.[\"tailwindcss-animate\"] &&\r\n        !packageInfo?.devDependencies?.[\"tailwindcss-animate\"] &&\r\n        options.initIndex\r\n      ) {\r\n        plugins.push(addCustomImport({ params: \"tw-animate-css\" }))\r\n      }\r\n    }\r\n\r\n    plugins.push(addCustomVariant({ params: \"dark (&:is(.dark *))\" }))\r\n\r\n    if (options.cleanupDefaultNextStyles) {\r\n      plugins.push(cleanupDefaultNextStylesPlugin())\r\n    }\r\n\r\n    plugins.push(\r\n      updateCssVarsPluginV4(cssVars, {\r\n        overwriteCssVars: options.overwriteCssVars,\r\n      })\r\n    )\r\n    plugins.push(updateThemePlugin(cssVars))\r\n\r\n    if (options.tailwindConfig) {\r\n      plugins.push(updateTailwindConfigPlugin(options.tailwindConfig))\r\n      plugins.push(updateTailwindConfigAnimationPlugin(options.tailwindConfig))\r\n      plugins.push(updateTailwindConfigKeyframesPlugin(options.tailwindConfig))\r\n    }\r\n  }\r\n\r\n  if (config.tailwind.cssVariables && options.initIndex) {\r\n    plugins.push(\r\n      updateBaseLayerPlugin({ tailwindVersion: options.tailwindVersion })\r\n    )\r\n  }\r\n\r\n  const result = await postcss(plugins).process(input, {\r\n    from: undefined,\r\n  })\r\n\r\n  let output = result.css\r\n\r\n  output = output.replace(/\\/\\* ---break--- \\*\\//g, \"\")\r\n\r\n  if (options.tailwindVersion === \"v4\") {\r\n    output = output.replace(/(\\n\\s*\\n)+/g, \"\\n\\n\")\r\n  }\r\n\r\n  return output\r\n}\r\n\r\nfunction updateBaseLayerPlugin({\r\n  tailwindVersion,\r\n}: {\r\n  tailwindVersion?: TailwindVersion\r\n}) {\r\n  return {\r\n    postcssPlugin: \"update-base-layer\",\r\n    Once(root: Root) {\r\n      const requiredRules = [\r\n        {\r\n          selector: \"*\",\r\n          apply:\r\n            tailwindVersion === \"v4\"\r\n              ? \"border-border outline-ring/50\"\r\n              : \"border-border\",\r\n        },\r\n        { selector: \"body\", apply: \"bg-background text-foreground\" },\r\n      ]\r\n\r\n      let baseLayer = root.nodes.find(\r\n        (node): node is AtRule =>\r\n          node.type === \"atrule\" &&\r\n          node.name === \"layer\" &&\r\n          node.params === \"base\" &&\r\n          requiredRules.every(({ selector, apply }) =>\r\n            node.nodes?.some(\r\n              (rule): rule is Rule =>\r\n                rule.type === \"rule\" &&\r\n                rule.selector === selector &&\r\n                rule.nodes.some(\r\n                  (applyRule): applyRule is AtRule =>\r\n                    applyRule.type === \"atrule\" &&\r\n                    applyRule.name === \"apply\" &&\r\n                    applyRule.params === apply\r\n                )\r\n            )\r\n          )\r\n      ) as AtRule | undefined\r\n\r\n      if (!baseLayer) {\r\n        baseLayer = postcss.atRule({\r\n          name: \"layer\",\r\n          params: \"base\",\r\n          raws: { semicolon: true, between: \" \", before: \"\\n\" },\r\n        })\r\n        root.append(baseLayer)\r\n        root.insertBefore(baseLayer, postcss.comment({ text: \"---break---\" }))\r\n      }\r\n\r\n      requiredRules.forEach(({ selector, apply }) => {\r\n        const existingRule = baseLayer?.nodes?.find(\r\n          (node): node is Rule =>\r\n            node.type === \"rule\" && node.selector === selector\r\n        )\r\n\r\n        if (!existingRule) {\r\n          baseLayer?.append(\r\n            postcss.rule({\r\n              selector,\r\n              nodes: [\r\n                postcss.atRule({\r\n                  name: \"apply\",\r\n                  params: apply,\r\n                  raws: { semicolon: true, before: \"\\n    \" },\r\n                }),\r\n              ],\r\n              raws: { semicolon: true, between: \" \", before: \"\\n  \" },\r\n            })\r\n          )\r\n        }\r\n      })\r\n    },\r\n  }\r\n}\r\n\r\nfunction updateCssVarsPlugin(\r\n  cssVars: z.infer<typeof registryItemCssVarsSchema>\r\n) {\r\n  return {\r\n    postcssPlugin: \"update-css-vars\",\r\n    Once(root: Root) {\r\n      let baseLayer = root.nodes.find(\r\n        (node) =>\r\n          node.type === \"atrule\" &&\r\n          node.name === \"layer\" &&\r\n          node.params === \"base\"\r\n      ) as AtRule | undefined\r\n\r\n      if (!(baseLayer instanceof AtRule)) {\r\n        baseLayer = postcss.atRule({\r\n          name: \"layer\",\r\n          params: \"base\",\r\n          nodes: [],\r\n          raws: {\r\n            semicolon: true,\r\n            before: \"\\n\",\r\n            between: \" \",\r\n          },\r\n        })\r\n        root.append(baseLayer)\r\n        root.insertBefore(baseLayer, postcss.comment({ text: \"---break---\" }))\r\n      }\r\n\r\n      if (baseLayer !== undefined) {\r\n        // Add variables for each key in cssVars\r\n        Object.entries(cssVars).forEach(([key, vars]) => {\r\n          const selector = key === \"light\" ? \":root\" : `.${key}`\r\n          // TODO: Fix typecheck.\r\n          addOrUpdateVars(baseLayer as AtRule, selector, vars)\r\n        })\r\n      }\r\n    },\r\n  }\r\n}\r\n\r\nfunction removeConflictVars(root: Rule | Root) {\r\n  const rootRule = root.nodes.find(\r\n    (node): node is Rule => node.type === \"rule\" && node.selector === \":root\"\r\n  )\r\n\r\n  if (rootRule) {\r\n    const propsToRemove = [\"--background\", \"--foreground\"]\r\n\r\n    rootRule.nodes\r\n      .filter(\r\n        (node): node is postcss.Declaration =>\r\n          node.type === \"decl\" && propsToRemove.includes(node.prop)\r\n      )\r\n      .forEach((node) => node.remove())\r\n\r\n    if (rootRule.nodes.length === 0) {\r\n      rootRule.remove()\r\n    }\r\n  }\r\n}\r\n\r\nfunction cleanupDefaultNextStylesPlugin() {\r\n  return {\r\n    postcssPlugin: \"cleanup-default-next-styles\",\r\n    Once(root: Root) {\r\n      const bodyRule = root.nodes.find(\r\n        (node): node is Rule => node.type === \"rule\" && node.selector === \"body\"\r\n      )\r\n      if (bodyRule) {\r\n        // Remove color from the body node.\r\n        bodyRule.nodes\r\n          .find(\r\n            (node): node is postcss.Declaration =>\r\n              node.type === \"decl\" &&\r\n              node.prop === \"color\" &&\r\n              [\"rgb(var(--foreground-rgb))\", \"var(--foreground)\"].includes(\r\n                node.value\r\n              )\r\n          )\r\n          ?.remove()\r\n\r\n        // Remove background: linear-gradient.\r\n        bodyRule.nodes\r\n          .find((node): node is postcss.Declaration => {\r\n            return (\r\n              node.type === \"decl\" &&\r\n              node.prop === \"background\" &&\r\n              // This is only going to run on create project, so all good.\r\n              (node.value.startsWith(\"linear-gradient\") ||\r\n                node.value === \"var(--background)\")\r\n            )\r\n          })\r\n          ?.remove()\r\n\r\n        // Remove font-family: Arial, Helvetica, sans-serif;\r\n        bodyRule.nodes\r\n          .find(\r\n            (node): node is postcss.Declaration =>\r\n              node.type === \"decl\" &&\r\n              node.prop === \"font-family\" &&\r\n              node.value === \"Arial, Helvetica, sans-serif\"\r\n          )\r\n          ?.remove()\r\n\r\n        // If the body rule is empty, remove it.\r\n        if (bodyRule.nodes.length === 0) {\r\n          bodyRule.remove()\r\n        }\r\n      }\r\n\r\n      removeConflictVars(root)\r\n\r\n      const darkRootRule = root.nodes.find(\r\n        (node): node is Rule =>\r\n          node.type === \"atrule\" &&\r\n          node.params === \"(prefers-color-scheme: dark)\"\r\n      )\r\n\r\n      if (darkRootRule) {\r\n        removeConflictVars(darkRootRule)\r\n        if (darkRootRule.nodes.length === 0) {\r\n          darkRootRule.remove()\r\n        }\r\n      }\r\n    },\r\n  }\r\n}\r\n\r\nfunction addOrUpdateVars(\r\n  baseLayer: AtRule,\r\n  selector: string,\r\n  vars: Record<string, string>\r\n) {\r\n  let ruleNode = baseLayer.nodes?.find(\r\n    (node): node is Rule => node.type === \"rule\" && node.selector === selector\r\n  )\r\n\r\n  if (!ruleNode) {\r\n    if (Object.keys(vars).length > 0) {\r\n      ruleNode = postcss.rule({\r\n        selector,\r\n        raws: { between: \" \", before: \"\\n  \" },\r\n      })\r\n      baseLayer.append(ruleNode)\r\n    }\r\n  }\r\n\r\n  Object.entries(vars).forEach(([key, value]) => {\r\n    const prop = `--${key.replace(/^--/, \"\")}`\r\n    const newDecl = postcss.decl({\r\n      prop,\r\n      value,\r\n      raws: { semicolon: true },\r\n    })\r\n\r\n    const existingDecl = ruleNode?.nodes.find(\r\n      (node): node is postcss.Declaration =>\r\n        node.type === \"decl\" && node.prop === prop\r\n    )\r\n\r\n    existingDecl ? existingDecl.replaceWith(newDecl) : ruleNode?.append(newDecl)\r\n  })\r\n}\r\n\r\nfunction updateCssVarsPluginV4(\r\n  cssVars: z.infer<typeof registryItemCssVarsSchema>,\r\n  options: {\r\n    overwriteCssVars?: boolean\r\n  }\r\n) {\r\n  return {\r\n    postcssPlugin: \"update-css-vars-v4\",\r\n    Once(root: Root) {\r\n      Object.entries(cssVars).forEach(([key, vars]) => {\r\n        let selector = key === \"light\" ? \":root\" : `.${key}`\r\n\r\n        if (key === \"theme\") {\r\n          selector = \"@theme\"\r\n          const themeNode = upsertThemeNode(root)\r\n          Object.entries(vars).forEach(([key, value]) => {\r\n            const prop = `--${key.replace(/^--/, \"\")}`\r\n            const newDecl = postcss.decl({\r\n              prop,\r\n              value,\r\n              raws: { semicolon: true },\r\n            })\r\n\r\n            const existingDecl = themeNode?.nodes?.find(\r\n              (node): node is postcss.Declaration =>\r\n                node.type === \"decl\" && node.prop === prop\r\n            )\r\n\r\n            // Only overwrite if overwriteCssVars is true\r\n            // i.e for registry:theme and registry:style\r\n            // We do not want new components to overwrite existing vars.\r\n            // Keep user defined vars.\r\n            if (options.overwriteCssVars) {\r\n              if (existingDecl) {\r\n                existingDecl.replaceWith(newDecl)\r\n              } else {\r\n                themeNode?.append(newDecl)\r\n              }\r\n            } else {\r\n              if (!existingDecl) {\r\n                themeNode?.append(newDecl)\r\n              }\r\n            }\r\n          })\r\n          return\r\n        }\r\n\r\n        let ruleNode = root.nodes?.find(\r\n          (node): node is Rule =>\r\n            node.type === \"rule\" && node.selector === selector\r\n        )\r\n\r\n        if (!ruleNode && Object.keys(vars).length > 0) {\r\n          ruleNode = postcss.rule({\r\n            selector,\r\n            nodes: [],\r\n            raws: { semicolon: true, between: \" \", before: \"\\n\" },\r\n          })\r\n          root.append(ruleNode)\r\n          root.insertBefore(ruleNode, postcss.comment({ text: \"---break---\" }))\r\n        }\r\n\r\n        Object.entries(vars).forEach(([key, value]) => {\r\n          let prop = `--${key.replace(/^--/, \"\")}`\r\n\r\n          // Special case for sidebar-background.\r\n          if (prop === \"--sidebar-background\") {\r\n            prop = \"--sidebar\"\r\n          }\r\n\r\n          if (isLocalHSLValue(value)) {\r\n            value = `hsl(${value})`\r\n          }\r\n\r\n          const newDecl = postcss.decl({\r\n            prop,\r\n            value,\r\n            raws: { semicolon: true },\r\n          })\r\n          const existingDecl = ruleNode?.nodes.find(\r\n            (node): node is postcss.Declaration =>\r\n              node.type === \"decl\" && node.prop === prop\r\n          )\r\n\r\n          // Only overwrite if overwriteCssVars is true\r\n          // i.e for registry:theme and registry:style\r\n          // We do not want new components to overwrite existing vars.\r\n          // Keep user defined vars.\r\n          if (options.overwriteCssVars) {\r\n            if (existingDecl) {\r\n              existingDecl.replaceWith(newDecl)\r\n            } else {\r\n              ruleNode?.append(newDecl)\r\n            }\r\n          } else {\r\n            if (!existingDecl) {\r\n              ruleNode?.append(newDecl)\r\n            }\r\n          }\r\n        })\r\n      })\r\n    },\r\n  }\r\n}\r\n\r\nfunction updateThemePlugin(cssVars: z.infer<typeof registryItemCssVarsSchema>) {\r\n  return {\r\n    postcssPlugin: \"update-theme\",\r\n    Once(root: Root) {\r\n      // Find unique color names from light and dark.\r\n      const variables = Array.from(\r\n        new Set(\r\n          Object.keys(cssVars).flatMap((key) =>\r\n            Object.keys(cssVars[key as keyof typeof cssVars] || {})\r\n          )\r\n        )\r\n      )\r\n\r\n      if (!variables.length) {\r\n        return\r\n      }\r\n\r\n      const themeNode = upsertThemeNode(root)\r\n\r\n      const themeVarNodes = themeNode.nodes?.filter(\r\n        (node): node is postcss.Declaration =>\r\n          node.type === \"decl\" && node.prop.startsWith(\"--\")\r\n      )\r\n\r\n      for (const variable of variables) {\r\n        const value = Object.values(cssVars).find((vars) => vars[variable])?.[\r\n          variable\r\n        ]\r\n\r\n        if (!value) {\r\n          continue\r\n        }\r\n\r\n        if (variable === \"radius\") {\r\n          const radiusVariables = {\r\n            sm: \"calc(var(--radius) - 4px)\",\r\n            md: \"calc(var(--radius) - 2px)\",\r\n            lg: \"var(--radius)\",\r\n            xl: \"calc(var(--radius) + 4px)\",\r\n          }\r\n          for (const [key, value] of Object.entries(radiusVariables)) {\r\n            const cssVarNode = postcss.decl({\r\n              prop: `--radius-${key}`,\r\n              value,\r\n              raws: { semicolon: true },\r\n            })\r\n            if (\r\n              themeNode?.nodes?.find(\r\n                (node): node is postcss.Declaration =>\r\n                  node.type === \"decl\" && node.prop === cssVarNode.prop\r\n              )\r\n            ) {\r\n              continue\r\n            }\r\n            themeNode?.append(cssVarNode)\r\n          }\r\n          continue\r\n        }\r\n\r\n        let prop =\r\n          isLocalHSLValue(value) || isColorValue(value)\r\n            ? `--color-${variable.replace(/^--/, \"\")}`\r\n            : `--${variable.replace(/^--/, \"\")}`\r\n        if (prop === \"--color-sidebar-background\") {\r\n          prop = \"--color-sidebar\"\r\n        }\r\n\r\n        let propValue = `var(--${variable})`\r\n        if (prop === \"--color-sidebar\") {\r\n          propValue = \"var(--sidebar)\"\r\n        }\r\n\r\n        const cssVarNode = postcss.decl({\r\n          prop,\r\n          value: propValue,\r\n          raws: { semicolon: true },\r\n        })\r\n        const existingDecl = themeNode?.nodes?.find(\r\n          (node): node is postcss.Declaration =>\r\n            node.type === \"decl\" && node.prop === cssVarNode.prop\r\n        )\r\n        if (!existingDecl) {\r\n          if (themeVarNodes?.length) {\r\n            themeNode?.insertAfter(\r\n              themeVarNodes[themeVarNodes.length - 1],\r\n              cssVarNode\r\n            )\r\n          } else {\r\n            themeNode?.append(cssVarNode)\r\n          }\r\n        }\r\n      }\r\n    },\r\n  }\r\n}\r\n\r\nfunction upsertThemeNode(root: Root): AtRule {\r\n  let themeNode = root.nodes.find(\r\n    (node): node is AtRule =>\r\n      node.type === \"atrule\" &&\r\n      node.name === \"theme\" &&\r\n      node.params === \"inline\"\r\n  )\r\n\r\n  if (!themeNode) {\r\n    themeNode = postcss.atRule({\r\n      name: \"theme\",\r\n      params: \"inline\",\r\n      nodes: [],\r\n      raws: { semicolon: true, between: \" \", before: \"\\n\" },\r\n    })\r\n    root.append(themeNode)\r\n    root.insertBefore(themeNode, postcss.comment({ text: \"---break---\" }))\r\n  }\r\n\r\n  return themeNode\r\n}\r\n\r\nfunction addCustomVariant({ params }: { params: string }) {\r\n  return {\r\n    postcssPlugin: \"add-custom-variant\",\r\n    Once(root: Root) {\r\n      const customVariant = root.nodes.find(\r\n        (node): node is AtRule =>\r\n          node.type === \"atrule\" && node.name === \"custom-variant\"\r\n      )\r\n\r\n      if (!customVariant) {\r\n        // Find all import nodes\r\n        const importNodes = root.nodes.filter(\r\n          (node): node is AtRule =>\r\n            node.type === \"atrule\" && node.name === \"import\"\r\n        )\r\n\r\n        const variantNode = postcss.atRule({\r\n          name: \"custom-variant\",\r\n          params,\r\n          raws: { semicolon: true, before: \"\\n\" },\r\n        })\r\n\r\n        if (importNodes.length > 0) {\r\n          // Insert after the last import\r\n          const lastImport = importNodes[importNodes.length - 1]\r\n          root.insertAfter(lastImport, variantNode)\r\n        } else {\r\n          // If no imports, insert after the first node\r\n          root.insertAfter(root.nodes[0], variantNode)\r\n        }\r\n\r\n        root.insertBefore(variantNode, postcss.comment({ text: \"---break---\" }))\r\n      }\r\n    },\r\n  }\r\n}\r\n\r\nfunction addCustomImport({ params }: { params: string }) {\r\n  return {\r\n    postcssPlugin: \"add-custom-import\",\r\n    Once(root: Root) {\r\n      const importNodes = root.nodes.filter(\r\n        (node): node is AtRule =>\r\n          node.type === \"atrule\" && node.name === \"import\"\r\n      )\r\n\r\n      // Find custom variant node (to ensure we insert before it)\r\n      const customVariantNode = root.nodes.find(\r\n        (node): node is AtRule =>\r\n          node.type === \"atrule\" && node.name === \"custom-variant\"\r\n      )\r\n\r\n      // Check if our specific import already exists\r\n      const hasImport = importNodes.some(\r\n        (node) => node.params.replace(/[\"']/g, \"\") === params\r\n      )\r\n\r\n      if (!hasImport) {\r\n        const importNode = postcss.atRule({\r\n          name: \"import\",\r\n          params: `\"${params}\"`,\r\n          raws: { semicolon: true, before: \"\\n\" },\r\n        })\r\n\r\n        if (importNodes.length > 0) {\r\n          // If there are existing imports, add after the last import\r\n          const lastImport = importNodes[importNodes.length - 1]\r\n          root.insertAfter(lastImport, importNode)\r\n        } else if (customVariantNode) {\r\n          // If no imports but has custom-variant, insert before it\r\n          root.insertBefore(customVariantNode, importNode)\r\n          root.insertBefore(\r\n            customVariantNode,\r\n            postcss.comment({ text: \"---break---\" })\r\n          )\r\n        } else {\r\n          // If no imports and no custom-variant, insert at the start\r\n          root.prepend(importNode)\r\n          root.insertAfter(importNode, postcss.comment({ text: \"---break---\" }))\r\n        }\r\n      }\r\n    },\r\n  }\r\n}\r\n\r\nfunction updateTailwindConfigPlugin(\r\n  tailwindConfig: z.infer<typeof registryItemTailwindSchema>[\"config\"]\r\n) {\r\n  return {\r\n    postcssPlugin: \"update-tailwind-config\",\r\n    Once(root: Root) {\r\n      if (!tailwindConfig?.plugins) {\r\n        return\r\n      }\r\n\r\n      const quoteType = getQuoteType(root)\r\n      const quote = quoteType === \"single\" ? \"'\" : '\"'\r\n\r\n      const pluginNodes = root.nodes.filter(\r\n        (node): node is AtRule =>\r\n          node.type === \"atrule\" && node.name === \"plugin\"\r\n      )\r\n\r\n      const lastPluginNode =\r\n        pluginNodes[pluginNodes.length - 1] || root.nodes[0]\r\n\r\n      for (const plugin of tailwindConfig.plugins) {\r\n        const pluginName = plugin.replace(/^require\\([\"']|[\"']\\)$/g, \"\")\r\n\r\n        // Check if the plugin is already present.\r\n        if (\r\n          pluginNodes.some((node) => {\r\n            return node.params.replace(/[\"']/g, \"\") === pluginName\r\n          })\r\n        ) {\r\n          continue\r\n        }\r\n\r\n        const pluginNode = postcss.atRule({\r\n          name: \"plugin\",\r\n          params: `${quote}${pluginName}${quote}`,\r\n          raws: { semicolon: true, before: \"\\n\" },\r\n        })\r\n        root.insertAfter(lastPluginNode, pluginNode)\r\n        root.insertBefore(pluginNode, postcss.comment({ text: \"---break---\" }))\r\n      }\r\n    },\r\n  }\r\n}\r\n\r\nfunction updateTailwindConfigKeyframesPlugin(\r\n  tailwindConfig: z.infer<typeof registryItemTailwindSchema>[\"config\"]\r\n) {\r\n  return {\r\n    postcssPlugin: \"update-tailwind-config-keyframes\",\r\n    Once(root: Root) {\r\n      if (!tailwindConfig?.theme?.extend?.keyframes) {\r\n        return\r\n      }\r\n\r\n      const themeNode = upsertThemeNode(root)\r\n      const existingKeyFrameNodes = themeNode.nodes?.filter(\r\n        (node): node is AtRule =>\r\n          node.type === \"atrule\" && node.name === \"keyframes\"\r\n      )\r\n\r\n      const keyframeValueSchema = z.record(\r\n        z.string(),\r\n        z.record(z.string(), z.string())\r\n      )\r\n\r\n      for (const [keyframeName, keyframeValue] of Object.entries(\r\n        tailwindConfig.theme.extend.keyframes\r\n      )) {\r\n        if (typeof keyframeName !== \"string\") {\r\n          continue\r\n        }\r\n\r\n        const parsedKeyframeValue = keyframeValueSchema.safeParse(keyframeValue)\r\n\r\n        if (!parsedKeyframeValue.success) {\r\n          continue\r\n        }\r\n\r\n        if (\r\n          existingKeyFrameNodes?.find(\r\n            (node): node is postcss.AtRule =>\r\n              node.type === \"atrule\" &&\r\n              node.name === \"keyframes\" &&\r\n              node.params === keyframeName\r\n          )\r\n        ) {\r\n          continue\r\n        }\r\n\r\n        const keyframeNode = postcss.atRule({\r\n          name: \"keyframes\",\r\n          params: keyframeName,\r\n          nodes: [],\r\n          raws: { semicolon: true, between: \" \", before: \"\\n  \" },\r\n        })\r\n\r\n        for (const [key, values] of Object.entries(parsedKeyframeValue.data)) {\r\n          const rule = postcss.rule({\r\n            selector: key,\r\n            nodes: Object.entries(values).map(([key, value]) =>\r\n              postcss.decl({\r\n                prop: key,\r\n                value,\r\n                raws: { semicolon: true, before: \"\\n      \", between: \": \" },\r\n              })\r\n            ),\r\n            raws: { semicolon: true, between: \" \", before: \"\\n    \" },\r\n          })\r\n          keyframeNode.append(rule)\r\n        }\r\n\r\n        themeNode.append(keyframeNode)\r\n        themeNode.insertBefore(\r\n          keyframeNode,\r\n          postcss.comment({ text: \"---break---\" })\r\n        )\r\n      }\r\n    },\r\n  }\r\n}\r\n\r\nfunction updateTailwindConfigAnimationPlugin(\r\n  tailwindConfig: z.infer<typeof registryItemTailwindSchema>[\"config\"]\r\n) {\r\n  return {\r\n    postcssPlugin: \"update-tailwind-config-animation\",\r\n    Once(root: Root) {\r\n      if (!tailwindConfig?.theme?.extend?.animation) {\r\n        return\r\n      }\r\n\r\n      const themeNode = upsertThemeNode(root)\r\n      const existingAnimationNodes = themeNode.nodes?.filter(\r\n        (node): node is postcss.Declaration =>\r\n          node.type === \"decl\" && node.prop.startsWith(\"--animate-\")\r\n      )\r\n\r\n      const parsedAnimationValue = z\r\n        .record(z.string(), z.string())\r\n        .safeParse(tailwindConfig.theme.extend.animation)\r\n      if (!parsedAnimationValue.success) {\r\n        return\r\n      }\r\n\r\n      for (const [key, value] of Object.entries(parsedAnimationValue.data)) {\r\n        const prop = `--animate-${key}`\r\n        if (\r\n          existingAnimationNodes?.find(\r\n            (node): node is postcss.Declaration => node.prop === prop\r\n          )\r\n        ) {\r\n          continue\r\n        }\r\n\r\n        const animationNode = postcss.decl({\r\n          prop,\r\n          value,\r\n          raws: { semicolon: true, between: \": \", before: \"\\n  \" },\r\n        })\r\n        themeNode.append(animationNode)\r\n      }\r\n    },\r\n  }\r\n}\r\n\r\nfunction getQuoteType(root: Root): \"single\" | \"double\" {\r\n  const firstNode = root.nodes[0]\r\n  const raw = firstNode.toString()\r\n\r\n  if (raw.includes(\"'\")) {\r\n    return \"single\"\r\n  }\r\n  return \"double\"\r\n}\r\n\r\nexport function isLocalHSLValue(value: string) {\r\n  if (\r\n    value.startsWith(\"hsl\") ||\r\n    value.startsWith(\"rgb\") ||\r\n    value.startsWith(\"#\") ||\r\n    value.startsWith(\"oklch\")\r\n  ) {\r\n    return false\r\n  }\r\n\r\n  const chunks = value.split(\" \")\r\n\r\n  return (\r\n    chunks.length === 3 &&\r\n    chunks.slice(1, 3).every((chunk) => chunk.includes(\"%\"))\r\n  )\r\n}\r\n\r\nexport function isColorValue(value: string) {\r\n  return (\r\n    value.startsWith(\"hsl\") ||\r\n    value.startsWith(\"rgb\") ||\r\n    value.startsWith(\"#\") ||\r\n    value.startsWith(\"oklch\") ||\r\n    value.startsWith(\"var(--color-\")\r\n  )\r\n}\r\n","import { detect } from \"@antfu/ni\"\r\n\r\nexport async function getPackageManager(\r\n  targetDir: string,\r\n  { withFallback }: { withFallback?: boolean } = {\r\n    withFallback: false,\r\n  }\r\n): Promise<\"yarn\" | \"pnpm\" | \"bun\" | \"npm\" | \"deno\"> {\r\n  const packageManager = await detect({ programmatic: true, cwd: targetDir })\r\n\r\n  if (packageManager === \"yarn@berry\") return \"yarn\"\r\n  if (packageManager === \"pnpm@6\") return \"pnpm\"\r\n  if (packageManager === \"bun\") return \"bun\"\r\n  if (packageManager === \"deno\") return \"deno\"\r\n  if (!withFallback) {\r\n    return packageManager ?? \"npm\"\r\n  }\r\n\r\n  // Fallback to user agent if not detected.\r\n  const userAgent = process.env.npm_config_user_agent || \"\"\r\n\r\n  if (userAgent.startsWith(\"yarn\")) {\r\n    return \"yarn\"\r\n  }\r\n\r\n  if (userAgent.startsWith(\"pnpm\")) {\r\n    return \"pnpm\"\r\n  }\r\n\r\n  if (userAgent.startsWith(\"bun\")) {\r\n    return \"bun\"\r\n  }\r\n\r\n  return \"npm\"\r\n}\r\n\r\nexport async function getPackageRunner(cwd: string) {\r\n  const packageManager = await getPackageManager(cwd)\r\n\r\n  if (packageManager === \"pnpm\") return \"pnpm dlx\"\r\n\r\n  if (packageManager === \"bun\") return \"bunx\"\r\n\r\n  return \"npx\"\r\n}\r\n","import { RegistryItem } from \"@/src/schema\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\nimport { getPackageInfo } from \"@/src/utils/get-package-info\"\r\nimport { getPackageManager } from \"@/src/utils/get-package-manager\"\r\nimport { logger } from \"@/src/utils/logger\"\r\nimport { spinner } from \"@/src/utils/spinner\"\r\nimport { execa } from \"execa\"\r\nimport prompts from \"prompts\"\r\n\r\nexport async function updateDependencies(\r\n  dependencies: RegistryItem[\"dependencies\"],\r\n  devDependencies: RegistryItem[\"devDependencies\"],\r\n  config: Config,\r\n  options: {\r\n    silent?: boolean\r\n  }\r\n) {\r\n  dependencies = Array.from(new Set(dependencies))\r\n  devDependencies = Array.from(new Set(devDependencies))\r\n\r\n  if (!dependencies?.length && !devDependencies?.length) {\r\n    return\r\n  }\r\n\r\n  options = {\r\n    silent: false,\r\n    ...options,\r\n  }\r\n\r\n  const dependenciesSpinner = spinner(`Installing dependencies.`, {\r\n    silent: options.silent,\r\n  })?.start()\r\n  const packageManager = await getUpdateDependenciesPackageManager(config)\r\n\r\n  // Offer to use --force or --legacy-peer-deps if using React 19 with npm.\r\n  let flag = \"\"\r\n  if (shouldPromptForNpmFlag(config) && packageManager === \"npm\") {\r\n    if (options.silent) {\r\n      flag = \"force\"\r\n    } else {\r\n      dependenciesSpinner.stopAndPersist()\r\n      logger.warn(\r\n        \"\\nIt looks like you are using React 19. \\nSome packages may fail to install due to peer dependency issues in npm (see https://ui.aodesu.com/react-19).\\n\"\r\n      )\r\n      const confirmation = await prompts([\r\n        {\r\n          type: \"select\",\r\n          name: \"flag\",\r\n          message: \"How would you like to proceed?\",\r\n          choices: [\r\n            { title: \"Use --force\", value: \"force\" },\r\n            { title: \"Use --legacy-peer-deps\", value: \"legacy-peer-deps\" },\r\n          ],\r\n        },\r\n      ])\r\n\r\n      if (confirmation) {\r\n        flag = confirmation.flag\r\n      }\r\n    }\r\n  }\r\n\r\n  dependenciesSpinner?.start()\r\n\r\n  await installWithPackageManager(\r\n    packageManager,\r\n    dependencies,\r\n    devDependencies,\r\n    config.resolvedPaths.cwd,\r\n    flag\r\n  )\r\n\r\n  dependenciesSpinner?.succeed()\r\n}\r\n\r\nfunction shouldPromptForNpmFlag(config: Config) {\r\n  const packageInfo = getPackageInfo(config.resolvedPaths.cwd, false)\r\n\r\n  if (!packageInfo?.dependencies?.react) {\r\n    return false\r\n  }\r\n\r\n  const hasReact19 = /^(?:\\^|~)?19(?:\\.\\d+)*(?:-.*)?$/.test(\r\n    packageInfo.dependencies.react\r\n  )\r\n  const hasReactDayPicker8 =\r\n    packageInfo.dependencies[\"react-day-picker\"]?.startsWith(\"8\")\r\n\r\n  return hasReact19 && hasReactDayPicker8\r\n}\r\n\r\nasync function getUpdateDependenciesPackageManager(config: Config) {\r\n  const expoVersion = getPackageInfo(config.resolvedPaths.cwd, false)\r\n    ?.dependencies?.expo\r\n\r\n  if (expoVersion) {\r\n    // Ensures package versions match the React Native version.\r\n    // https://docs.expo.dev/more/expo-cli/#install\r\n    return \"expo\"\r\n  }\r\n\r\n  return getPackageManager(config.resolvedPaths.cwd)\r\n}\r\n\r\nasync function installWithPackageManager(\r\n  packageManager: Awaited<\r\n    ReturnType<typeof getUpdateDependenciesPackageManager>\r\n  >,\r\n  dependencies: string[],\r\n  devDependencies: string[],\r\n  cwd: string,\r\n  flag?: string\r\n) {\r\n  if (packageManager === \"npm\") {\r\n    return installWithNpm(dependencies, devDependencies, cwd, flag)\r\n  }\r\n\r\n  if (packageManager === \"deno\") {\r\n    return installWithDeno(dependencies, devDependencies, cwd)\r\n  }\r\n\r\n  if (packageManager === \"expo\") {\r\n    return installWithExpo(dependencies, devDependencies, cwd)\r\n  }\r\n\r\n  if (dependencies?.length) {\r\n    await execa(packageManager, [\"add\", ...dependencies], {\r\n      cwd,\r\n    })\r\n  }\r\n\r\n  if (devDependencies?.length) {\r\n    await execa(packageManager, [\"add\", \"-D\", ...devDependencies], { cwd })\r\n  }\r\n}\r\n\r\nasync function installWithNpm(\r\n  dependencies: string[],\r\n  devDependencies: string[],\r\n  cwd: string,\r\n  flag?: string\r\n) {\r\n  if (dependencies.length) {\r\n    await execa(\r\n      \"npm\",\r\n      [\"install\", ...(flag ? [`--${flag}`] : []), ...dependencies],\r\n      { cwd }\r\n    )\r\n  }\r\n\r\n  if (devDependencies.length) {\r\n    await execa(\r\n      \"npm\",\r\n      [\"install\", ...(flag ? [`--${flag}`] : []), \"-D\", ...devDependencies],\r\n      { cwd }\r\n    )\r\n  }\r\n}\r\n\r\nasync function installWithDeno(\r\n  dependencies: string[],\r\n  devDependencies: string[],\r\n  cwd: string\r\n) {\r\n  if (dependencies?.length) {\r\n    await execa(\"deno\", [\"add\", ...dependencies.map((dep) => `npm:${dep}`)], {\r\n      cwd,\r\n    })\r\n  }\r\n\r\n  if (devDependencies?.length) {\r\n    await execa(\r\n      \"deno\",\r\n      [\"add\", \"-D\", ...devDependencies.map((dep) => `npm:${dep}`)],\r\n      { cwd }\r\n    )\r\n  }\r\n}\r\n\r\nasync function installWithExpo(\r\n  dependencies: string[],\r\n  devDependencies: string[],\r\n  cwd: string\r\n) {\r\n  if (dependencies.length) {\r\n    await execa(\"npx\", [\"expo\", \"install\", ...dependencies], { cwd })\r\n  }\r\n\r\n  if (devDependencies.length) {\r\n    await execa(\"npx\", [\"expo\", \"install\", \"-- -D\", ...devDependencies], {\r\n      cwd,\r\n    })\r\n  }\r\n}\r\n","import { registryItemEnvVarsSchema } from \"@/src/schema\"\r\nimport {\r\n  findExistingEnvFile,\r\n  getNewEnvKeys,\r\n  mergeEnvContent,\r\n} from \"@/src/utils/env-helpers\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\nimport { highlighter } from \"@/src/utils/highlighter\"\r\nimport { logger } from \"@/src/utils/logger\"\r\nimport { spinner } from \"@/src/utils/spinner\"\r\nimport { existsSync, promises as fs } from \"fs\"\r\nimport path from \"path\"\r\nimport { z } from \"zod\"\r\n\r\nexport async function updateEnvVars(\r\n  envVars: z.infer<typeof registryItemEnvVarsSchema> | undefined,\r\n  config: Config,\r\n  options: {\r\n    silent?: boolean\r\n  }\r\n) {\r\n  if (!envVars || Object.keys(envVars).length === 0) {\r\n    return {\r\n      envVarsAdded: [],\r\n      envFileUpdated: null,\r\n      envFileCreated: null,\r\n    }\r\n  }\r\n\r\n  options = {\r\n    silent: false,\r\n    ...options,\r\n  }\r\n\r\n  const envSpinner = spinner(`Adding environment variables.`, {\r\n    silent: options.silent,\r\n  })?.start()\r\n\r\n  const projectRoot = config.resolvedPaths.cwd\r\n\r\n  // Find existing env file or use .env.local as default.\r\n  let envFilePath = path.join(projectRoot, \".env.local\")\r\n  const existingEnvFile = findExistingEnvFile(projectRoot)\r\n\r\n  if (existingEnvFile) {\r\n    envFilePath = existingEnvFile\r\n  }\r\n\r\n  const envFileExists = existsSync(envFilePath)\r\n  const envFileName = path.basename(envFilePath)\r\n\r\n  // Convert envVars object to env file format\r\n  const newEnvContent = Object.entries(envVars)\r\n    .map(([key, value]) => `${key}=${value}`)\r\n    .join(\"\\n\")\r\n\r\n  let envVarsAdded: string[] = []\r\n  let envFileUpdated: string | null = null\r\n  let envFileCreated: string | null = null\r\n\r\n  if (envFileExists) {\r\n    const existingContent = await fs.readFile(envFilePath, \"utf-8\")\r\n    const mergedContent = mergeEnvContent(existingContent, newEnvContent)\r\n    envVarsAdded = getNewEnvKeys(existingContent, newEnvContent)\r\n\r\n    if (envVarsAdded.length > 0) {\r\n      await fs.writeFile(envFilePath, mergedContent, \"utf-8\")\r\n      envFileUpdated = path.relative(projectRoot, envFilePath)\r\n\r\n      envSpinner?.succeed(\r\n        `Added the following variables to ${highlighter.info(envFileName)}:`\r\n      )\r\n\r\n      if (!options.silent) {\r\n        for (const key of envVarsAdded) {\r\n          logger.log(`  ${highlighter.success(\"+\")} ${key}`)\r\n        }\r\n      }\r\n    } else {\r\n      envSpinner?.stop()\r\n    }\r\n  } else {\r\n    // Create new env file\r\n    await fs.writeFile(envFilePath, newEnvContent + \"\\n\", \"utf-8\")\r\n    envFileCreated = path.relative(projectRoot, envFilePath)\r\n    envVarsAdded = Object.keys(envVars)\r\n\r\n    envSpinner?.succeed(\r\n      `Added the following variables to ${highlighter.info(envFileName)}:`\r\n    )\r\n\r\n    if (!options.silent) {\r\n      for (const key of envVarsAdded) {\r\n        logger.log(`  ${highlighter.success(\"+\")} ${key}`)\r\n      }\r\n    }\r\n  }\r\n\r\n  if (!options.silent && envVarsAdded.length > 0) {\r\n    logger.break()\r\n  }\r\n\r\n  return {\r\n    envVarsAdded,\r\n    envFileUpdated,\r\n    envFileCreated,\r\n  }\r\n}\r\n","import z from \"zod\";\r\nimport { getRegistryItems } from \"../registry/api\";\r\nimport { configWithDefaults } from \"../registry/config\";\r\nimport { resolveRegistryTree } from \"../registry/resolver\";\r\nimport { configSchema, registryItemFileSchema, registryItemSchema, workspaceConfigSchema } from \"../schema\";\r\nimport { Config, getWorkspaceConfig } from \"./get-config\";\r\nimport { getProjectTailwindVersionFromConfig } from \"./get-project-info\";\r\nimport { handleError } from \"./handle-error\";\r\nimport { isSafeTarget } from \"./is-safe-target\";\r\nimport { logger } from \"./logger\";\r\nimport { spinner } from \"./spinner\";\r\nimport { updateCss } from \"./updaters/update-css\";\r\nimport { updateCssVars } from \"./updaters/update-css-vars\";\r\nimport { updateDependencies } from \"./updaters/update-dependencies\";\r\nimport { updateEnvVars } from \"./updaters/update-env-vars\";\r\nimport { updateFiles } from \"./updaters/update-files\";\r\nimport { updateTailwindConfig } from \"./updaters/update-tailwind-config\";\r\n\r\nexport async function addComponents(\r\n  components: string[],\r\n  config: Config,\r\n  options: {\r\n    overwrite?: boolean;\r\n    silent?: boolean;\r\n    isNewProject?: boolean;\r\n    baseStyle?: boolean;\r\n    registryHeaders?: Record<string, Record<string, string>>;\r\n    path?: string;\r\n  }\r\n) {\r\n  options = {\r\n    overwrite: false,\r\n    silent: false,\r\n    isNewProject: false,\r\n    baseStyle: true,\r\n    ...options,\r\n  }\r\n\r\n  const workspaceConfig = await getWorkspaceConfig(config);\r\n  if (\r\n    workspaceConfig &&\r\n    workspaceConfig.ui &&\r\n    workspaceConfig.ui.resolvedPaths.cwd !== config.resolvedPaths.cwd\r\n  ) {\r\n    return await addWorkspaceComponents(components, config, workspaceConfig, {\r\n      ...options,\r\n      isRemote:\r\n        components?.length === 1 && !!components[0].match(/\\/chat\\/b\\//),\r\n    });\r\n  }\r\n\r\n  return await addProjectComponents(components, config, options)\r\n}\r\n\r\nasync function addProjectComponents(\r\n  components: string[],\r\n  config: z.infer<typeof configSchema>,\r\n  options: {\r\n    overwrite?: boolean\r\n    silent?: boolean\r\n    isNewProject?: boolean\r\n    baseStyle?: boolean\r\n    path?: string\r\n  }\r\n) {\r\n  if (!options.baseStyle && !components.length) {\r\n    return;\r\n  }\r\n\r\n  const registrySpinner = spinner(`Checking registry.`, {\r\n    silent: options.silent,\r\n  })?.start();\r\n  const tree = await resolveRegistryTree(components, configWithDefaults(config));\r\n\r\n  if (!tree) {\r\n    registrySpinner?.fail();\r\n    return handleError(new Error(\"Failed to fetch components from registry.\"));\r\n  }\r\n\r\n  try {\r\n    validateFilesTarget(tree.files ?? [], config.resolvedPaths.cwd)\r\n  } catch (error) {\r\n    registrySpinner?.fail();\r\n    return handleError(error);\r\n  }\r\n\r\n  registrySpinner?.succeed();\r\n\r\n  const tailwindVersion = await getProjectTailwindVersionFromConfig(config);\r\n\r\n  await updateTailwindConfig(tree.tailwind?.config, config, {\r\n    silent: options.silent,\r\n    tailwindVersion,\r\n  });\r\n\r\n  const overwriteCssVars = await shouldOverwriteCssVars(components, config)\r\n  await updateCssVars(tree.cssVars, config, {\r\n    cleanupDefaultNextStyles: options.isNewProject,\r\n    silent: options.silent,\r\n    tailwindVersion,\r\n    tailwindConfig: tree.tailwind?.config,\r\n    overwriteCssVars,\r\n    initIndex: options.baseStyle,\r\n  })\r\n\r\n  // Add CSS updater\r\n  await updateCss(tree.css, config, {\r\n    silent: options.silent,\r\n  })\r\n\r\n  await updateEnvVars(tree.envVars, config, {\r\n    silent: options.silent,\r\n  })\r\n\r\n  await updateDependencies(tree.dependencies, tree.devDependencies, config, {\r\n    silent: options.silent,\r\n  })\r\n  await updateFiles(tree.files, config, {\r\n    overwrite: options.overwrite,\r\n    silent: options.silent,\r\n    path: options.path,\r\n  })\r\n\r\n  if (tree.docs) {\r\n    logger.info(tree.docs)\r\n  }\r\n}\r\n\r\nasync function addWorkspaceComponents(\r\n  components: string[],\r\n  config: z.infer<typeof configSchema>,\r\n  workspaceConfig: z.infer<typeof workspaceConfigSchema>,\r\n  options: {\r\n    overwrite?: boolean;\r\n    silent?: boolean;\r\n    isNewProject?: boolean;\r\n    isRemote?: boolean;\r\n    baseStyle?: boolean;\r\n    path?: string;\r\n  }\r\n) {\r\n  if (!options.baseStyle && !components.length) {\r\n    return;\r\n  }\r\n\r\n  const registrySpinner = spinner(`Checking registry.`, {\r\n    silent: options.silent,\r\n  })?.start();\r\n  const tree = await resolveRegistryTree(components, configWithDefaults(config));\r\n\r\n  if (!tree) {\r\n    registrySpinner?.fail();\r\n    return handleError(new Error(\"Failed to fetch components from registry.\"))\r\n  }\r\n}\r\n\r\nasync function shouldOverwriteCssVars(\r\n  components: z.infer<typeof registryItemSchema>[\"name\"][],\r\n  config: z.infer<typeof configSchema>\r\n) {\r\n  const result = await getRegistryItems(components, { config })\r\n  const payload = z.array(registryItemSchema).parse(result)\r\n\r\n  return payload.some(\r\n    (component) =>\r\n      component.type === \"registry:theme\" || component.type === \"registry:style\"\r\n  )\r\n}\r\n\r\nfunction validateFilesTarget(\r\n  files: z.infer<typeof registryItemFileSchema>[],\r\n  cwd: string\r\n) {\r\n  for (const file of files) {\r\n    if (!file?.target) {\r\n      continue\r\n    }\r\n\r\n    if (!isSafeTarget(file.target, cwd)) {\r\n      throw new Error(\r\n        `We found an unsafe file path \"${file.target} in the registry item. Installation aborted.`\r\n      )\r\n    }\r\n  }\r\n}\r\n","import { existsSync } from \"fs\";\r\nimport { join } from \"path\";\r\nimport { logger } from \"./logger\";\r\n\r\nexport async function loadEnvFiles(cwd: string = process.cwd()): Promise<void> {\r\n  try {\r\n    const { config } = await import(\"@dotenvx/dotenvx\");\r\n    const envFiles = [\r\n      \".env.local\",\r\n      \".env.development.local\",\r\n      \".env.development\",\r\n      \".env\"\r\n    ];\r\n\r\n    for (const envFile of envFiles) {\r\n      const envPath = join(cwd, envFile);\r\n      if (existsSync(envPath)) {\r\n        config({\r\n          path: envPath,\r\n          overload: false,\r\n          quiet: true\r\n        })\r\n      }\r\n    }\r\n  } catch (error) {\r\n    logger.warn(\"Failed to load env files:\", error);\r\n  }\r\n}\r\n","import { BUILTIN_REGISTRIES } from \"@/src/registry/constants\"\r\nimport { RegistryNotConfiguredError } from \"@/src/registry/errors\"\r\nimport { parseRegistryAndItemFromString } from \"@/src/registry/parser\"\r\nimport { fetchRegistryItems } from \"@/src/registry/resolver\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\n\r\n// Recursively discovers all registry namespaces including nested ones.\r\nexport async function resolveRegistryNamespaces(\r\n  components: string[],\r\n  config: Config\r\n) {\r\n  const discoveredNamespaces = new Set<string>()\r\n  const visitedItems = new Set<string>()\r\n  const itemsToProcess = [...components]\r\n\r\n  while (itemsToProcess.length > 0) {\r\n    const currentItem = itemsToProcess.shift()!\r\n\r\n    if (visitedItems.has(currentItem)) {\r\n      continue\r\n    }\r\n    visitedItems.add(currentItem)\r\n\r\n    const { registry } = parseRegistryAndItemFromString(currentItem)\r\n    if (registry && !BUILTIN_REGISTRIES[registry]) {\r\n      discoveredNamespaces.add(registry)\r\n    }\r\n\r\n    try {\r\n      const [item] = await fetchRegistryItems([currentItem], config, {\r\n        useCache: true,\r\n      })\r\n\r\n      if (item?.registryDependencies) {\r\n        for (const dep of item.registryDependencies) {\r\n          const { registry: depRegistry } = parseRegistryAndItemFromString(dep)\r\n          if (depRegistry && !BUILTIN_REGISTRIES[depRegistry]) {\r\n            discoveredNamespaces.add(depRegistry)\r\n          }\r\n\r\n          if (!visitedItems.has(dep)) {\r\n            itemsToProcess.push(dep)\r\n          }\r\n        }\r\n      }\r\n    } catch (error) {\r\n      // If a registry is not configured, we still track it.\r\n      if (error instanceof RegistryNotConfiguredError) {\r\n        const { registry } = parseRegistryAndItemFromString(currentItem)\r\n        if (registry && !BUILTIN_REGISTRIES[registry]) {\r\n          discoveredNamespaces.add(registry)\r\n        }\r\n        continue\r\n      }\r\n\r\n      // For other errors (network, parsing, etc.), we skip this item\r\n      // but continue processing others to discover as many namespaces as possible.\r\n      continue\r\n    }\r\n  }\r\n\r\n  return Array.from(discoveredNamespaces)\r\n}\r\n","import { getRegistriesIndex } from \"@/src/registry/api\"\r\nimport { BUILTIN_REGISTRIES } from \"@/src/registry/constants\"\r\nimport { resolveRegistryNamespaces } from \"@/src/registry/namespaces\"\r\nimport { rawConfigSchema } from \"@/src/registry/schema\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\nimport { spinner } from \"@/src/utils/spinner\"\r\nimport fs from \"fs-extra\"\r\nimport path from \"path\"\r\n\r\nexport async function ensureRegistriesInConfig(\r\n  components: string[],\r\n  config: Config,\r\n  options: {\r\n    silent?: boolean\r\n    writeFile?: boolean\r\n  } = {}\r\n) {\r\n  options = {\r\n    silent: false,\r\n    writeFile: true,\r\n    ...options,\r\n  }\r\n\r\n  // Use resolveRegistryNamespaces to discover all namespaces including dependencies.\r\n  const registryNames = await resolveRegistryNamespaces(components, config)\r\n\r\n  const missingRegistries = registryNames.filter(\r\n    (registry) =>\r\n      !config.registries?.[registry] &&\r\n      !Object.keys(BUILTIN_REGISTRIES).includes(registry)\r\n  )\r\n\r\n  if (missingRegistries.length === 0) {\r\n    return {\r\n      config,\r\n      newRegistries: [],\r\n    }\r\n  }\r\n\r\n  // We'll fail silently if we can't fetch the registry index.\r\n  // The error handling by caller will guide user to add the missing registries.\r\n  const registryIndex = await getRegistriesIndex({\r\n    useCache: process.env.NODE_ENV !== \"development\",\r\n  })\r\n\r\n  if (!registryIndex) {\r\n    return {\r\n      config,\r\n      newRegistries: [],\r\n    }\r\n  }\r\n\r\n  const foundRegistries: Record<string, string> = {}\r\n  for (const registry of missingRegistries) {\r\n    if (registryIndex[registry]) {\r\n      foundRegistries[registry] = registryIndex[registry]\r\n    }\r\n  }\r\n\r\n  if (Object.keys(foundRegistries).length === 0) {\r\n    return {\r\n      config,\r\n      newRegistries: [],\r\n    }\r\n  }\r\n\r\n  // Filter out built-in registries from existing config before merging\r\n  const existingRegistries = Object.fromEntries(\r\n    Object.entries(config.registries || {}).filter(\r\n      ([key]) => !Object.keys(BUILTIN_REGISTRIES).includes(key)\r\n    )\r\n  )\r\n\r\n  const newConfigWithRegistries = {\r\n    ...config,\r\n    registries: {\r\n      ...existingRegistries,\r\n      ...foundRegistries,\r\n    },\r\n  }\r\n\r\n  if (options.writeFile) {\r\n    const { resolvedPaths, ...configWithoutResolvedPaths } =\r\n      newConfigWithRegistries\r\n    const configSpinner = spinner(\"Updating components.json.\", {\r\n      silent: options.silent,\r\n    }).start()\r\n    const updatedConfig = rawConfigSchema.parse(configWithoutResolvedPaths)\r\n    await fs.writeFile(\r\n      path.resolve(config.resolvedPaths.cwd, \"components.json\"),\r\n      JSON.stringify(updatedConfig, null, 2) + \"\\n\",\r\n      \"utf-8\"\r\n    )\r\n    configSpinner.succeed()\r\n  }\r\n\r\n  return {\r\n    config: newConfigWithRegistries,\r\n    newRegistries: Object.keys(foundRegistries),\r\n  }\r\n}\r\n","import { Command } from \"commander\";\r\nimport path from \"path\";\r\nimport prompts from \"prompts\";\r\nimport z from \"zod\";\r\nimport { getRegistryItems } from \"../registry/api\";\r\nimport { clearRegistryContext } from \"../registry/context\";\r\nimport { isUniversalRegistryItem } from \"../registry/utils\";\r\nimport { addComponents } from \"../utils/add-components\";\r\nimport { loadEnvFiles } from \"../utils/env-loader\";\r\nimport { createConfig, getConfig } from \"../utils/get-config\";\r\nimport { handleError } from \"../utils/handle-error\";\r\nimport { highlighter } from \"../utils/highlighter\";\r\nimport { logger } from \"../utils/logger\";\r\nimport { ensureRegistriesInConfig } from \"../utils/registries\";\r\n\r\nexport const addOptionsSchema = z.object({\r\n  components: z.array(z.string()).optional(),\r\n  yes: z.boolean(),\r\n  overwrite: z.boolean(),\r\n  cwd: z.string(),\r\n  all: z.boolean(),\r\n  path: z.string().optional(),\r\n  silent: z.boolean(),\r\n  srcDir: z.boolean().optional(),\r\n  cssVariables: z.boolean(),\r\n})\r\n\r\nexport const add = new Command()\r\n  .name(\"add\")\r\n  .description(\"add a component to your project.\")\r\n  .argument(\"[components...]\", \"names, url or local path to component.\")\r\n  .option(\"-y, --yes\", \"skip confirmation prompt.\", false)\r\n  .option(\"-o, --overwrite\", \"overwrite existing files.\", false)\r\n  .option(\r\n    \"-c, --cwd <cwd>\",\r\n    \"the working directory. defaults to the current directory.\",\r\n    process.cwd()\r\n  )\r\n  .option(\"-a, --all\", \"add all available components\", false)\r\n  .option(\"-p, --path <path>\", \"the path to add the component to.\")\r\n  .option(\"-s, --silent\", \"mute output.\", false)\r\n  .option(\r\n    \"--src-dir\",\r\n    \"use the src directory when creating a new project.\",\r\n    false\r\n  )\r\n  .option(\r\n    \"--no-src-dir\",\r\n    \"do not use the src directory when creating a new project.\"\r\n  )\r\n  .option(\"--css-variables\", \"use css variables for theming.\", true)\r\n  .option(\"--no-css-variables\", \"do not use css variables for theming.\")\r\n  .action(async (components, opts) => {\r\n    try{\r\n      const options = addOptionsSchema.parse({\r\n        components,\r\n        cwd: path.resolve(opts.cwd),\r\n        ...opts,\r\n      });\r\n\r\n      await loadEnvFiles(options.cwd);\r\n\r\n      let initialConfig = await getConfig(options.cwd);\r\n      if (!initialConfig) {\r\n        initialConfig = createConfig({\r\n          style: \"aodesu\",\r\n          resolvedPaths: {\r\n            cwd: options.path,\r\n          },\r\n        })\r\n      }\r\n\r\n      let hasNewRegistries = false;\r\n      if (components.length > 0) {\r\n        const { config: updatedConfig, newRegistries } =\r\n          await ensureRegistriesInConfig(components, initialConfig, {\r\n            silent: options.silent,\r\n            writeFile: false,\r\n          });\r\n        initialConfig = updatedConfig;\r\n        hasNewRegistries = newRegistries.length > 0;\r\n      }\r\n\r\n      if (components.length > 0) {\r\n        const [registryItem] = await getRegistryItems([components[0]], {\r\n          config: initialConfig,\r\n        })\r\n        const itemType = registryItem?.type\r\n\r\n        if (isUniversalRegistryItem(registryItem)) {\r\n          await addComponents(components, initialConfig, options)\r\n          return\r\n        }\r\n\r\n        if (\r\n          !options.yes &&\r\n          (itemType === \"registry:style\" || itemType === \"registry:theme\")\r\n        ) {\r\n          logger.break()\r\n          const { confirm } = await prompts({\r\n            type: \"confirm\",\r\n            name: \"confirm\",\r\n            message: highlighter.warn(\r\n              `You are about to install a new ${itemType.replace(\r\n                \"registry:\",\r\n                \"\"\r\n              )}. \\nExisting CSS variables and components will be overwritten. Continue?`\r\n            ),\r\n          })\r\n          if (!confirm) {\r\n            logger.break()\r\n            logger.log(`Installation cancelled.`)\r\n            logger.break()\r\n            process.exit(1)\r\n          }\r\n        }\r\n      }\r\n\r\n    } catch (error) {\r\n      logger.break();\r\n      handleError(error);\r\n    } finally {\r\n      clearRegistryContext();\r\n    }\r\n  })\r\n","import * as ERRORS from \"@/src/utils/errors\";\r\nimport fs from \"fs-extra\";\r\nimport path from \"path\";\r\nimport z from \"zod\";\r\nimport { buildOptionsSchema } from \"../commands/build\";\r\nimport { highlighter } from \"../utils/highlighter\";\r\nimport { logger } from \"../utils/logger\";\r\n\r\nexport async function preFlightBuild(\r\n  options: z.infer<typeof buildOptionsSchema>\r\n) {\r\n  const errors: Record<string, boolean> = {};\r\n\r\n  const resolvePaths = {\r\n    cwd: options.cwd,\r\n    registryFile: path.resolve(options.cwd, options.registryFile),\r\n    outputDir: path.resolve(options.cwd, options.outputDir),\r\n  };\r\n\r\n  // Ensure registry file exist.\r\n  if (!fs.existsSync(resolvePaths.registryFile)) {\r\n    errors[ERRORS.BUILD_MISSING_REGISTRY_FILE] = true;\r\n  }\r\n\r\n  // Create output directory if it doesn't exist.\r\n  await fs.mkdir(resolvePaths.outputDir, { recursive: true });\r\n\r\n  if (Object.keys(errors).length > 0) {\r\n    if (errors[ERRORS.BUILD_MISSING_REGISTRY_FILE]) {\r\n      logger.break();\r\n      logger.error(\r\n        `The path ${highlighter.info(\r\n          resolvePaths.registryFile\r\n        )} does not exist.`\r\n      );\r\n    }\r\n\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  return {\r\n    errors,\r\n    resolvePaths\r\n  };\r\n}\r\n","import { Command } from \"commander\";\r\nimport * as fs from \"fs/promises\";\r\nimport * as path from \"path\";\r\nimport z from \"zod\";\r\nimport { preFlightBuild } from \"../preflights/preflight-build\";\r\nimport { registryItemSchema, registrySchema } from \"../schema\";\r\nimport { handleError } from \"../utils/handle-error\";\r\nimport { highlighter } from \"../utils/highlighter\";\r\nimport { logger } from \"../utils/logger\";\r\nimport { spinner } from \"../utils/spinner\";\r\n\r\nexport const buildOptionsSchema = z.object({\r\n  cwd: z.string(),\r\n  registryFile: z.string(),\r\n  outputDir: z.string(),\r\n});\r\n\r\nexport const build = new Command()\r\n  .name(\"build\")\r\n  .description(\"build components for a aodesu registry\")\r\n  .argument(\"[registry]\", \"path to registry.json file\", \"./registry.json\")\r\n  .option(\r\n    \"-o, --output <path>\",\r\n    \"destination directory for json files\",\r\n    \"./public/r\"\r\n  )\r\n  .option(\r\n    \"-c, --cwd <cwd>\",\r\n    \"the working directory. defaults to the current directory.\",\r\n    process.cwd()\r\n  )\r\n  .action(async (registry: string, opts) => {\r\n    try {\r\n      const options = buildOptionsSchema.parse({\r\n        cwd: path.resolve(opts.cwd),\r\n        registryFile: registry,\r\n        outputDir: opts.output,\r\n      });\r\n\r\n      const { resolvePaths } = await preFlightBuild(options);\r\n      const content = await fs.readFile(resolvePaths.registryFile, \"utf-8\");\r\n\r\n      const result = registrySchema.safeParse(JSON.parse(content));\r\n\r\n      if (!result.success) {\r\n        logger.error(\r\n          `Invalid registry file found at ${highlighter.info(\r\n            resolvePaths.registryFile\r\n          )}.`\r\n        );\r\n        process.exit(1);\r\n      }\r\n\r\n      const buildSpinner = spinner(\"Building registry...\");\r\n      for (const registryItem of result.data.items) {\r\n        buildSpinner.start(`Building ${registryItem.name}...`);\r\n\r\n        // Add the schema to the registry item.\r\n        registryItem[\"$schema\"] =\r\n          \"https://ui.aodesu.com/schema/registry-item.json\";\r\n\r\n        // Loop through each file in the files array.\r\n        for (const file of registryItem.files ?? []) {\r\n          file[\"content\"] = await fs.readFile(\r\n            path.resolve(resolvePaths.cwd, file.path),\r\n            \"utf-8\"\r\n          );\r\n        };\r\n\r\n        // Validate the registry item.\r\n        const result = registryItemSchema.safeParse(registryItem);\r\n        if (!result.success) {\r\n          logger.error(\r\n            `Invalid registry item found for ${highlighter.info(\r\n              registryItem.name\r\n            )}.`\r\n          );\r\n          continue;\r\n        }\r\n\r\n        logger.info(`Registry item found for ${registryItem.name}`)\r\n\r\n        // Write the registry item to the output directory.\r\n        await fs.writeFile(\r\n          path.resolve(resolvePaths.outputDir, `${result.data.name}.json`),\r\n          JSON.stringify(result.data, null, 2)\r\n        );\r\n      }\r\n\r\n      // Copy registry.json to the output directory.\r\n      await fs.copyFile(\r\n        resolvePaths.registryFile,\r\n        path.resolve(resolvePaths.outputDir, \"registry.json\")\r\n      );\r\n\r\n      buildSpinner.succeed(\"Building registry.\");\r\n    } catch (error) {\r\n      logger.break();\r\n      handleError(error);\r\n    }\r\n  });\r\n","import { initOptionsSchema } from \"@/src/commands/init\";\r\nimport * as ERRORS from \"@/src/utils/errors\";\r\nimport { getProjectInfo } from \"@/src/utils/get-project-info\";\r\nimport { highlighter } from \"@/src/utils/highlighter\";\r\nimport { logger } from \"@/src/utils/logger\";\r\nimport { spinner } from \"@/src/utils/spinner\";\r\nimport fs from \"fs-extra\";\r\nimport path from \"path\";\r\nimport { z } from \"zod\";\r\n\r\nexport async function preFlightInit(\r\n  options: z.infer<typeof initOptionsSchema>\r\n) {\r\n  const errors: Record<string, boolean> = {};\r\n\r\n  // Ensure target directory exists.\r\n  // Check for empty project. We assume if no package.json exists, the project is empty.\r\n  if (\r\n    !fs.existsSync(options.cwd) ||\r\n    !fs.existsSync(path.resolve(options.cwd, \"package.json\"))\r\n  ) {\r\n    errors[ERRORS.MISSING_DIR_OR_EMPTY_PROJECT] = true;\r\n    return {\r\n      errors,\r\n      projectInfo: null,\r\n    }\r\n  }\r\n\r\n  const projectSpinner = spinner(\"Preflight checks.\", {\r\n    silent: options.silent,\r\n  }).start()\r\n\r\n  if (\r\n    fs.existsSync(path.resolve(options.cwd, \"components.json\")) &&\r\n    !options.force\r\n  ) {\r\n    projectSpinner?.fail();\r\n    logger.break();\r\n    logger.error(\r\n      `A ${highlighter.info(\r\n        \"components.json\"\r\n      )} file already exist at ${highlighter.info(\r\n        options.cwd\r\n      )}. \\nTo start over, remove the ${highlighter.info(\r\n        \"components.json\"\r\n      )} file and run ${highlighter.info(\"init\")} again.`\r\n    );\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  projectSpinner?.succeed();\r\n\r\n  const frameworkSpinner = spinner(\"Verifying framework.\", {\r\n    silent: options.silent,\r\n  }).start();\r\n  const projectInfo = await getProjectInfo(options.cwd);\r\n  if (!projectInfo || projectInfo?.framework.name === \"manual\") {\r\n    errors[ERRORS.UNSUPPORTED_FRAMEWORK] = true;\r\n    frameworkSpinner?.fail();\r\n    logger.break();\r\n    if (projectInfo?.framework.links.installation) {\r\n      logger.error(\r\n        `We could not detect a supported framework at ${highlighter.info(\r\n          options.cwd\r\n        )}.\\n` +\r\n          `Visit ${highlighter.info(\r\n            projectInfo?.framework.links.installation\r\n          )} to manually configure your project. \\nOnce configured, you can use the cli to add components.`\r\n      )\r\n    }\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n  frameworkSpinner?.succeed(\r\n    `Verifying framework. Found ${highlighter.info(\r\n      projectInfo.framework.label\r\n    )}.`\r\n  )\r\n\r\n  let tailwindSpinnerMessage = \"Validating Tailwind CSS.\";\r\n\r\n  if (projectInfo.tailwindVersion === \"v4\") {\r\n    tailwindSpinnerMessage = `Validating Tailwind CSS config. Found ${highlighter.info(\r\n      \"v4\"\r\n    )}.`\r\n  }\r\n\r\n  const tailwindSpinner = spinner(tailwindSpinnerMessage, {\r\n    silent: options.silent,\r\n  }).start();\r\n\r\n  if (\r\n    projectInfo.tailwindVersion === \"v3\" &&\r\n    (!projectInfo?.tailwindConfigFile || !projectInfo?.tailwindCssFile)\r\n  ) {\r\n    errors[ERRORS.TAILWIND_NOT_CONFIGURED] = true\r\n    tailwindSpinner?.fail()\r\n  } else if (\r\n    projectInfo.tailwindVersion === \"v4\" &&\r\n    !projectInfo?.tailwindCssFile\r\n  ) {\r\n    errors[ERRORS.TAILWIND_NOT_CONFIGURED] = true\r\n    tailwindSpinner?.fail()\r\n  } else if (!projectInfo.tailwindVersion) {\r\n    errors[ERRORS.TAILWIND_NOT_CONFIGURED] = true\r\n    tailwindSpinner?.fail()\r\n  } else {\r\n    tailwindSpinner?.succeed()\r\n  }\r\n\r\n  const tsConfigSpinner = spinner(`Validating import alias.`, {\r\n    silent: options.silent,\r\n  }).start();\r\n\r\n  if (!projectInfo?.aliasPrefix) {\r\n    errors[ERRORS.IMPORT_ALIAS_MISSING] = true\r\n    tsConfigSpinner?.fail()\r\n  } else {\r\n    tsConfigSpinner?.succeed()\r\n  }\r\n\r\n  if (Object.keys(errors).length > 0) {\r\n    if (errors[ERRORS.TAILWIND_NOT_CONFIGURED]) {\r\n      logger.break()\r\n      logger.error(\r\n        `No Tailwind CSS configuration found at ${highlighter.info(\r\n          options.cwd\r\n        )}.`\r\n      )\r\n      logger.error(\r\n        `It is likely you do not have Tailwind CSS installed or have an invalid configuration.`\r\n      )\r\n      logger.error(`Install Tailwind CSS then try again.`)\r\n      if (projectInfo?.framework.links.tailwind) {\r\n        logger.error(\r\n          `Visit ${highlighter.info(\r\n            projectInfo?.framework.links.tailwind\r\n          )} to get started.`\r\n        )\r\n      }\r\n    }\r\n\r\n    if (errors[ERRORS.IMPORT_ALIAS_MISSING]) {\r\n      logger.break()\r\n      logger.error(`No import alias found in your tsconfig.json file.`)\r\n      if (projectInfo?.framework.links.installation) {\r\n        logger.error(\r\n          `Visit ${highlighter.info(\r\n            projectInfo?.framework.links.installation\r\n          )} to learn how to set an import alias.`\r\n        )\r\n      }\r\n    }\r\n\r\n    logger.break()\r\n    process.exit(1)\r\n  }\r\n\r\n  return {\r\n    errors,\r\n    projectInfo\r\n  }\r\n}\r\n","import { initOptionsSchema } from \"@/src/commands/init\";\r\nimport { fetchRegistry } from \"@/src/registry/fetcher\";\r\nimport { getPackageManager } from \"@/src/utils/get-package-manager\";\r\nimport { handleError } from \"@/src/utils/handle-error\";\r\nimport { highlighter } from \"@/src/utils/highlighter\";\r\nimport { logger } from \"@/src/utils/logger\";\r\nimport { spinner } from \"@/src/utils/spinner\";\r\nimport { execa } from \"execa\";\r\nimport fs from \"fs-extra\";\r\nimport os from \"os\";\r\nimport path from \"path\";\r\nimport prompts from \"prompts\";\r\nimport z from \"zod\";\r\n\r\nconst MONOREPO_TEMPLATE_URL = \"https://codeload.github.com/aodesu-ui/ui/tar.gz/main\";\r\n\r\nexport const TEMPLATES = {\r\n  next: \"next\",\r\n  \"next-16\": \"next-16\",\r\n  \"next-monorepo\": \"next-monorepo\",\r\n  vite: \"vite\"\r\n} as const;\r\n\r\nexport async function createProject(\r\n  options: Pick<\r\n    z.infer<typeof initOptionsSchema>,\r\n    \"cwd\" | \"force\" | \"srcDir\" | \"components\" | \"template\"\r\n  >\r\n) {\r\n  options = {\r\n    srcDir: false,\r\n    ...options,\r\n  };\r\n\r\n  let template: keyof typeof TEMPLATES =\r\n    options.template && TEMPLATES[options.template as keyof typeof TEMPLATES]\r\n    ? (options.template as keyof typeof TEMPLATES)\r\n    : \"next\";\r\n\r\n  let projectName: string =\r\n    template === TEMPLATES.next ? \"my-app\" : \"my-monorepo\";\r\n\r\n  let nextVersion = \"15\";\r\n\r\n  const isRemoteComponent =\r\n    options.components?.length === 1 &&\r\n    !!options.components[0].match(/\\/chat\\/b\\//);\r\n\r\n  if (options.components && isRemoteComponent) {\r\n    try {\r\n      const [result] = await fetchRegistry(options.components);\r\n      const { meta } = z\r\n        .object({\r\n          meta: z.object({\r\n            nextVersion: z.string(),\r\n          }),\r\n        })\r\n        .parse(result);\r\n      nextVersion = meta.nextVersion;\r\n\r\n      // Force template to next for remote components.\r\n      template = TEMPLATES.next;\r\n    } catch (error) {\r\n      logger.break();\r\n      handleError(error);\r\n    }\r\n  }\r\n\r\n  if (!options.force) {\r\n    const { type, name } = await prompts([\r\n      {\r\n        type: options.template || isRemoteComponent ? null : \"select\",\r\n        name: \"type\",\r\n        message: `The path ${highlighter.info(\r\n          options.cwd\r\n        )} does not contain a package.json file.\\n  Would you like to start a new project?`,\r\n        choices: [\r\n          { title: \"Vite\", value: \"vite\" },\r\n          { title: \"Next.js 15\", value: \"next\" },\r\n          { title: \"Next.js 16\", value: \"next-16\" },\r\n          { title: \"Next.js (Monorepo)\", value: \"next-monorepo\" },\r\n        ],\r\n        initial: 0,\r\n      },\r\n      {\r\n        type: \"text\",\r\n        name: \"name\",\r\n        message: \"What is your project named?\",\r\n        initial: projectName,\r\n        format: (value: string) => value.trim(),\r\n        validate: (value: string) =>\r\n          value.length > 128\r\n            ? `Name should be less than 128 characters.`\r\n            : true,\r\n      },\r\n    ])\r\n\r\n    template = type ?? template;\r\n    projectName = name;\r\n\r\n    if (type === \"next-16\") {\r\n      nextVersion = \"latest\"\r\n    }\r\n  }\r\n\r\n  const packageManager = await getPackageManager(options.cwd, {\r\n    withFallback: true,\r\n  });\r\n\r\n  const projectPath = `${options.cwd}/${projectName}`;\r\n\r\n  // Check if path is writable.\r\n  try {\r\n    await fs.access(options.cwd, fs.constants.W_OK);\r\n  } catch (error) {\r\n    logger.break()\r\n    logger.error(`The path ${highlighter.info(options.cwd)} is not writable.`)\r\n    logger.error(\r\n      `It is likely you do not have write permissions for this folder or the path ${highlighter.info(\r\n        options.cwd\r\n      )} does not exist.`\r\n    )\r\n    logger.break()\r\n    process.exit(1)\r\n  }\r\n\r\n  if (fs.existsSync(path.resolve(options.cwd, projectName, \"package.json\"))) {\r\n    logger.break()\r\n    logger.error(\r\n      `A project with the name ${highlighter.info(projectName)} already exists.`\r\n    )\r\n    logger.error(`Please choose a different name and try again.`)\r\n    logger.break()\r\n    process.exit(1)\r\n  }\r\n\r\n  if (template === TEMPLATES.vite) {\r\n    await createViteProject(projectPath, {\r\n      packageManager\r\n    })\r\n  }\r\n\r\n  if (template === TEMPLATES.next || template === TEMPLATES[\"next-16\"]) {\r\n    await createNextProject(projectPath, {\r\n      version: nextVersion,\r\n      cwd: options.cwd,\r\n      packageManager,\r\n      srcDir: !!options.srcDir,\r\n    })\r\n  }\r\n\r\n  if (template === TEMPLATES[\"next-monorepo\"]) {\r\n    await createMonorepoProject(projectPath, {\r\n      packageManager,\r\n    })\r\n  }\r\n\r\n  return {\r\n    projectPath,\r\n    projectName,\r\n    template,\r\n  }\r\n}\r\n\r\nasync function createViteProject(\r\n  projectPath: string,\r\n  options: {\r\n    packageManager: string\r\n  }\r\n) {\r\n  const createSpinner = spinner(\r\n    `Creating a new Vite project. This may take a few minutes.`\r\n  ).start();\r\n\r\n  try {\r\n    const args = [\r\n      \"create\",\r\n      \"vite@latest\",\r\n      path.basename(projectPath),\r\n      \"--template\",\r\n      \"react-ts\",\r\n      \"--yes\"\r\n    ]\r\n\r\n    await execa(options.packageManager, args, {\r\n      cwd: path.dirname(projectPath),\r\n    });\r\n\r\n    const installSpinner = spinner(`Installing dependencies with ${options.packageManager}.`).start();\r\n\r\n    await execa(options.packageManager, [\"install\"], {\r\n      cwd: projectPath,\r\n    });\r\n\r\n    installSpinner?.succeed(`Installed dependencies with ${options.packageManager}.`);\r\n\r\n    try {\r\n      await execa(\"git\", [\"init\"], { cwd: projectPath })\r\n      await execa(\"git\", [\"add\", \"-A\"], { cwd: projectPath })\r\n      await execa(\"git\", [\"commit\", \"-m\", \"Initial commit from aodesu-ui\"], {\r\n        cwd: projectPath,\r\n      })\r\n    } catch (gitError) {\r\n      logger.warn(\"Git initialization skipped (git not available)\")\r\n    }\r\n\r\n    createSpinner?.succeed(\"Creating a new Vite project.\");\r\n  } catch (error) {\r\n    createSpinner?.fail(\"Something went worng creating a new Vite project.\");\r\n    handleError(error);\r\n  }\r\n}\r\n\r\nasync function createNextProject(\r\n  projectPath: string,\r\n  options: {\r\n    version: string\r\n    cwd: string\r\n    packageManager: string\r\n    srcDir: boolean\r\n  }\r\n) {\r\n  const createSpinner = spinner(\r\n    `Creating a new Next.js ${\r\n      options.version.startsWith(\"latest\") ? \"16\" : \"15\"\r\n    } project. This may take a few minutes.`\r\n  ).start()\r\n\r\n  // Note: pnpm fails here. Fallback to npx with --use-PACKAGE-MANAGER.\r\n  const args = [\r\n    \"--tailwind\",\r\n    \"--eslint\",\r\n    \"--typescript\",\r\n    \"--app\",\r\n    options.srcDir ? \"--src-dir\" : \"--no-src-dir\",\r\n    \"--no-import-alias\",\r\n    `--use-${options.packageManager}`,\r\n  ]\r\n\r\n  if (\r\n    options.version.startsWith(\"15\") ||\r\n    options.version.startsWith(\"latest\") ||\r\n    options.version.startsWith(\"canary\")\r\n  ) {\r\n    args.push(\"--turbopack\")\r\n  }\r\n\r\n  if (\r\n    options.version.startsWith(\"latest\") ||\r\n    options.version.startsWith(\"canary\")\r\n  ) {\r\n    args.push(\"--no-react-compiler\")\r\n  }\r\n\r\n  try {\r\n    await execa(\r\n      \"npx\",\r\n      [`create-next-app@${options.version}`, projectPath, \"--silent\", ...args],\r\n      {\r\n        cwd: options.cwd,\r\n      }\r\n    )\r\n  } catch (error) {\r\n    logger.break()\r\n    logger.error(\r\n      `Something went wrong creating a new Next.js project. Please try again.`\r\n    )\r\n    process.exit(1)\r\n  }\r\n\r\n  createSpinner?.succeed(\r\n    `Creating a new Next.js ${\r\n      options.version.startsWith(\"latest\") ? \"16\" : \"15\"\r\n    } project.`\r\n  )\r\n}\r\n\r\nasync function createMonorepoProject(\r\n  projectPath: string,\r\n  options: {\r\n    packageManager: string\r\n  }\r\n) {\r\n  const createSpinner = spinner(\r\n    `Creating a new Next.js monorepo. This may take a few minutes.`\r\n  ).start()\r\n\r\n  try {\r\n    // Get the template.\r\n    const templatePath = path.join(os.tmpdir(), `aodesu-template-${Date.now()}`)\r\n    await fs.ensureDir(templatePath)\r\n    const response = await fetch(MONOREPO_TEMPLATE_URL)\r\n    if (!response.ok) {\r\n      throw new Error(`Failed to download template: ${response.statusText}`)\r\n    }\r\n\r\n    // Write the tar file\r\n    const tarPath = path.resolve(templatePath, \"template.tar.gz\")\r\n    await fs.writeFile(tarPath, Buffer.from(await response.arrayBuffer()))\r\n    await execa(\"tar\", [\r\n      \"-xzf\",\r\n      tarPath,\r\n      \"-C\",\r\n      templatePath,\r\n      \"--strip-components=2\",\r\n      \"ui-main/templates/monorepo-next\",\r\n    ])\r\n    const extractedPath = path.resolve(templatePath, \"monorepo-next\")\r\n    await fs.move(extractedPath, projectPath)\r\n    await fs.remove(templatePath)\r\n\r\n    // Run install.\r\n    await execa(options.packageManager, [\"install\"], {\r\n      cwd: projectPath,\r\n    })\r\n    // await execa(\"cd\", [cwd])\r\n\r\n    // Write project name to the package.json\r\n    const packageJsonPath = path.join(projectPath, \"package.json\")\r\n    if (fs.existsSync(packageJsonPath)) {\r\n      const packageJsonContent = await fs.readFile(packageJsonPath, \"utf8\")\r\n      const packageJson = JSON.parse(packageJsonContent)\r\n      packageJson.name = projectPath.split(\"/\").pop()\r\n      await fs.writeFile(packageJsonPath, JSON.stringify(packageJson, null, 2))\r\n    }\r\n\r\n    // Try git init.\r\n    const cwd = process.cwd()\r\n    await execa(\"git\", [\"--version\"], { cwd: projectPath })\r\n    await execa(\"git\", [\"init\"], { cwd: projectPath })\r\n    await execa(\"git\", [\"add\", \"-A\"], { cwd: projectPath })\r\n    await execa(\"git\", [\"commit\", \"-m\", \"Initial commit\"], {\r\n      cwd: projectPath,\r\n    })\r\n\r\n    createSpinner?.succeed(\"Creating a new Next.js monorepo.\")\r\n  } catch (error) {\r\n    createSpinner?.fail(\"Something went wrong creating a new Next.js monorepo.\")\r\n    handleError(error)\r\n  }\r\n}\r\n","import fsExtra from \"fs-extra\"\r\n\r\nexport const FILE_BACKUP_SUFFIX = \".bak\"\r\n\r\nexport function createFileBackup(filePath: string): string | null {\r\n  if (!fsExtra.existsSync(filePath)) {\r\n    return null\r\n  }\r\n\r\n  const backupPath = `${filePath}${FILE_BACKUP_SUFFIX}`\r\n  try {\r\n    fsExtra.renameSync(filePath, backupPath)\r\n    return backupPath\r\n  } catch (error) {\r\n    console.error(`Failed to create backup of ${filePath}: ${error}`)\r\n    return null\r\n  }\r\n}\r\n\r\nexport function restoreFileBackup(filePath: string): boolean {\r\n  const backupPath = `${filePath}${FILE_BACKUP_SUFFIX}`\r\n\r\n  if (!fsExtra.existsSync(backupPath)) {\r\n    return false\r\n  }\r\n\r\n  try {\r\n    fsExtra.renameSync(backupPath, filePath)\r\n    return true\r\n  } catch (error) {\r\n    console.error(\r\n      `Warning: Could not restore backup file ${backupPath}: ${error}`\r\n    )\r\n    return false\r\n  }\r\n}\r\n\r\nexport function deleteFileBackup(filePath: string): boolean {\r\n  const backupPath = `${filePath}${FILE_BACKUP_SUFFIX}`\r\n\r\n  if (!fsExtra.existsSync(backupPath)) {\r\n    return false\r\n  }\r\n\r\n  try {\r\n    fsExtra.unlinkSync(backupPath)\r\n    return true\r\n  } catch (error) {\r\n    // Best effort - don't log as this is just cleanup\r\n    return false\r\n  }\r\n}\r\n","import * as ERRORS from \"@/src/utils/errors\";\r\nimport { Command } from 'commander';\r\nimport fsExtra from 'fs-extra';\r\nimport path from 'path';\r\nimport prompts from \"prompts\";\r\nimport z from 'zod';\r\nimport { preFlightInit } from '../preflights/preflight-init';\r\nimport { getRegistryBaseColors, getRegistryItems, getRegistryStyles } from '../registry/api';\r\nimport { buildUrlAndHeadersForRegistryItem } from '../registry/builder';\r\nimport { configWithDefaults } from '../registry/config';\r\nimport { clearRegistryContext } from '../registry/context';\r\nimport { rawConfigSchema } from \"../schema\";\r\nimport { createProject } from \"../utils/create-project\";\r\nimport { loadEnvFiles } from '../utils/env-loader';\r\nimport { createFileBackup, deleteFileBackup, restoreFileBackup } from '../utils/file-helper';\r\nimport { Config, getConfig } from \"../utils/get-config\";\r\nimport { getProjectConfig, getProjectInfo, getProjectTailwindVersionFromConfig } from \"../utils/get-project-info\";\r\nimport { handleError } from '../utils/handle-error';\r\nimport { highlighter } from '../utils/highlighter';\r\nimport { logger } from '../utils/logger';\r\nimport { ensureRegistriesInConfig } from '../utils/registries';\r\nprocess.on(\"exit\", (code) => {\r\n  const filePath = path.resolve(process.cwd(), \"components.json\")\r\n\r\n  if (code === 0) {\r\n    return deleteFileBackup(filePath);\r\n  }\r\n\r\n  return restoreFileBackup(filePath);\r\n});\r\n\r\nexport const initOptionsSchema = z.object({\r\n  cwd: z.string(),\r\n  components: z.array(z.string()).optional(),\r\n  yes: z.boolean(),\r\n  defaults: z.boolean(),\r\n  force: z.boolean(),\r\n  silent: z.boolean(),\r\n  isNewProject: z.boolean(),\r\n  srcDir: z.boolean().optional(),\r\n  cssVariables: z.boolean(),\r\n  template: z\r\n    .string()\r\n    .optional()\r\n    .refine(\r\n      (val) => {\r\n        if (val) {\r\n          return \"TEMPLATES\"\r\n        }\r\n        return true\r\n      },\r\n      {\r\n        message: \"Invalid template. Please use 'next', 'next-16' or 'next-monorepo'.\",\r\n      }\r\n    ),\r\n  baseColor: z\r\n    .string()\r\n    .optional(),\r\n  baseStyle: z.boolean(),\r\n});\r\n\r\nexport const init = new Command()\r\n  .name(\"init\")\r\n  .description(\"initialize your project and install dependencies\")\r\n  .argument(\"[components...]\", \"names, url or local path to component\")\r\n  .option(\r\n    \"-t, --template <template>\",\r\n    \"the template to use. (next, next-16, next-monorepo)\"\r\n  )\r\n  .option(\"-b, --base-color <base-color>\", \"The base color to use. (neutral)\", undefined)\r\n  .option(\"-y, --yes\", \"Skip de confirmation prompt\", true)\r\n  .option(\"-d, --defaults\", \"Use default configuration.\", false)\r\n  .option(\"-f, --force\", \"Force overwrite of existing configuration\", false)\r\n  .option(\r\n    \"-c, --cwd <cwd>\",\r\n    \"the working directory. defaults to the current directory.\",\r\n    process.cwd()\r\n  )\r\n  .option(\"-s, --silent\", \"Mute output\", false)\r\n  .option(\"--src-dir\", \"Use the src directory when creating a new project.\", false)\r\n  .option(\"--no-src-dir\", \"Do not use the src directory when creating a new project.\")\r\n  .option(\"--css-variables\", \"Use css variables for theming.\", true)\r\n  .option(\"--no-base-style\", \"Do not install the base aodesu style.\")\r\n  .action(async (components, opts) => {\r\n    try {\r\n      if (opts.defaults) {\r\n        opts.template = opts.template || \"next\"\r\n        opts.baseColor = opts.baseColor || \"neutral\"\r\n      }\r\n\r\n      const options = initOptionsSchema.parse({\r\n        cwd: path.resolve(opts.cwd),\r\n        isNewProject: false,\r\n        components,\r\n        ...opts\r\n      });\r\n\r\n      await loadEnvFiles(options.cwd);\r\n\r\n      // We need check if we're initializing with a new style\r\n      // This will allow us to determine if we need to install the base style.\r\n      // And if we should prompt the user for a base color.\r\n      if (components.length > 0) {\r\n        // We don't know the full config at this point.\r\n        // So we'll use a shadow config to fetch the first item,\r\n        let shadowConfig = configWithDefaults({});\r\n\r\n        // Check if there's a components.json file.\r\n        // If so, we'll merge with our shadow config.\r\n        const componentsJsonPath = path.resolve(options.cwd, \"components.json\");\r\n        if (fsExtra.existsSync(componentsJsonPath)) {\r\n          const existingConfig = await fsExtra.readJson(componentsJsonPath);\r\n          const config = rawConfigSchema.partial().parse(existingConfig);\r\n          shadowConfig = configWithDefaults(config);\r\n\r\n          // Since components.json might not be valid at this point.\r\n          // Temporaly rename components.json to allow preflight to run.\r\n          // We'll rename it back after preflight.\r\n          createFileBackup(componentsJsonPath);\r\n        }\r\n\r\n        // Ensure all registries used in componentes are configured.\r\n        const { config: updatedConfig } = await ensureRegistriesInConfig(\r\n          components,\r\n          shadowConfig,\r\n          {\r\n            silent: true,\r\n          }\r\n        )\r\n        shadowConfig = updatedConfig;\r\n\r\n\r\n        // This forces a shadowConfig validation early in the process.\r\n        buildUrlAndHeadersForRegistryItem(components[0], shadowConfig);\r\n\r\n\r\n        const [item] = await getRegistryItems([components[0]], {\r\n          config: shadowConfig\r\n        });\r\n\r\n        console.log(\"TEST - LLEGO AKI\")\r\n\r\n        if (item?.type == \"registry:style\") {\r\n          // Set a default base color so we're not prompted.\r\n          // The style will extend or override it.\r\n          options.baseColor = \"neutral\";\r\n\r\n          // If the style extends none, we don't want to install the base style.\r\n          options.baseStyle =\r\n            item.extends === \"none\" ? false : options.baseStyle;\r\n        }\r\n      }\r\n\r\n      // If --no-base-style, we don't want to prompt for a base color either\r\n      if (!options.baseStyle) {\r\n        options.baseColor = \"neutral\";\r\n      }\r\n\r\n      await runInit(options);\r\n\r\n      logger.log(\r\n        `${highlighter.success(\r\n          \"Success!\"\r\n        )} Project initialization completed. \\nYou may now add components.`\r\n      )\r\n\r\n    } catch (error) {\r\n      logger.break();\r\n      handleError(error);\r\n    } finally {\r\n      clearRegistryContext();\r\n    }\r\n  })\r\n\r\n\r\nexport async function runInit(\r\n  options: z.infer<typeof initOptionsSchema> & {\r\n    skipPreflight?: boolean\r\n  }\r\n) {\r\n  let projectInfo;\r\n  let newProjectTemplate;\r\n  if (!options.skipPreflight) {\r\n    const preflight = await preFlightInit(options);\r\n    if (preflight.errors[ERRORS.MISSING_DIR_OR_EMPTY_PROJECT]) {\r\n      const { projectPath, template } = await createProject(options);\r\n      if (!projectPath) {\r\n        process.exit(1);\r\n      }\r\n      options.cwd = projectPath;\r\n      options.isNewProject = true;\r\n      newProjectTemplate = template;\r\n    }\r\n    projectInfo = preflight.projectInfo;\r\n  } else {\r\n    projectInfo = await getProjectInfo(options.cwd);\r\n  }\r\n\r\n  if (newProjectTemplate === \"next-monorepo\") {\r\n    options.cwd = path.resolve(options.cwd, \"apps/web\");\r\n    return await getConfig(options.cwd);\r\n  }\r\n\r\n  const projectConfig = await getProjectConfig(options.cwd, projectInfo);\r\n\r\n  let config = projectConfig\r\n    ? await promptForMinimalConfig(projectConfig, options)\r\n    : console.log(\"xd\")\r\n}\r\n\r\nasync function promptForMinimalConfig(\r\n  defaultConfig: Config,\r\n  opts: z.infer<typeof initOptionsSchema>\r\n) {\r\n  let style = defaultConfig.style;\r\n  let baseColor = opts.baseColor;\r\n  let cssVariables = defaultConfig.tailwind.cssVariables;\r\n\r\n  if (!opts.defaults) {\r\n    const [styles, baseColors, tailwindVersion] = await Promise.all([\r\n      getRegistryStyles(),\r\n      getRegistryBaseColors(),\r\n      getProjectTailwindVersionFromConfig(defaultConfig),\r\n    ]);\r\n\r\n    const options = await prompts([\r\n      {\r\n        type: tailwindVersion === \"v4\" ? null : \"select\",\r\n        name: \"style\",\r\n        message: `Which ${highlighter.info(\"style\")} would you like to use?`,\r\n        choices: styles.map((style) => ({\r\n          title:\r\n            style.name === \"aodesu\" ? \"aodesu (Recommended)\" : style.label,\r\n          value: style.name,\r\n        })),\r\n        initial: 0,\r\n      },\r\n      {\r\n        type: opts.baseColor ? null : \"select\",\r\n        name: \"tailwindBaseColor\",\r\n        message: `Which color would you like to use as the ${highlighter.info(\"base color\")}?`,\r\n        choices: baseColors.map((color) => ({\r\n          title: color.label,\r\n          value: color.name,\r\n        })),\r\n      },\r\n    ]);\r\n\r\n    style = options.style ?? \"aodesu\";\r\n    baseColor = options.tailwindBaseColor ?? baseColor;\r\n    cssVariables = opts.cssVariables;\r\n  }\r\n\r\n  return rawConfigSchema.parse({\r\n    $schema: defaultConfig?.$schema,\r\n    style,\r\n    tailwind: {\r\n      ...defaultConfig?.tailwind,\r\n      baseColor,\r\n      cssVariables,\r\n    },\r\n    rsc: defaultConfig?.rsc,\r\n    tsx: defaultConfig?.tsx,\r\n    iconLibrary: defaultConfig?.iconLibrary,\r\n    aliases: defaultConfig?.aliases,\r\n  });\r\n}\r\n","#!/usr/bin/env node\r\nimport { Command } from \"commander\";\r\nimport packageJson from \"../package.json\";\r\nimport { add } from \"./commands/add\";\r\nimport { build } from \"./commands/build\";\r\nimport { init } from \"./commands/init\";\r\n\r\nprocess.on(\"SIGNINT\", () => process.exit(0));\r\nprocess.on(\"SIGTERM\", () => process.exit(0));\r\n\r\nasync function main() {\r\n  const program = new Command()\r\n    .name(\"uidesu\")\r\n    .description(\"add items from registry to your project\")\r\n    .version(\r\n      packageJson.version || \"1.0.0\",\r\n      \"-v, --version\",\r\n      \"display the version number\"\r\n    )\r\n\r\n  program\r\n    .addCommand(init)\r\n    .addCommand(add)\r\n    .addCommand(build)\r\n\r\n  program.parse()\r\n}\r\n\r\nmain()\r\n\r\n// export * from './registry/api';\r\n"]}
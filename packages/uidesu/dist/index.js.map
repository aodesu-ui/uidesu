{"version":3,"sources":["../package.json","../src/utils/highlighter.ts","../src/utils/logger.ts","../src/preflights/preflight-build.ts","../src/registry/errors.ts","../src/utils/handle-error.ts","../src/utils/spinner.ts","../src/commands/build.ts","../src/utils/frameworks.ts","../src/registry/constants.ts","../src/utils/resolve-import.ts","../src/utils/get-config.ts","../src/utils/get-package-info.ts","../src/utils/get-project-info.ts","../src/preflights/preflight-init.ts","../src/registry/env.ts","../src/registry/parser.ts","../src/registry/utils.ts","../src/registry/config.ts","../src/registry/context.ts","../src/registry/validator.ts","../src/registry/builder.ts","../src/registry/fetcher.ts","../src/registry/resolver.ts","../src/registry/api.ts","../src/utils/get-package-manager.ts","../src/utils/create-project.ts","../src/utils/env-loader.ts","../src/utils/file-helper.ts","../src/registry/namespaces.ts","../src/utils/registries.ts","../src/commands/init.ts","../src/index.ts"],"names":["package_default","highlighter","red","yellow","cyan","green","logger","args","preFlightBuild","options","errors","resolvePaths","path","fs","RegistryErrorCode","RegistryError","message","RegistryNotFoundError","url","cause","RegistryUnauthorizedError","RegistryForbiddenError","RegistryFetchError","statusCode","responseBody","baseMessage","suggestion","RegistryNotConfiguredError","registryName","RegistryLocalFileError","filePath","RegistryParseError","item","parseError","z","e","RegistryMissingEnvironmentVariablesError","missingVars","v","RegistriesIndexParseError","invalidNamespaces","i","arr","handleError","error","key","value","spinner","text","ora","buildOptionsSchema","build","Command","registry","opts","M","content","result","registrySchema","buildSpinner","registryItem","file","registryItemSchema","FRAMEWORKS","REGISTRY_URL","FALLBACK_STYLE","BASE_COLORS","BUILTIN_REGISTRIES","resolveImport","importPath","config","createMatchPath","explorer","cosmiconfig","getConfig","cwd","getRawConfig","resolveConfigPaths","tsConfig","loadConfig","configSchema","configResult","rawConfigSchema","componentPath","createConfig","partial","defaultConfig","getPackageInfo","shouldThrow","packageJsonPath","PROJECT_SHARED_IGNORE","getProjectInfo","configFiles","isSrcDir","isTsx","tailwindConfigFile","tailwindCssFile","tailwindVersion","aliasPrefix","packageJson","fg","isTypeScriptProject","getTailwindConfigFile","getTailwindCssFile","getTailwindVersion","getTsConfigAliasPrefix","isUsingAppDir","type","getFrameworkVersion","framework","version","versionMatch","rangeMatch","packageInfo","files","contents","alias","paths","getProjectConfig","defaultProjectInfo","existingConfig","projectInfo","getProjectTailwindVersionFromConfig","preFlightInit","projectSpinner","frameworkSpinner","tailwindSpinnerMessage","tailwindSpinner","tsConfigSpinner","expandEnvVars","_match","extractEnvVars","vars","regex","match","REGISTRY_PATTERN","parseRegistryAndItemFromString","name","isUrl","isLocalFile","resolveStyleFromConfig","configWithDefaults","baseConfig","deepmerge","context","setRegistryHeaders","headers","getRegistryHeadersFromContext","clearRegistryContext","extractEnvVarsFromRegistryConfig","validateRegistryConfig","missing","NAME_PLACEHOLDER","STYLE_PLACEHOLDER","ENV_VAR_PATTER","QUERY_PARAM_SEPARATOR","QUERY_PARAM_DELIMITER","buildUrlAndHeadersForRegistryItem","registryConfig","buildUrlFromRegistryConfig","buildHeadersFromRegistryConfig","baseUrl","appendQueryParams","expandedValue","shouldIncludeHeader","params","urlParams","queryString","separator","originalValue","trimmedExpanded","templateWithoutVars","resolveRegistryUrl","pathOrUrl","agent","HttpsProxyAgent","registryCache","fetchRegistry","fetchPromise","response","fetch","messageFromServer","json","parsed","fetchRegistryLocal","expandedPath","homedir","resolvedPath","resolveRegistryItemsFromRegistries","items","registryHeaders","resolvedItems","resolved","fetchRegistryItems","getRegistryItems","useCache","getRegistryStyles","stylesSchema","getRegistryBaseColors","getRegistriesIndex","data","registriesIndexSchema","getPackageManager","targetDir","withFallback","packageManager","detect","userAgent","MONOREPO_TEMPLATE_URL","TEMPLATES","createProject","template","projectName","nextVersion","isRemoteComponent","meta","prompts","projectPath","createViteProject","createNextProject","createMonorepoProject","createSpinner","execa","installSpinner","templatePath","os","tarPath","extractedPath","packageJsonContent","loadEnvFiles","envFiles","envFile","envPath","join","existsSync","FILE_BACKUP_SUFFIX","createFileBackup","fsExtra","backupPath","restoreFileBackup","deleteFileBackup","resolveRegistryNamespaces","components","discoveredNamespaces","visitedItems","itemsToProcess","currentItem","dep","depRegistry","ensureRegistriesInConfig","missingRegistries","registryIndex","foundRegistries","existingRegistries","newConfigWithRegistries","resolvedPaths","configWithoutResolvedPaths","configSpinner","updatedConfig","code","initOptionsSchema","val","init","shadowConfig","componentsJsonPath","runInit","newProjectTemplate","preflight","projectConfig","promptForMinimalConfig","style","baseColor","cssVariables","styles","baseColors","color","main","program"],"mappings":"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","file":"index.js","sourcesContent":["{\r\n  \"name\": \"uidesu\",\r\n  \"version\": \"1.0.0\",\r\n  \"description\": \"Add components to your apps.\",\r\n  \"publishConfig\": {\r\n    \"access\": \"public\"\r\n  },\r\n  \"license\": \"MIT\",\r\n  \"author\": {\r\n    \"name\": \"sergiocortes-dll\",\r\n    \"url\": \"https://twitter.com/sergiocortes-dll\"\r\n  },\r\n  \"repository\": {\r\n    \"type\": \"git\",\r\n    \"url\": \"https://github.com/aodesu/ui-cli.git\",\r\n    \"directory\": \"packages/aodesu\"\r\n  },\r\n  \"files\": [\r\n    \"dist\"\r\n  ],\r\n  \"keywords\": [\r\n    \"components\",\r\n    \"ui\",\r\n    \"tailwind\",\r\n    \"radix-ui\",\r\n    \"uidesu\"\r\n  ],\r\n  \"type\": \"module\",\r\n  \"exports\": {\r\n    \".\": {\r\n      \"types\": \"./dist/index.d.ts\",\r\n      \"default\": \"./dist/index.js\"\r\n    },\r\n    \"./schema\": {\r\n      \"types\": \"./dist/schema/index.d.ts\",\r\n      \"default\": \"./dist/schema/index.js\"\r\n    }\r\n  },\r\n  \"bin\": \"./dist/index.js\",\r\n  \"scripts\": {\r\n    \"dev\": \"tsup --watch\",\r\n    \"start:dev\": \"cross-env REGISTRY_URL=https://localhost:4000/r node dist/index.js\"\r\n  },\r\n  \"dependencies\": {\r\n    \"@antfu/ni\": \"^25.0.0\",\r\n    \"@dotenvx/dotenvx\": \"^1.48.4\",\r\n    \"commander\": \"^14.0.0\",\r\n    \"cosmiconfig\": \"^9.0.0\",\r\n    \"deepmerge\": \"^4.3.1\",\r\n    \"execa\": \"^9.6.0\",\r\n    \"fast-glob\": \"^3.3.3\",\r\n    \"fs-extra\": \"^11.3.1\",\r\n    \"https-proxy-agent\": \"^7.0.6\",\r\n    \"kleur\": \"^4.1.5\",\r\n    \"node-fetch\": \"^3.3.2\",\r\n    \"ora\": \"^8.2.0\",\r\n    \"prompts\": \"^2.4.2\",\r\n    \"tsconfig-paths\": \"^4.2.0\",\r\n    \"zod\": \"^3.24.1\",\r\n    \"zod-to-json-schema\": \"3.24.6\"\r\n  },\r\n  \"devDependencies\": {\r\n    \"@types/babel__core\": \"^7.20.5\",\r\n    \"@types/fs-extra\": \"^11.0.4\",\r\n    \"@types/prompts\": \"^2.4.9\",\r\n    \"@types/stringify-object\": \"^4.0.5\",\r\n    \"rimraf\": \"^6.0.1\",\r\n    \"tsup\": \"^8.5.0\",\r\n    \"type-fest\": \"^4.41.0\",\r\n    \"typescript\": \"^5.9.2\"\r\n  }\r\n}\r\n","import { cyan, green, red, yellow } from \"kleur/colors\";\r\n\r\nexport const highlighter = {\r\n  error: red,\r\n  warn: yellow,\r\n  info: cyan,\r\n  success: green,\r\n};\r\n","import { highlighter } from \"./highlighter\";\r\n\r\nexport const logger = {\r\n  error(...args: unknown[]) {\r\n    console.log(highlighter.error(args.join(\" \")))\r\n  },\r\n  warn(...args: unknown[]) {\r\n    console.log(highlighter.warn(args.join(\" \")))\r\n  },\r\n  info(...args: unknown[]) {\r\n    console.log(highlighter.info(args.join(\" \")))\r\n  },\r\n  success(...args: unknown[]) {\r\n    console.log(highlighter.success(args.join(\" \")))\r\n  },\r\n  log(...args: unknown[]) {\r\n    console.log(args.join(\" \"))\r\n  },\r\n  break() {\r\n    console.log(\"\")\r\n  },\r\n};\r\n","import * as ERRORS from \"@/src/utils/errors\";\r\nimport fs from \"fs-extra\";\r\nimport path from \"path\";\r\nimport z from \"zod\";\r\nimport { buildOptionsSchema } from \"../commands/build\";\r\nimport { highlighter } from \"../utils/highlighter\";\r\nimport { logger } from \"../utils/logger\";\r\n\r\nexport async function preFlightBuild(\r\n  options: z.infer<typeof buildOptionsSchema>\r\n) {\r\n  const errors: Record<string, boolean> = {};\r\n\r\n  const resolvePaths = {\r\n    cwd: options.cwd,\r\n    registryFile: path.resolve(options.cwd, options.registryFile),\r\n    outputDir: path.resolve(options.cwd, options.outputDir),\r\n  };\r\n\r\n  // Ensure registry file exist.\r\n  if (!fs.existsSync(resolvePaths.registryFile)) {\r\n    errors[ERRORS.BUILD_MISSING_REGISTRY_FILE] = true;\r\n  }\r\n\r\n  // Create output directory if it doesn't exist.\r\n  await fs.mkdir(resolvePaths.outputDir, { recursive: true });\r\n\r\n  if (Object.keys(errors).length > 0) {\r\n    if (errors[ERRORS.BUILD_MISSING_REGISTRY_FILE]) {\r\n      logger.break();\r\n      logger.error(\r\n        `The path ${highlighter.info(\r\n          resolvePaths.registryFile\r\n        )} does not exist.`\r\n      );\r\n    }\r\n\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  return {\r\n    errors,\r\n    resolvePaths\r\n  };\r\n}\r\n","import { z } from \"zod\"\r\n\r\n// Error codes for programmatic error handling\r\nexport const RegistryErrorCode = {\r\n  // Network errors\r\n  NETWORK_ERROR: \"NETWORK_ERROR\",\r\n  NOT_FOUND: \"NOT_FOUND\",\r\n  UNAUTHORIZED: \"UNAUTHORIZED\",\r\n  FORBIDDEN: \"FORBIDDEN\",\r\n  FETCH_ERROR: \"FETCH_ERROR\",\r\n\r\n  // Configuration errors\r\n  NOT_CONFIGURED: \"NOT_CONFIGURED\",\r\n  INVALID_CONFIG: \"INVALID_CONFIG\",\r\n  MISSING_ENV_VARS: \"MISSING_ENV_VARS\",\r\n\r\n  // File system errors\r\n  LOCAL_FILE_ERROR: \"LOCAL_FILE_ERROR\",\r\n\r\n  // Parsing errors\r\n  PARSE_ERROR: \"PARSE_ERROR\",\r\n  VALIDATION_ERROR: \"VALIDATION_ERROR\",\r\n\r\n  // Generic errors\r\n  UNKNOWN_ERROR: \"UNKNOWN_ERROR\",\r\n} as const\r\n\r\nexport type RegistryErrorCode =\r\n  (typeof RegistryErrorCode)[keyof typeof RegistryErrorCode]\r\n\r\nexport class RegistryError extends Error {\r\n  public readonly code: RegistryErrorCode\r\n  public readonly statusCode?: number\r\n  public readonly context?: Record<string, unknown>\r\n  public readonly suggestion?: string\r\n  public readonly timestamp: Date\r\n  public readonly cause?: unknown\r\n\r\n  constructor(\r\n    message: string,\r\n    options: {\r\n      code?: RegistryErrorCode\r\n      statusCode?: number\r\n      cause?: unknown\r\n      context?: Record<string, unknown>\r\n      suggestion?: string\r\n    } = {}\r\n  ) {\r\n    super(message)\r\n    this.name = \"RegistryError\"\r\n    this.code = options.code || RegistryErrorCode.UNKNOWN_ERROR\r\n    this.statusCode = options.statusCode\r\n    this.cause = options.cause\r\n    this.context = options.context\r\n    this.suggestion = options.suggestion\r\n    this.timestamp = new Date()\r\n\r\n    if (Error.captureStackTrace) {\r\n      Error.captureStackTrace(this, this.constructor)\r\n    }\r\n  }\r\n\r\n  toJSON() {\r\n    return {\r\n      name: this.name,\r\n      message: this.message,\r\n      code: this.code,\r\n      statusCode: this.statusCode,\r\n      context: this.context,\r\n      suggestion: this.suggestion,\r\n      timestamp: this.timestamp,\r\n      stack: this.stack,\r\n    }\r\n  }\r\n}\r\n\r\nexport class RegistryNotFoundError extends RegistryError {\r\n  constructor(public readonly url: string, cause?: unknown) {\r\n    const message = `The item at ${url} was not found. It may not exist at the registry.`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.NOT_FOUND,\r\n      statusCode: 404,\r\n      cause,\r\n      context: { url },\r\n      suggestion:\r\n        \"Check if the item name is correct and the registry URL is accessible.\",\r\n    })\r\n    this.name = \"RegistryNotFoundError\"\r\n  }\r\n}\r\n\r\nexport class RegistryUnauthorizedError extends RegistryError {\r\n  constructor(public readonly url: string, cause?: unknown) {\r\n    const message = `You are not authorized to access the item at ${url}. If this is a remote registry, you may need to authenticate.`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.UNAUTHORIZED,\r\n      statusCode: 401,\r\n      cause,\r\n      context: { url },\r\n      suggestion:\r\n        \"Check your authentication credentials and environment variables.\",\r\n    })\r\n    this.name = \"RegistryUnauthorizedError\"\r\n  }\r\n}\r\n\r\nexport class RegistryForbiddenError extends RegistryError {\r\n  constructor(public readonly url: string, cause?: unknown) {\r\n    const message = `You are not authorized to access the item at ${url}. If this is a remote registry, you may need to authenticate.`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.FORBIDDEN,\r\n      statusCode: 403,\r\n      cause,\r\n      context: { url },\r\n      suggestion:\r\n        \"Check your authentication credentials and environment variables.\",\r\n    })\r\n    this.name = \"RegistryForbiddenError\"\r\n  }\r\n}\r\n\r\nexport class RegistryFetchError extends RegistryError {\r\n  constructor(\r\n    public readonly url: string,\r\n    statusCode?: number,\r\n    public readonly responseBody?: string,\r\n    cause?: unknown\r\n  ) {\r\n    // Use the error detail from the server if available\r\n    const baseMessage = statusCode\r\n      ? `Failed to fetch from registry (${statusCode}): ${url}`\r\n      : `Failed to fetch from registry: ${url}`\r\n\r\n    const message =\r\n      typeof cause === \"string\" && cause\r\n        ? `${baseMessage} - ${cause}`\r\n        : baseMessage\r\n\r\n    let suggestion = \"Check your network connection and try again.\"\r\n    if (statusCode === 404) {\r\n      suggestion =\r\n        \"The requested resource was not found. Check the URL or item name.\"\r\n    } else if (statusCode === 500) {\r\n      suggestion = \"The registry server encountered an error. Try again later.\"\r\n    } else if (statusCode && statusCode >= 400 && statusCode < 500) {\r\n      suggestion = \"There was a client error. Check your request parameters.\"\r\n    }\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.FETCH_ERROR,\r\n      statusCode,\r\n      cause,\r\n      context: { url, responseBody },\r\n      suggestion,\r\n    })\r\n    this.name = \"RegistryFetchError\"\r\n  }\r\n}\r\n\r\nexport class RegistryNotConfiguredError extends RegistryError {\r\n  constructor(public readonly registryName: string | null) {\r\n    const message = registryName\r\n      ? `Unknown registry \"${registryName}\". Make sure it is defined in components.json as follows:\r\n{\r\n  \"registries\": {\r\n    \"${registryName}\": \"[URL_TO_REGISTRY]\"\r\n  }\r\n}`\r\n      : `Unknown registry. Make sure it is defined in components.json under \"registries\".`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.NOT_CONFIGURED,\r\n      context: { registryName },\r\n      suggestion:\r\n        \"Add the registry configuration to your components.json file. Consult the registry documentation for the correct format.\",\r\n    })\r\n    this.name = \"RegistryNotConfiguredError\"\r\n  }\r\n}\r\n\r\nexport class RegistryLocalFileError extends RegistryError {\r\n  constructor(public readonly filePath: string, cause?: unknown) {\r\n    super(`Failed to read local registry file: ${filePath}`, {\r\n      code: RegistryErrorCode.LOCAL_FILE_ERROR,\r\n      cause,\r\n      context: { filePath },\r\n      suggestion: \"Check if the file exists and you have read permissions.\",\r\n    })\r\n    this.name = \"RegistryLocalFileError\"\r\n  }\r\n}\r\n\r\nexport class RegistryParseError extends RegistryError {\r\n  public readonly parseError: unknown\r\n\r\n  constructor(public readonly item: string, parseError: unknown) {\r\n    let message = `Failed to parse registry item: ${item}`\r\n\r\n    if (parseError instanceof z.ZodError) {\r\n      message = `Failed to parse registry item: ${item}\\n${parseError.errors\r\n        .map((e) => `  - ${e.path.join(\".\")}: ${e.message}`)\r\n        .join(\"\\n\")}`\r\n    }\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.PARSE_ERROR,\r\n      cause: parseError,\r\n      context: { item },\r\n      suggestion:\r\n        \"The registry item may be corrupted or have an invalid format. Please make sure it returns a valid JSON object. See https://ui.aodesu.com/schema/registry-item.json.\",\r\n    })\r\n\r\n    this.parseError = parseError\r\n    this.name = \"RegistryParseError\"\r\n  }\r\n}\r\n\r\nexport class RegistryMissingEnvironmentVariablesError extends RegistryError {\r\n  constructor(\r\n    public readonly registryName: string,\r\n    public readonly missingVars: string[]\r\n  ) {\r\n    const message =\r\n      `Registry \"${registryName}\" requires the following environment variables:\\n\\n` +\r\n      missingVars.map((v) => `   ${v}`).join(\"\\n\")\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.MISSING_ENV_VARS,\r\n      context: { registryName, missingVars },\r\n      suggestion:\r\n        \"Set the required environment variables to your .env or .env.local file.\",\r\n    })\r\n    this.name = \"RegistryMissingEnvironmentVariablesError\"\r\n  }\r\n}\r\n\r\nexport class RegistryInvalidNamespaceError extends RegistryError {\r\n  constructor(public readonly name: string) {\r\n    const message = `Invalid registry namespace: \"${name}\". Registry names must start with @ (e.g., @aodesu, @v0).`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.VALIDATION_ERROR,\r\n      context: { name },\r\n      suggestion:\r\n        \"Use a valid registry name starting with @ or provide a direct URL to the registry.\",\r\n    })\r\n    this.name = \"RegistryInvalidNamespaceError\"\r\n  }\r\n}\r\n\r\nexport class ConfigMissingError extends RegistryError {\r\n  constructor(public readonly cwd: string) {\r\n    const message = `No components.json found in ${cwd} or parent directories.`\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.NOT_CONFIGURED,\r\n      context: { cwd },\r\n      suggestion:\r\n        \"Run 'npx aodesu@latest init' to create a components.json file, or check that you're in the correct directory.\",\r\n    })\r\n    this.name = \"ConfigMissingError\"\r\n  }\r\n}\r\n\r\nexport class ConfigParseError extends RegistryError {\r\n  constructor(public readonly cwd: string, parseError: unknown) {\r\n    let message = `Invalid components.json configuration in ${cwd}.`\r\n\r\n    if (parseError instanceof z.ZodError) {\r\n      message = `Invalid components.json configuration in ${cwd}:\\n${parseError.errors\r\n        .map((e) => `  - ${e.path.join(\".\")}: ${e.message}`)\r\n        .join(\"\\n\")}`\r\n    }\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.INVALID_CONFIG,\r\n      cause: parseError,\r\n      context: { cwd },\r\n      suggestion:\r\n        \"Check your components.json file for syntax errors or invalid configuration. Run 'npx aodesu@latest init' to regenerate a valid configuration.\",\r\n    })\r\n    this.name = \"ConfigParseError\"\r\n  }\r\n}\r\n\r\nexport class RegistriesIndexParseError extends RegistryError {\r\n  public readonly parseError: unknown\r\n\r\n  constructor(parseError: unknown) {\r\n    let message = \"Failed to parse registries index\"\r\n\r\n    if (parseError instanceof z.ZodError) {\r\n      const invalidNamespaces = parseError.errors\r\n        .filter((e) => e.path.length > 0)\r\n        .map((e) => `\"${e.path[0]}\"`)\r\n        .filter((v, i, arr) => arr.indexOf(v) === i) // remove duplicates\r\n\r\n      if (invalidNamespaces.length > 0) {\r\n        message = `Failed to parse registries index. Invalid registry namespace(s): ${invalidNamespaces.join(\r\n          \", \"\r\n        )}\\n${parseError.errors\r\n          .map((e) => `  - ${e.path.join(\".\")}: ${e.message}`)\r\n          .join(\"\\n\")}`\r\n      } else {\r\n        message = `Failed to parse registries index:\\n${parseError.errors\r\n          .map((e) => `  - ${e.path.join(\".\")}: ${e.message}`)\r\n          .join(\"\\n\")}`\r\n      }\r\n    }\r\n\r\n    super(message, {\r\n      code: RegistryErrorCode.PARSE_ERROR,\r\n      cause: parseError,\r\n      context: { parseError },\r\n      suggestion:\r\n        \"The registries index may be corrupted or have invalid registry namespace format. Registry names must start with @ (e.g., @aodesu, @example).\",\r\n    })\r\n\r\n    this.parseError = parseError\r\n    this.name = \"RegistriesIndexParseError\"\r\n  }\r\n}\r\n","import z from \"zod\";\r\nimport { RegistryError } from \"../registry/errors\";\r\nimport { highlighter } from \"./highlighter\";\r\nimport { logger } from \"./logger\";\r\n\r\nexport function handleError(error: unknown) {\r\n  logger.break();\r\n  logger.error(\"Something went wrong. Please check the error below for more details.\");\r\n  logger.error(\"If the problem persist, please open an issue on GitHub.\");\r\n  logger.error(\"\");\r\n\r\n  if (typeof error === \"string\") {\r\n    logger.error(error);\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  if (error instanceof RegistryError) {\r\n    if (error.message) {\r\n      logger.error(error.cause ? \"Error\" : \"Message:\");\r\n      logger.error(error.message);\r\n    }\r\n\r\n    if (error.cause) {\r\n      logger.error(\"\\nMessage:\");\r\n      logger.error(error.cause);\r\n    }\r\n\r\n    if (error.suggestion) {\r\n      logger.error(\"\\nSuggestion:\");\r\n      logger.error(error.suggestion);\r\n    }\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  if (error instanceof z.ZodError) {\r\n    logger.error(\"Validation failed:\");\r\n    for (const [key, value] of Object.entries(error.flatten().fieldErrors)) {\r\n      logger.error(`- ${highlighter.info(key)}: ${value}`);\r\n    }\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  if (error instanceof Error) {\r\n    logger.error(error.message);\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  logger.break();\r\n  process.exit(1);\r\n}\r\n","import ora, { type Options } from \"ora\";\r\n\r\nexport function spinner(\r\n  text: Options[\"text\"],\r\n  options?: {\r\n    silent?: boolean\r\n  }\r\n) {\r\n  return ora({\r\n    text,\r\n    isSilent: options?.silent,\r\n  });\r\n}\r\n","import { Command } from \"commander\";\r\nimport * as fs from \"fs/promises\";\r\nimport * as path from \"path\";\r\nimport z from \"zod\";\r\nimport { preFlightBuild } from \"../preflights/preflight-build\";\r\nimport { registryItemSchema, registrySchema } from \"../schema\";\r\nimport { handleError } from \"../utils/handle-error\";\r\nimport { highlighter } from \"../utils/highlighter\";\r\nimport { logger } from \"../utils/logger\";\r\nimport { spinner } from \"../utils/spinner\";\r\n\r\nexport const buildOptionsSchema = z.object({\r\n  cwd: z.string(),\r\n  registryFile: z.string(),\r\n  outputDir: z.string(),\r\n});\r\n\r\nexport const build = new Command()\r\n  .name(\"build\")\r\n  .description(\"build components for a aodesu registry\")\r\n  .argument(\"[registry]\", \"path to registry.json file\", \"./registry.json\")\r\n  .option(\r\n    \"-o, --output <path>\",\r\n    \"destination directory for json files\",\r\n    \"./public/r\"\r\n  )\r\n  .option(\r\n    \"-c, --cwd <cwd>\",\r\n    \"the working directory. defaults to the current directory.\",\r\n    process.cwd()\r\n  )\r\n  .action(async (registry: string, opts) => {\r\n    try {\r\n      const options = buildOptionsSchema.parse({\r\n        cwd: path.resolve(opts.cwd),\r\n        registryFile: registry,\r\n        outputDir: opts.output,\r\n      });\r\n\r\n      const { resolvePaths } = await preFlightBuild(options);\r\n      const content = await fs.readFile(resolvePaths.registryFile, \"utf-8\");\r\n\r\n      const result = registrySchema.safeParse(JSON.parse(content));\r\n\r\n      if (!result.success) {\r\n        logger.error(\r\n          `Invalid registry file found at ${highlighter.info(\r\n            resolvePaths.registryFile\r\n          )}.`\r\n        );\r\n        process.exit(1);\r\n      }\r\n\r\n      const buildSpinner = spinner(\"Building registry...\");\r\n      for (const registryItem of result.data.items) {\r\n        buildSpinner.start(`Building ${registryItem.name}...`);\r\n\r\n        // Add the schema to the registry item.\r\n        registryItem[\"$schema\"] =\r\n          \"https://ui.aodesu.com/schema/registry-item.json\";\r\n\r\n        // Loop through each file in the files array.\r\n        for (const file of registryItem.files ?? []) {\r\n          file[\"content\"] = await fs.readFile(\r\n            path.resolve(resolvePaths.cwd, file.path),\r\n            \"utf-8\"\r\n          );\r\n        };\r\n\r\n        // Validate the registry item.\r\n        const result = registryItemSchema.safeParse(registryItem);\r\n        if (!result.success) {\r\n          logger.error(\r\n            `Invalid registry item found for ${highlighter.info(\r\n              registryItem.name\r\n            )}.`\r\n          );\r\n          continue;\r\n        }\r\n\r\n        logger.info(`Registry item found for ${registryItem.name}`)\r\n\r\n        // Write the registry item to the output directory.\r\n        await fs.writeFile(\r\n          path.resolve(resolvePaths.outputDir, `${result.data.name}.json`),\r\n          JSON.stringify(result.data, null, 2)\r\n        );\r\n      }\r\n\r\n      // Copy registry.json to the output directory.\r\n      await fs.copyFile(\r\n        resolvePaths.registryFile,\r\n        path.resolve(resolvePaths.outputDir, \"registry.json\")\r\n      );\r\n\r\n      buildSpinner.succeed(\"Building registry.\");\r\n    } catch (error) {\r\n      logger.break();\r\n      handleError(error);\r\n    }\r\n  });\r\n","export const FRAMEWORKS = {\r\n  \"next-app\": {\r\n    name: \"next-app\",\r\n    label: \"Next.js\",\r\n    links: {\r\n      installation: \"https://ui.aodesu.com/docs/installation/next\",\r\n      tailwind: \"https://tailwindcss.com/docs/guides/nextjs\",\r\n    },\r\n  },\r\n  \"next-pages\": {\r\n    name: \"next-pages\",\r\n    label: \"Next.js\",\r\n    links: {\r\n      installation: \"https://ui.aodesu.com/docs/installation/next\",\r\n      tailwind: \"https://tailwindcss.com/docs/guides/nextjs\",\r\n    },\r\n  },\r\n  vite: {\r\n    name: \"vite\",\r\n    label: \"vite\",\r\n    links: {\r\n      installation: \"https://ui.aodesu.com/docs/installation/vite\",\r\n      tailwind: \"https://tailwindcss.com/docs/guides/vite\",\r\n    },\r\n  },\r\n  manual: {\r\n    name: \"manual\",\r\n    label: \"Manual\",\r\n    links: {\r\n      installation: \"https://ui.aodesu.com/docs/installation/manual\",\r\n      tailwind: \"https://tailwindcss.com/docs/installation\",\r\n    },\r\n  },\r\n} as const;\r\n\r\nexport type Framework = (typeof FRAMEWORKS)[keyof typeof FRAMEWORKS];\r\n","import z from \"zod\";\r\nimport { registryConfigSchema } from \"./schema\";\r\n\r\nexport const REGISTRY_URL =\r\n  process.env.REGISTRY_URL ?? \"https://ui.aodesu.com/r\";\r\n\r\nexport const FALLBACK_STYLE = \"aodesu\";\r\n\r\nexport const BASE_COLORS = [\r\n  {\r\n    name: \"neutral\",\r\n    label: \"Neutral\"\r\n  }\r\n]\r\n\r\nexport const BUILTIN_REGISTRIES: z.infer<typeof registryConfigSchema> = {\r\n  \"@uidesu\": `${REGISTRY_URL}/styles/{style}/{name}.json`,\r\n}\r\n","import { createMatchPath, type ConfigLoaderSuccessResult } from \"tsconfig-paths\";\r\n\r\nexport async function resolveImport(\r\n  importPath: string,\r\n  config: Pick<ConfigLoaderSuccessResult, \"absoluteBaseUrl\" | \"paths\">\r\n) {\r\n  return createMatchPath(config.absoluteBaseUrl, config.paths)(\r\n    importPath,\r\n    undefined,\r\n    () => true,\r\n    [\".ts\", \".tsx\", \".jsx\", \".js\", \".css\"]\r\n  )\r\n}\r\n","import { cosmiconfig } from \"cosmiconfig\";\r\nimport path from \"path\";\r\nimport { loadConfig } from \"tsconfig-paths\";\r\nimport z from \"zod\";\r\nimport { BUILTIN_REGISTRIES } from \"../registry/constants\";\r\nimport { configSchema, rawConfigSchema } from \"../schema\";\r\nimport { highlighter } from \"./highlighter\";\r\nimport { resolveImport } from \"./resolve-import\";\r\n\r\n// TODO: Figure out if we want to support all cosmiconfig formats.\r\n// A simple components.json file would be nice.\r\nexport const explorer = cosmiconfig(\"components\", {\r\n  searchPlaces: [\"components.json\"]\r\n});\r\n\r\nexport type Config = z.infer<typeof configSchema>\r\n\r\nexport async function getConfig(cwd: string) {\r\n  const config = await getRawConfig(cwd);\r\n\r\n  if (!config) {\r\n    return null;\r\n  }\r\n\r\n  // Set default icon library if not provided.\r\n  if (!config.iconLibrary) {\r\n    config.iconLibrary = config.style === \"aodesu\" ? \"radix\" : \"lucide\";\r\n  }\r\n\r\n  return await resolveConfigPaths(cwd, config);\r\n}\r\n\r\nexport async function resolveConfigPaths(\r\n  cwd: string,\r\n  config: z.infer<typeof rawConfigSchema>\r\n) {\r\n  // Merge built-in registries with user registries\r\n  config.registries = {\r\n    ...BUILTIN_REGISTRIES,\r\n    ...(config.registries || {}),\r\n  };\r\n\r\n  // Read tsconfig.json\r\n  const tsConfig = await loadConfig(cwd);\r\n\r\n  if (tsConfig.resultType === \"failed\") {\r\n    throw new Error(\r\n      `Failed to load ${config.tsx ? \"tsconfig\" : \"jsconfig\"}.json ${\r\n        tsConfig.message ?? \"\"\r\n      }`.trim()\r\n    );\r\n  }\r\n\r\n  return configSchema.parse({\r\n    ...config,\r\n    resolvedPaths: {\r\n      cwd,\r\n      tailwindConfig: config.tailwind.config\r\n        ? path.resolve(cwd, config.tailwind.config)\r\n        : \"\",\r\n      tailwindCss: path.resolve(cwd, config.tailwind.css),\r\n      utils: await resolveImport(config.aliases[\"utils\"], tsConfig),\r\n      components: await resolveImport(config.aliases[\"components\"], tsConfig),\r\n      ui: config.aliases[\"ui\"]\r\n        ? await resolveImport(config.aliases[\"ui\"], tsConfig)\r\n        : path.resolve(\r\n          (await resolveImport(config.aliases[\"components\"], tsConfig)) ??\r\n          cwd,\r\n          \"ui\"\r\n        ),\r\n      // TODO: Make this configurable\r\n      // For now, we assume the lib and hooks directories are one level up from the components directory.\r\n      lib: config.aliases[\"lib\"]\r\n        ? await resolveImport(config.aliases[\"lib\"], tsConfig)\r\n        : path.resolve(\r\n          (await resolveImport(config.aliases[\"utils\"], tsConfig)) ?? cwd,\r\n          \"..\"\r\n        ),\r\n      hooks: config.aliases[\"hooks\"]\r\n        ? await resolveImport(config.aliases[\"hooks\"], tsConfig)\r\n        : path.resolve(\r\n          (await resolveImport(config.aliases[\"components\"], tsConfig)) ??\r\n            cwd,\r\n          \"..\",\r\n          \"hooks\"\r\n        ),\r\n    },\r\n  })\r\n};\r\n\r\nexport async function getRawConfig(\r\n  cwd: string\r\n): Promise<z.infer<typeof rawConfigSchema> | null> {\r\n  try {\r\n    const configResult = await explorer.search(cwd);\r\n\r\n    if (!configResult) {\r\n      return null;\r\n    }\r\n\r\n    const config = rawConfigSchema.parse(configResult.config);\r\n\r\n    // Check if user is trying to override built-in registries\r\n    if (config.registries) {\r\n      for (const registryName of Object.keys(config.registries)) {\r\n        if (registryName in BUILTIN_REGISTRIES) {\r\n          throw new Error(\r\n            `\"${registryName}\" is a built-in registry and cannot be overriden.`\r\n          )\r\n        }\r\n      }\r\n    }\r\n\r\n    return config;\r\n  } catch (error) {\r\n    const componentPath = `${cwd}/components.json`;\r\n    if (error instanceof Error && error.message.includes(\"reserved registry\")) {\r\n      throw error;\r\n    }\r\n    throw new Error(\r\n      `Invalid configuration found in ${highlighter.info(componentPath)}`\r\n    );\r\n  }\r\n}\r\n\r\ntype DeepPartial<T> = {\r\n  [P in keyof T]?: T[P] extends object ? DeepPartial<T[P]> : T[P]\r\n}\r\n\r\nexport function createConfig(partial?: DeepPartial<Config>): Config {\r\n  const defaultConfig: Config = {\r\n    resolvedPaths: {\r\n      cwd: process.cwd(),\r\n      tailwindConfig: \"\",\r\n      tailwindCss: \"\",\r\n      utils: \"\",\r\n      components: \"\",\r\n      ui: \"\",\r\n      lib: \"\",\r\n      hooks: \"\",\r\n    },\r\n    style: \"\",\r\n    tailwind: {\r\n      config: \"\",\r\n      css: \"\",\r\n      baseColor: \"\",\r\n      cssVariables: false,\r\n    },\r\n    rsc: false,\r\n    tsx: true,\r\n    aliases: {\r\n      components: \"\",\r\n      utils: \"\",\r\n    },\r\n    registries: {\r\n      ...BUILTIN_REGISTRIES,\r\n    },\r\n  }\r\n\r\n  // Deep merge the partial config with defaults\r\n  if (partial) {\r\n    return {\r\n      ...defaultConfig,\r\n      ...partial,\r\n      resolvedPaths: {\r\n        ...defaultConfig.resolvedPaths,\r\n        ...(partial.resolvedPaths|| {}),\r\n      },\r\n      tailwind: {\r\n        ...defaultConfig.tailwind,\r\n        ...(partial.tailwind || {}),\r\n      },\r\n      aliases: {\r\n        ...defaultConfig.aliases,\r\n        ...(partial.aliases || {}),\r\n      },\r\n      registries: {\r\n        ...defaultConfig.registries,\r\n        ...(partial.registries || {}),\r\n      },\r\n    }\r\n  }\r\n\r\n  return defaultConfig;\r\n}\r\n","import fs from \"fs-extra\";\r\nimport path from \"path\";\r\nimport { type PackageJson } from \"type-fest\";\r\n\r\nexport function getPackageInfo(\r\n  cwd: string = \"\",\r\n  shouldThrow: boolean = true\r\n): PackageJson | null {\r\n  const packageJsonPath = path.join(cwd, \"package.json\");\r\n\r\n  return fs.readJSONSync(packageJsonPath, {\r\n    throws: shouldThrow,\r\n  }) as PackageJson;\r\n}\r\n","import { Framework, FRAMEWORKS } from \"@/src/utils/frameworks\";\r\nimport { Config, getConfig, resolveConfigPaths } from \"@/src/utils/get-config\";\r\nimport { getPackageInfo } from \"@/src/utils/get-package-info\";\r\nimport fg from \"fast-glob\";\r\nimport fs from \"fs-extra\";\r\nimport path from \"path\";\r\nimport { loadConfig } from \"tsconfig-paths\";\r\nimport { z } from \"zod\";\r\nimport { rawConfigSchema } from \"../schema\";\r\n\r\nexport type TailwindVersion = \"v3\" | \"v4\" | null;\r\n\r\nexport type ProjectInfo = {\r\n  framework: Framework;\r\n  isSrcDir: boolean;\r\n  isRSC: boolean;\r\n  isTsx: boolean;\r\n  tailwindConfigFile: string | null;\r\n  tailwindCssFile: string | null;\r\n  tailwindVersion: TailwindVersion;\r\n  frameworkVersion: string | null;\r\n  aliasPrefix: string | null;\r\n}\r\n\r\nconst PROJECT_SHARED_IGNORE = [\r\n  \"**/node_modules/**\",\r\n  \".next\",\r\n  \"public\",\r\n  \"dist\",\r\n  \"build\",\r\n];\r\n\r\nconst TS_CONFIG_SCHEMA = z.object({\r\n  compilerOptions: z.object({\r\n    paths: z.record(z.string().or(z.array(z.string()))),\r\n  }),\r\n});\r\n\r\nexport async function getProjectInfo(cwd: string): Promise<ProjectInfo | null> {\r\n  const [\r\n    configFiles,\r\n    isSrcDir,\r\n    isTsx,\r\n    tailwindConfigFile,\r\n    tailwindCssFile,\r\n    tailwindVersion,\r\n    aliasPrefix,\r\n    packageJson,\r\n  ] = await Promise.all([\r\n    fg.glob(\r\n      \"**/{vite,app,next}.config.*|gatsby-config.*|composer.json|react-router.config.*\",\r\n      {\r\n        cwd,\r\n        deep: 3,\r\n        ignore: PROJECT_SHARED_IGNORE,\r\n      }\r\n    ),\r\n    fs.pathExists(path.resolve(cwd, \"src\")),\r\n    isTypeScriptProject(cwd),\r\n    getTailwindConfigFile(cwd),\r\n    getTailwindCssFile(cwd),\r\n    getTailwindVersion(cwd),\r\n    getTsConfigAliasPrefix(cwd),\r\n    getPackageInfo(cwd, false),\r\n  ]);\r\n\r\n  const isUsingAppDir = await fs.pathExists(\r\n    path.resolve(cwd, `${isSrcDir ? \"src/\" : \"\"}app`)\r\n  );\r\n\r\n  const type: ProjectInfo = {\r\n    framework: FRAMEWORKS[\"manual\"],\r\n    isSrcDir,\r\n    isRSC: false,\r\n    isTsx,\r\n    tailwindConfigFile,\r\n    tailwindCssFile,\r\n    tailwindVersion,\r\n    frameworkVersion: null,\r\n    aliasPrefix,\r\n  }\r\n\r\n  // Next.js.\r\n  if (configFiles.find((file) => file.startsWith(\"next.config.\"))?.length) {\r\n    type.framework = isUsingAppDir\r\n      ? FRAMEWORKS[\"next-app\"]\r\n      : FRAMEWORKS[\"next-pages\"];\r\n    type.isRSC = isUsingAppDir;\r\n    type.frameworkVersion = await getFrameworkVersion(\r\n      type.framework,\r\n      packageJson\r\n    );\r\n    return type;\r\n  }\r\n\r\n  // Vite.\r\n  if (configFiles.find((file) => file.startsWith(\"vite.config.\"))?.length) {\r\n    type.framework = FRAMEWORKS[\"vite\"];\r\n    return type;\r\n  }\r\n\r\n  return type;\r\n};\r\n\r\nexport async function getFrameworkVersion(\r\n  framework: Framework,\r\n  packageJson: ReturnType<typeof getPackageInfo>\r\n) {\r\n  if (!packageJson) {\r\n    return null;\r\n  }\r\n\r\n  // Only detect Next.js version for now.\r\n  if (![\"next-app\", \"next-pages\"].includes(framework.name)) {\r\n    return null;\r\n  }\r\n\r\n  const version =\r\n    packageJson.dependencies?.next || packageJson.devDependencies?.next;\r\n\r\n  if (!version) {\r\n    return null;\r\n  }\r\n\r\n  // Extract full semver (major.minor.patch), handling ^, ~, etc.\r\n  const versionMatch = version.match(/^[\\^~]?(\\d+\\.\\d+\\.\\d+)/)\r\n  if (versionMatch) {\r\n    return versionMatch[1] // e.g., \"16.0.0\"\r\n  }\r\n\r\n  // For ranges like \">=15.0.0 <16.0.0\", extract the first version.\r\n  const rangeMatch = version.match(/(\\d+\\.\\d+\\.\\d+)/)\r\n  if (rangeMatch) {\r\n    return rangeMatch[1]\r\n  }\r\n\r\n  // For \"latest\", \"canary\", \"rc\", etc., return the tag as-is.\r\n  return version\r\n}\r\n\r\nexport async function getTailwindVersion(\r\n  cwd: string\r\n): Promise<ProjectInfo[\"tailwindVersion\"]> {\r\n  const [packageInfo, config] = await Promise.all([\r\n    getPackageInfo(cwd, false),\r\n    getConfig(cwd),\r\n  ]);\r\n\r\n  // If the config file is empty, we can assume that it's a v4 project\r\n  if (config?.tailwind?.config === \"\") {\r\n    return \"v4\";\r\n  }\r\n\r\n  if (\r\n    !packageInfo?.dependencies?.tailwindcss &&\r\n    !packageInfo?.devDependencies?.tailwindcss\r\n  ) {\r\n    return null;\r\n  }\r\n\r\n  if (\r\n    /^(?:\\^|~)?3(?:\\.\\d+)*(?:-.*)?$/.test(\r\n      packageInfo?.dependencies?.tailwindcss ||\r\n        packageInfo?.devDependencies?.tailwindcss ||\r\n        \"\"\r\n    )\r\n  ) {\r\n    return \"v3\"\r\n  }\r\n\r\n  return \"v4\"\r\n}\r\n\r\nexport async function getTailwindCssFile(cwd: string) {\r\n  const [files, tailwindVersion] = await Promise.all([\r\n    fg.glob([\"**/*.css\", \"**/*.scss\"], {\r\n      cwd,\r\n      deep: 5,\r\n      ignore: PROJECT_SHARED_IGNORE,\r\n    }),\r\n    getTailwindVersion(cwd),\r\n  ]);\r\n\r\n  if (!files.length) {\r\n    return null;\r\n  }\r\n\r\n  for (const file of files) {\r\n    const contents = await fs.readFile(path.resolve(cwd, file), \"utf8\");\r\n    if (\r\n      contents.includes(`@import \"tailwindcss\"`) ||\r\n      contents.includes(`@import 'tailwindcss'`) ||\r\n      contents.includes(`@tailwind base`)\r\n    ) {\r\n      return file;\r\n    }\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\nexport async function getTailwindConfigFile(cwd: string) {\r\n  const files = await fg.glob(\"tailwind.config.*\", {\r\n    cwd,\r\n    deep: 3,\r\n    ignore: PROJECT_SHARED_IGNORE,\r\n  });\r\n\r\n  if (!files.length) {\r\n    return null;\r\n  }\r\n\r\n  return files[0];\r\n}\r\n\r\nexport async function getTsConfigAliasPrefix(cwd: string) {\r\n  const tsConfig = await loadConfig(cwd);\r\n\r\n  if (\r\n    tsConfig?.resultType === \"failed\" ||\r\n    !Object.entries(tsConfig?.paths).length\r\n  ) {\r\n    return null;\r\n  }\r\n\r\n  // This assume that the first alias is the prefix.\r\n  for (const [alias, paths] of Object.entries(tsConfig.paths)) {\r\n    if (\r\n      paths.includes(\"./*\") ||\r\n      paths.includes(\"./src/*\") ||\r\n      paths.includes(\"./app/*\") ||\r\n      paths.includes(\"./resources/js/*\") // Laravel.\r\n    ) {\r\n      return alias.replace(/\\/\\*$/, \"\") ?? null\r\n    }\r\n  }\r\n\r\n  // Use the first alias as the prefix.\r\n  return Object.keys(tsConfig?.paths)?.[0].replace(/\\/\\*$/, \"\") ?? null;\r\n}\r\n\r\nexport async function isTypeScriptProject(cwd: string) {\r\n  const files = await fg.glob(\"tsconfig.*\", {\r\n    cwd,\r\n    deep: 1,\r\n    ignore: PROJECT_SHARED_IGNORE,\r\n  });\r\n\r\n  return files.length > 0;\r\n}\r\n\r\nexport async function getProjectConfig(\r\n  cwd: string,\r\n  defaultProjectInfo: ProjectInfo | null = null\r\n): Promise<Config | null> {\r\n  // Check for existing component file.\r\n  const [existingConfig, projectInfo] = await Promise.all([\r\n    getConfig(cwd),\r\n    !defaultProjectInfo\r\n      ? getProjectInfo(cwd)\r\n      : Promise.resolve(defaultProjectInfo)\r\n  ]);\r\n\r\n  if (existingConfig) {\r\n    return existingConfig;\r\n  }\r\n\r\n  if(\r\n    !projectInfo ||\r\n    !projectInfo.tailwindCssFile ||\r\n    (projectInfo.tailwindVersion === \"v3\" && !projectInfo.tailwindConfigFile)\r\n  ) {\r\n    return null;\r\n  }\r\n\r\n  const config: z.infer<typeof rawConfigSchema> = {\r\n    $schema: \"https://ui.aodesu.com/schema.json\",\r\n    rsc: projectInfo.isRSC,\r\n    tsx: projectInfo.isTsx,\r\n    style: \"aodesu\",\r\n    tailwind: {\r\n      config: projectInfo.tailwindConfigFile ?? \"\",\r\n      baseColor: \"zinc\",\r\n      css: projectInfo.tailwindCssFile,\r\n      cssVariables: true,\r\n      prefix: \"\",\r\n    },\r\n    iconLibrary: \"lucide\",\r\n    aliases: {\r\n      components: `${projectInfo.aliasPrefix}/components`,\r\n      ui: `${projectInfo.aliasPrefix}/components/ui`,\r\n      hooks: `${projectInfo.aliasPrefix}/hooks`,\r\n      lib: `${projectInfo.aliasPrefix}/lib`,\r\n      utils: `${projectInfo.aliasPrefix}/lib/utils`,\r\n    },\r\n  }\r\n\r\n  return await resolveConfigPaths(cwd, config)\r\n}\r\n\r\nexport async function getProjectTailwindVersionFromConfig(config: {\r\n  resolvedPaths: Pick<Config[\"resolvedPaths\"], \"cwd\">\r\n}): Promise<TailwindVersion> {\r\n  if (!config.resolvedPaths?.cwd) {\r\n    return \"v3\";\r\n  }\r\n\r\n  const projectInfo = await getProjectInfo(config.resolvedPaths.cwd);\r\n\r\n  if (!projectInfo?.tailwindVersion) {\r\n    return null;\r\n  }\r\n\r\n  return projectInfo.tailwindVersion;\r\n}\r\n","import { initOptionsSchema } from \"@/src/commands/init\";\r\nimport * as ERRORS from \"@/src/utils/errors\";\r\nimport { getProjectInfo } from \"@/src/utils/get-project-info\";\r\nimport { highlighter } from \"@/src/utils/highlighter\";\r\nimport { logger } from \"@/src/utils/logger\";\r\nimport { spinner } from \"@/src/utils/spinner\";\r\nimport fs from \"fs-extra\";\r\nimport path from \"path\";\r\nimport { z } from \"zod\";\r\n\r\nexport async function preFlightInit(\r\n  options: z.infer<typeof initOptionsSchema>\r\n) {\r\n  const errors: Record<string, boolean> = {};\r\n\r\n  // Ensure target directory exists.\r\n  // Check for empty project. We assume if no package.json exists, the project is empty.\r\n  if (\r\n    !fs.existsSync(options.cwd) ||\r\n    !fs.existsSync(path.resolve(options.cwd, \"package.json\"))\r\n  ) {\r\n    errors[ERRORS.MISSING_DIR_OR_EMPTY_PROJECT] = true;\r\n    return {\r\n      errors,\r\n      projectInfo: null,\r\n    }\r\n  }\r\n\r\n  const projectSpinner = spinner(\"Preflight checks.\", {\r\n    silent: options.silent,\r\n  }).start()\r\n\r\n  if (\r\n    fs.existsSync(path.resolve(options.cwd, \"components.json\")) &&\r\n    !options.force\r\n  ) {\r\n    projectSpinner?.fail();\r\n    logger.break();\r\n    logger.error(\r\n      `A ${highlighter.info(\r\n        \"components.json\"\r\n      )} file already exist at ${highlighter.info(\r\n        options.cwd\r\n      )}. \\nTo start over, remove the ${highlighter.info(\r\n        \"components.json\"\r\n      )} file and run ${highlighter.info(\"init\")} again.`\r\n    );\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n\r\n  projectSpinner?.succeed();\r\n\r\n  const frameworkSpinner = spinner(\"Verifying framework.\", {\r\n    silent: options.silent,\r\n  }).start();\r\n  const projectInfo = await getProjectInfo(options.cwd);\r\n  if (!projectInfo || projectInfo?.framework.name === \"manual\") {\r\n    errors[ERRORS.UNSUPPORTED_FRAMEWORK] = true;\r\n    frameworkSpinner?.fail();\r\n    logger.break();\r\n    if (projectInfo?.framework.links.installation) {\r\n      logger.error(\r\n        `We could not detect a supported framework at ${highlighter.info(\r\n          options.cwd\r\n        )}.\\n` +\r\n          `Visit ${highlighter.info(\r\n            projectInfo?.framework.links.installation\r\n          )} to manually configure your project. \\nOnce configured, you can use the cli to add components.`\r\n      )\r\n    }\r\n    logger.break();\r\n    process.exit(1);\r\n  }\r\n  frameworkSpinner?.succeed(\r\n    `Verifying framework. Found ${highlighter.info(\r\n      projectInfo.framework.label\r\n    )}.`\r\n  )\r\n\r\n  let tailwindSpinnerMessage = \"Validating Tailwind CSS.\";\r\n\r\n  if (projectInfo.tailwindVersion === \"v4\") {\r\n    tailwindSpinnerMessage = `Validating Tailwind CSS config. Found ${highlighter.info(\r\n      \"v4\"\r\n    )}.`\r\n  }\r\n\r\n  const tailwindSpinner = spinner(tailwindSpinnerMessage, {\r\n    silent: options.silent,\r\n  }).start();\r\n\r\n  if (\r\n    projectInfo.tailwindVersion === \"v3\" &&\r\n    (!projectInfo?.tailwindConfigFile || !projectInfo?.tailwindCssFile)\r\n  ) {\r\n    errors[ERRORS.TAILWIND_NOT_CONFIGURED] = true\r\n    tailwindSpinner?.fail()\r\n  } else if (\r\n    projectInfo.tailwindVersion === \"v4\" &&\r\n    !projectInfo?.tailwindCssFile\r\n  ) {\r\n    errors[ERRORS.TAILWIND_NOT_CONFIGURED] = true\r\n    tailwindSpinner?.fail()\r\n  } else if (!projectInfo.tailwindVersion) {\r\n    errors[ERRORS.TAILWIND_NOT_CONFIGURED] = true\r\n    tailwindSpinner?.fail()\r\n  } else {\r\n    tailwindSpinner?.succeed()\r\n  }\r\n\r\n  const tsConfigSpinner = spinner(`Validating import alias.`, {\r\n    silent: options.silent,\r\n  }).start();\r\n\r\n  if (!projectInfo?.aliasPrefix) {\r\n    errors[ERRORS.IMPORT_ALIAS_MISSING] = true\r\n    tsConfigSpinner?.fail()\r\n  } else {\r\n    tsConfigSpinner?.succeed()\r\n  }\r\n\r\n  if (Object.keys(errors).length > 0) {\r\n    if (errors[ERRORS.TAILWIND_NOT_CONFIGURED]) {\r\n      logger.break()\r\n      logger.error(\r\n        `No Tailwind CSS configuration found at ${highlighter.info(\r\n          options.cwd\r\n        )}.`\r\n      )\r\n      logger.error(\r\n        `It is likely you do not have Tailwind CSS installed or have an invalid configuration.`\r\n      )\r\n      logger.error(`Install Tailwind CSS then try again.`)\r\n      if (projectInfo?.framework.links.tailwind) {\r\n        logger.error(\r\n          `Visit ${highlighter.info(\r\n            projectInfo?.framework.links.tailwind\r\n          )} to get started.`\r\n        )\r\n      }\r\n    }\r\n\r\n    if (errors[ERRORS.IMPORT_ALIAS_MISSING]) {\r\n      logger.break()\r\n      logger.error(`No import alias found in your tsconfig.json file.`)\r\n      if (projectInfo?.framework.links.installation) {\r\n        logger.error(\r\n          `Visit ${highlighter.info(\r\n            projectInfo?.framework.links.installation\r\n          )} to learn how to set an import alias.`\r\n        )\r\n      }\r\n    }\r\n\r\n    logger.break()\r\n    process.exit(1)\r\n  }\r\n\r\n  return {\r\n    errors,\r\n    projectInfo\r\n  }\r\n}\r\n","export function expandEnvVars(value: string) {\r\n  return value.replace(/\\${(\\w+)}/g, (_match, key) => process.env[key] || \"\")\r\n}\r\n\r\nexport function extractEnvVars(value: string) {\r\n  const vars: string[] = []\r\n  const regex = /\\${(\\w+)}/g\r\n  let match: RegExpExecArray | null\r\n\r\n  while ((match = regex.exec(value)) !== null) {\r\n    vars.push(match[1])\r\n  }\r\n\r\n  return vars\r\n}\r\n","// Valid registry name pattern: @namespace where namespace is alphanumeric with hyphens/underscores\r\nconst REGISTRY_PATTERN = /^(@[a-zA-Z0-9](?:[a-zA-Z0-9-_]*[a-zA-Z0-9])?)\\/(.+)$/\r\n\r\nexport function parseRegistryAndItemFromString(name: string) {\r\n  if (!name.startsWith(\"@\")) {\r\n    return {\r\n      registry: null,\r\n      item: name,\r\n    }\r\n  }\r\n\r\n  const match = name.match(REGISTRY_PATTERN)\r\n  if (match) {\r\n    return {\r\n      registry: match[1],\r\n      item: match[2],\r\n    }\r\n  }\r\n\r\n  return {\r\n    registry: null,\r\n    item: name,\r\n  }\r\n}\r\n","export function isUrl(path: string) {\r\n  try {\r\n    new URL(path);\r\n    return true;\r\n  } catch (error) {\r\n    return false;\r\n  }\r\n}\r\n\r\nexport function isLocalFile(path: string) {\r\n  return path.endsWith(\".json\") && !isUrl(path);\r\n}\r\n","import deepmerge from \"deepmerge\";\r\nimport { Config, createConfig } from \"../utils/get-config\";\r\nimport { BUILTIN_REGISTRIES, FALLBACK_STYLE } from \"./constants\";\r\nimport { configSchema } from \"./schema\";\r\n\r\nfunction resolveStyleFromConfig(config: Partial<Config> | Config) {\r\n  if (!config.style) {\r\n    return FALLBACK_STYLE;\r\n  }\r\n\r\n  // Check if we should use aodesu for tailwind\r\n  // We assume that if tailwind.config is empty, we're using tailwind v4.\r\n  if (config.style === \"aodesu\" && config.tailwind?.config === \"\") {\r\n    return FALLBACK_STYLE;\r\n  }\r\n\r\n  return config.style;\r\n}\r\n\r\nexport function configWithDefaults(config?: Partial<Config> | Config) {\r\n  const baseConfig = createConfig({\r\n    style: FALLBACK_STYLE,\r\n    registries: BUILTIN_REGISTRIES,\r\n  });\r\n\r\n  if (!config) {\r\n    return baseConfig;\r\n  }\r\n\r\n  return configSchema.parse(\r\n    deepmerge(baseConfig, {\r\n      ...config,\r\n      style: resolveStyleFromConfig(config),\r\n      registries: { ...BUILTIN_REGISTRIES, ...config.registries },\r\n    })\r\n  )\r\n};\r\n","interface RegistryContext {\r\n  headers: Record<string, Record<string, string>>\r\n}\r\n\r\nlet context: RegistryContext = {\r\n  headers: {},\r\n}\r\n\r\nexport function setRegistryHeaders(\r\n  headers: Record<string, Record<string, string>>\r\n) {\r\n  // Merge new headers with existing ones to preserve headers for nested dependencies\r\n  context.headers = { ...context.headers, ...headers };\r\n}\r\n\r\nexport function getRegistryHeadersFromContext(\r\n  url: string\r\n): Record<string, string> {\r\n  return context.headers[url] || {}\r\n};\r\n\r\nexport function clearRegistryContext() {\r\n  context.headers = {};\r\n}\r\n","import z from \"zod\";\r\nimport { Config } from \"../utils/get-config\";\r\nimport { buildUrlAndHeadersForRegistryItem } from \"./builder\";\r\nimport { configWithDefaults } from \"./config\";\r\nimport { clearRegistryContext } from \"./context\";\r\nimport { extractEnvVars } from \"./env\";\r\nimport { RegistryMissingEnvironmentVariablesError } from \"./errors\";\r\nimport { registryConfigItemSchema } from \"./schema\";\r\n\r\nexport function extractEnvVarsFromRegistryConfig(\r\n  config: z.infer<typeof registryConfigItemSchema>\r\n): string[] {\r\n  const vars = new Set<string>();\r\n\r\n  if (typeof config === \"string\") {\r\n    extractEnvVars(config).forEach((v) => vars.add(v));\r\n  } else {\r\n    extractEnvVars(config.url).forEach((v) => vars.add(v));\r\n\r\n    if (config.params) {\r\n      Object.values(config.params).forEach((value) => {\r\n        extractEnvVars(value).forEach((v) => vars.add(v));\r\n      })\r\n    }\r\n\r\n    if (config.headers) {\r\n      Object.values(config.headers).forEach((value) => {\r\n        extractEnvVars(value).forEach((v) => vars.add(v));\r\n      })\r\n    }\r\n  }\r\n\r\n  return Array.from(vars);\r\n}\r\n\r\nexport function validateRegistryConfig(\r\n  registryName: string,\r\n  config: z.infer<typeof registryConfigItemSchema>\r\n): void {\r\n  const requiredVars = extractEnvVarsFromRegistryConfig(config);\r\n  const missing = requiredVars.filter((v) => !process.env[v]);\r\n\r\n  if (missing.length > 0) {\r\n    throw new RegistryMissingEnvironmentVariablesError(registryName, missing);\r\n  }\r\n}\r\n\r\nexport function validateRegistryConfigForItems(\r\n  items: string[],\r\n  config?: Config\r\n): void {\r\n  for (const item of items) {\r\n    buildUrlAndHeadersForRegistryItem(item, configWithDefaults(config));\r\n  }\r\n\r\n  // Clear registry context after validation.\r\n  clearRegistryContext();\r\n}\r\n","import z from \"zod\";\r\nimport { Config } from \"../utils/get-config\";\r\nimport { REGISTRY_URL } from \"./constants\";\r\nimport { expandEnvVars } from \"./env\";\r\nimport { RegistryNotConfiguredError } from \"./errors\";\r\nimport { parseRegistryAndItemFromString } from \"./parser\";\r\nimport { registryConfigItemSchema } from \"./schema\";\r\nimport { isUrl } from \"./utils\";\r\nimport { validateRegistryConfig } from \"./validator\";\r\n\r\nconst NAME_PLACEHOLDER = \"{name}\";\r\nconst STYLE_PLACEHOLDER = \"{style}\";\r\nconst ENV_VAR_PATTER = /\\${(\\w+)}/g\r\nconst QUERY_PARAM_SEPARATOR = \"?\";\r\nconst QUERY_PARAM_DELIMITER = \"&\";\r\n\r\nexport function buildUrlAndHeadersForRegistryItem(\r\n  name: string,\r\n  config?: Config\r\n) {\r\n  const { registry, item } = parseRegistryAndItemFromString(name);\r\n\r\n  if (!registry) {\r\n    return null;\r\n  }\r\n\r\n  const registries = config?.registries || {};\r\n  const registryConfig = registries[registry];\r\n  if (!registryConfig) {\r\n    throw new RegistryNotConfiguredError(registry);\r\n  }\r\n\r\n  validateRegistryConfig(registry, registryConfig);\r\n\r\n  return {\r\n    url: buildUrlFromRegistryConfig(item, registryConfig, config),\r\n    headers: buildHeadersFromRegistryConfig(registryConfig),\r\n  }\r\n}\r\n\r\nexport function buildUrlFromRegistryConfig(\r\n  item: string,\r\n  registryConfig: z.infer<typeof registryConfigItemSchema>,\r\n  config?: Config\r\n) {\r\n  if (typeof registryConfig === \"string\") {\r\n    let url = registryConfig.replace(NAME_PLACEHOLDER, item);\r\n    if (config?.style && url.includes(STYLE_PLACEHOLDER)) {\r\n      url = url.replace(STYLE_PLACEHOLDER, config.style);\r\n    }\r\n    return expandEnvVars(url);\r\n  }\r\n\r\n  let baseUrl = registryConfig.url.replace(NAME_PLACEHOLDER, item);\r\n  if (config?.style && baseUrl.includes(STYLE_PLACEHOLDER)) {\r\n    baseUrl = baseUrl.replace(STYLE_PLACEHOLDER, config.style);\r\n  }\r\n  baseUrl = expandEnvVars(baseUrl);\r\n\r\n  if (!registryConfig.params) {\r\n    return baseUrl;\r\n  }\r\n\r\n  return appendQueryParams(baseUrl, registryConfig.params);\r\n}\r\n\r\nexport function buildHeadersFromRegistryConfig(\r\n  config: z.infer<typeof registryConfigItemSchema>\r\n) {\r\n  if (typeof config === \"string\" || !config.headers) {\r\n    return {}\r\n  }\r\n\r\n  const headers: Record<string, string> = {};\r\n\r\n  for (const [key, value] of Object.entries(config.headers)) {\r\n    const expandedValue = expandEnvVars(value);\r\n\r\n    if (shouldIncludeHeader(value, expandedValue)) {\r\n      headers[key] = expandedValue;\r\n    }\r\n  }\r\n\r\n  return headers;\r\n}\r\n\r\nfunction appendQueryParams(baseUrl: string, params: Record<string, string>) {\r\n  const urlParams = new URLSearchParams();\r\n\r\n  for (const [key, value] of Object.entries(params)) {\r\n    const expandedValue = expandEnvVars(value);\r\n    if (expandedValue) {\r\n      urlParams.append(key, expandedValue);\r\n    }\r\n  }\r\n\r\n  const queryString = urlParams.toString();\r\n  if (!queryString) {\r\n    return baseUrl;\r\n  }\r\n\r\n  const separator = baseUrl.includes(QUERY_PARAM_SEPARATOR)\r\n    ? QUERY_PARAM_DELIMITER\r\n    : QUERY_PARAM_SEPARATOR;\r\n\r\n  return `${baseUrl}${separator}${queryString}`;\r\n}\r\n\r\nfunction shouldIncludeHeader(originalValue: string, expandedValue: string) {\r\n  const trimmedExpanded = expandedValue.trim();\r\n\r\n  if (!trimmedExpanded) {\r\n    return false;\r\n  }\r\n\r\n  // If the original value contains valid en vars, only include if expansion changed the value.\r\n  if (originalValue.includes(\"${\")) {\r\n    // Check if there are actual en vars in the string\r\n    const envVars = originalValue.match(ENV_VAR_PATTER);\r\n    if (envVars) {\r\n      const templateWithoutVars = originalValue\r\n        .replace(ENV_VAR_PATTER, \"\")\r\n        .trim();\r\n\r\n      return trimmedExpanded !== templateWithoutVars;\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nexport function resolveRegistryUrl(pathOrUrl: string) {\r\n  if (isUrl(pathOrUrl)) {\r\n    // If the url contains /chat/b, we assume it's the v0 registry.\r\n    // We need to add the /json suffix if it's missing.\r\n    const url = new URL(pathOrUrl);\r\n    if (url.pathname.match(/\\/chat\\/b\\//) && !url.pathname.endsWith(\"/json\")) {\r\n      url.pathname = `${url.pathname}/json`\r\n    }\r\n\r\n    return url.toString();\r\n  }\r\n\r\n  return `${REGISTRY_URL}/${pathOrUrl}`;\r\n}\r\n","import { resolveRegistryUrl } from \"@/src/registry/builder\"\r\nimport { getRegistryHeadersFromContext } from \"@/src/registry/context\"\r\nimport {\r\n  RegistryFetchError,\r\n  RegistryForbiddenError,\r\n  RegistryLocalFileError,\r\n  RegistryNotFoundError,\r\n  RegistryParseError,\r\n  RegistryUnauthorizedError,\r\n} from \"@/src/registry/errors\"\r\nimport { registryItemSchema } from \"@/src/schema\"\r\nimport { promises as fs } from \"fs\"\r\nimport { HttpsProxyAgent } from \"https-proxy-agent\"\r\nimport fetch from \"node-fetch\"\r\nimport { homedir } from \"os\"\r\nimport path from \"path\"\r\nimport { z } from \"zod\"\r\n\r\nconst agent = process.env.https_proxy\r\n  ? new HttpsProxyAgent(process.env.https_proxy)\r\n  : undefined\r\n\r\nconst registryCache = new Map<string, Promise<any>>()\r\n\r\nexport function clearRegistryCache() {\r\n  registryCache.clear()\r\n}\r\n\r\nexport async function fetchRegistry(\r\n  paths: string[],\r\n  options: { useCache?: boolean } = {}\r\n) {\r\n  options = {\r\n    useCache: true,\r\n    ...options,\r\n  }\r\n\r\n  try {\r\n    const results = await Promise.all(\r\n      paths.map(async (path) => {\r\n        const url = resolveRegistryUrl(path)\r\n\r\n        // Check cache first if caching is enabled\r\n        if (options.useCache && registryCache.has(url)) {\r\n          return registryCache.get(url)\r\n        }\r\n\r\n        // Store the promise in the cache before awaiting if caching is enabled.\r\n        const fetchPromise = (async () => {\r\n          // Get headers from context for this URL.\r\n          const headers = getRegistryHeadersFromContext(url)\r\n\r\n          const response = await fetch(url, {\r\n            agent,\r\n            headers: {\r\n              ...headers,\r\n            },\r\n          })\r\n\r\n          if (!response.ok) {\r\n            let messageFromServer = undefined\r\n\r\n            if (\r\n              response.headers.get(\"content-type\")?.includes(\"application/json\")\r\n            ) {\r\n              const json = await response.json()\r\n              const parsed = z\r\n                .object({\r\n                  // RFC 7807.\r\n                  detail: z.string().optional(),\r\n                  title: z.string().optional(),\r\n                  // Standard error response.\r\n                  message: z.string().optional(),\r\n                  error: z.string().optional(),\r\n                })\r\n                .safeParse(json)\r\n\r\n              if (parsed.success) {\r\n                // Prefer RFC 7807 detail field, then message field.\r\n                messageFromServer = parsed.data.detail || parsed.data.message\r\n\r\n                if (parsed.data.error) {\r\n                  messageFromServer = `[${parsed.data.error}] ${messageFromServer}`\r\n                }\r\n              }\r\n            }\r\n\r\n            if (response.status === 401) {\r\n              throw new RegistryUnauthorizedError(url, messageFromServer)\r\n            }\r\n\r\n            if (response.status === 404) {\r\n              throw new RegistryNotFoundError(url, messageFromServer)\r\n            }\r\n\r\n            if (response.status === 403) {\r\n              throw new RegistryForbiddenError(url, messageFromServer)\r\n            }\r\n\r\n            throw new RegistryFetchError(\r\n              url,\r\n              response.status,\r\n              messageFromServer\r\n            )\r\n          }\r\n\r\n          return response.json()\r\n        })()\r\n\r\n        if (options.useCache) {\r\n          registryCache.set(url, fetchPromise)\r\n        }\r\n        return fetchPromise\r\n      })\r\n    )\r\n\r\n    return results\r\n  } catch (error) {\r\n    throw error\r\n  }\r\n}\r\n\r\nexport async function fetchRegistryLocal(filePath: string) {\r\n  try {\r\n    // Handle tilde expansion for home directory\r\n    let expandedPath = filePath\r\n    if (filePath.startsWith(\"~/\")) {\r\n      expandedPath = path.join(homedir(), filePath.slice(2))\r\n    }\r\n\r\n    const resolvedPath = path.resolve(expandedPath)\r\n    const content = await fs.readFile(resolvedPath, \"utf8\")\r\n    const parsed = JSON.parse(content)\r\n\r\n    try {\r\n      return registryItemSchema.parse(parsed)\r\n    } catch (error) {\r\n      throw new RegistryParseError(filePath, error)\r\n    }\r\n  } catch (error) {\r\n    // Check if this is a file not found error\r\n    if (\r\n      error instanceof Error &&\r\n      (error.message.includes(\"ENOENT\") ||\r\n        error.message.includes(\"no such file\"))\r\n    ) {\r\n      throw new RegistryLocalFileError(filePath, error)\r\n    }\r\n    // Re-throw parse errors as-is\r\n    if (error instanceof RegistryParseError) {\r\n      throw error\r\n    }\r\n    // For other errors (like JSON parse errors), throw as local file error\r\n    throw new RegistryLocalFileError(filePath, error)\r\n  }\r\n}\r\n","// Internal function that fetches registry items without clearing context.\r\n\r\nimport { Config } from \"../utils/get-config\";\r\nimport { buildUrlAndHeadersForRegistryItem } from \"./builder\";\r\nimport { setRegistryHeaders } from \"./context\";\r\nimport { RegistryParseError } from \"./errors\";\r\nimport { fetchRegistry, fetchRegistryLocal } from \"./fetcher\";\r\nimport { registryItemSchema } from \"./schema\";\r\nimport { isLocalFile, isUrl } from \"./utils\";\r\n\r\nexport function resolveRegistryItemsFromRegistries(\r\n  items: string[],\r\n  config: Config\r\n) {\r\n  const registryHeaders: Record<string, Record<string, string>> = {};\r\n  const resolvedItems = [...items];\r\n\r\n  if (!config?.registries) {\r\n    setRegistryHeaders({});\r\n    return resolvedItems;\r\n  }\r\n\r\n  for (let i = 0; i < resolvedItems.length; i++) {\r\n    const resolved = buildUrlAndHeadersForRegistryItem(resolvedItems[i], config);\r\n\r\n    if (resolved) {\r\n      resolvedItems[i] = resolved.url;\r\n\r\n      if (Object.keys(resolved.headers).length > 0) {\r\n        registryHeaders[resolved.url] = resolved.headers;\r\n      }\r\n    }\r\n  }\r\n\r\n  setRegistryHeaders(registryHeaders);\r\n\r\n  return resolvedItems;\r\n}\r\n\r\n// This is used for recursive dependecy resolution.\r\nexport async function fetchRegistryItems(\r\n  items: string[],\r\n  config: Config,\r\n  options: { useCache?: boolean } = {}\r\n) {\r\n  const results = await Promise.all(\r\n    items.map(async (item) => {\r\n      if (isLocalFile(item)) {\r\n        return fetchRegistryLocal(item);\r\n      }\r\n\r\n      if (isUrl(item)) {\r\n        const [result] = await fetchRegistry([item], options);\r\n        try {\r\n          return registryItemSchema.parse(result);\r\n        } catch (error) {\r\n          throw new RegistryParseError(item, error);\r\n        }\r\n      }\r\n\r\n      if (item.startsWith(\"@\") && config?.registries) {\r\n        const paths = resolveRegistryItemsFromRegistries([item], config);\r\n        const [result] = await fetchRegistry(paths, options);\r\n        try {\r\n          return registryItemSchema.parse(result);\r\n        } catch (error) {\r\n          throw new RegistryParseError(item, error);\r\n        }\r\n      }\r\n\r\n\r\n      const path = `styles/${config?.style ?? \"aodesu\"}/${item}.json`;\r\n      const [result] = await fetchRegistry([path], options);\r\n        console.log(\"TEST - LLEGO AKI\")\r\n      try {\r\n        return registryItemSchema.parse(result);\r\n      } catch (error) {\r\n        throw new RegistryParseError(item, error);\r\n      }\r\n    })\r\n  )\r\n\r\n  return results;\r\n}\r\n","import z from \"zod\";\r\nimport { Config } from \"../utils/get-config\";\r\nimport { handleError } from \"../utils/handle-error\";\r\nimport { logger } from \"../utils/logger\";\r\nimport { buildUrlAndHeadersForRegistryItem } from \"./builder\";\r\nimport { configWithDefaults } from \"./config\";\r\nimport { BASE_COLORS, REGISTRY_URL } from \"./constants\";\r\nimport { clearRegistryContext, setRegistryHeaders } from \"./context\";\r\nimport { RegistriesIndexParseError, RegistryInvalidNamespaceError, RegistryNotFoundError, RegistryParseError } from \"./errors\";\r\nimport { fetchRegistry } from \"./fetcher\";\r\nimport { fetchRegistryItems } from \"./resolver\";\r\nimport { registriesIndexSchema, registryIndexSchema, registrySchema, stylesSchema } from \"./schema\";\r\nimport { isUrl } from \"./utils\";\r\n\r\nexport async function getRegistry(\r\n  name: string,\r\n  options?: {\r\n    config?: Partial<Config>\r\n    useCache?: boolean\r\n  }\r\n) {\r\n  const { config, useCache } = options || {};\r\n\r\n  if (isUrl(name)) {\r\n    const [result] = await fetchRegistry([name], { useCache });\r\n    try {\r\n      return registrySchema.parse(result);\r\n    } catch (error) {\r\n      throw new RegistryParseError(name, error);\r\n    }\r\n  }\r\n\r\n  if (!name.startsWith(\"@\")) {\r\n    throw new RegistryInvalidNamespaceError(name);\r\n  }\r\n\r\n  let registryName = name;\r\n  if (!registryName.endsWith(\"/registry\")) {\r\n    registryName = `${registryName}/registry`\r\n  }\r\n\r\n  const urlAndHeaders = buildUrlAndHeadersForRegistryItem(\r\n    registryName as `@${string}`,\r\n    configWithDefaults(config)\r\n  );\r\n\r\n  if (!urlAndHeaders?.url) {\r\n    throw new RegistryNotFoundError(registryName);\r\n  }\r\n\r\n  if (urlAndHeaders.headers && Object.keys(urlAndHeaders.headers).length > 0) {\r\n    setRegistryHeaders({\r\n      [urlAndHeaders.url]: urlAndHeaders.headers,\r\n    })\r\n  }\r\n\r\n  const [result] = await fetchRegistry([urlAndHeaders.url], { useCache });\r\n\r\n  try {\r\n    return registrySchema.parse(result);\r\n  } catch (error) {\r\n    throw new RegistryParseError(registryName, error);\r\n  }\r\n}\r\n\r\nexport async function getRegistryItems(\r\n  items: string[],\r\n  options?: {\r\n    config?: Partial<Config>\r\n    useCache?: boolean\r\n  }\r\n) {\r\n  const { config, useCache } = options || {};\r\n\r\n  clearRegistryContext();\r\n\r\n  return fetchRegistryItems(items, configWithDefaults(config), { useCache })\r\n}\r\n\r\nexport async function getAodesuRegistryIndex() {\r\n  try {\r\n    const [result] = await fetchRegistry([\"index.json\"])\r\n\r\n    return registryIndexSchema.parse(result)\r\n  } catch (error) {\r\n    logger.error(\"\\n\")\r\n    handleError(error)\r\n  }\r\n}\r\n\r\nexport async function getRegistryStyles() {\r\n  try {\r\n    const [result] = await fetchRegistry([\"styles/index.json\"]);\r\n\r\n    return stylesSchema.parse(result);\r\n  } catch (error) {\r\n    logger.error(\"\\n\");\r\n    handleError(error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getRegistryBaseColors() {\r\n  return BASE_COLORS;\r\n}\r\n\r\nexport async function getRegistriesIndex(options?: { useCache?: boolean }) {\r\n  options = {\r\n    useCache: true,\r\n    ...options,\r\n  }\r\n\r\n  const url = `${REGISTRY_URL}/registries.json`\r\n  const [data] = await fetchRegistry([url], {\r\n    useCache: options.useCache,\r\n  })\r\n\r\n  try {\r\n    return registriesIndexSchema.parse(data)\r\n  } catch (error) {\r\n    if (error instanceof z.ZodError) {\r\n      throw new RegistriesIndexParseError(error)\r\n    }\r\n\r\n    throw error\r\n  }\r\n}\r\n","import { detect } from \"@antfu/ni\"\r\n\r\nexport async function getPackageManager(\r\n  targetDir: string,\r\n  { withFallback }: { withFallback?: boolean } = {\r\n    withFallback: false,\r\n  }\r\n): Promise<\"yarn\" | \"pnpm\" | \"bun\" | \"npm\" | \"deno\"> {\r\n  const packageManager = await detect({ programmatic: true, cwd: targetDir })\r\n\r\n  if (packageManager === \"yarn@berry\") return \"yarn\"\r\n  if (packageManager === \"pnpm@6\") return \"pnpm\"\r\n  if (packageManager === \"bun\") return \"bun\"\r\n  if (packageManager === \"deno\") return \"deno\"\r\n  if (!withFallback) {\r\n    return packageManager ?? \"npm\"\r\n  }\r\n\r\n  // Fallback to user agent if not detected.\r\n  const userAgent = process.env.npm_config_user_agent || \"\"\r\n\r\n  if (userAgent.startsWith(\"yarn\")) {\r\n    return \"yarn\"\r\n  }\r\n\r\n  if (userAgent.startsWith(\"pnpm\")) {\r\n    return \"pnpm\"\r\n  }\r\n\r\n  if (userAgent.startsWith(\"bun\")) {\r\n    return \"bun\"\r\n  }\r\n\r\n  return \"npm\"\r\n}\r\n\r\nexport async function getPackageRunner(cwd: string) {\r\n  const packageManager = await getPackageManager(cwd)\r\n\r\n  if (packageManager === \"pnpm\") return \"pnpm dlx\"\r\n\r\n  if (packageManager === \"bun\") return \"bunx\"\r\n\r\n  return \"npx\"\r\n}\r\n","import { initOptionsSchema } from \"@/src/commands/init\";\r\nimport { fetchRegistry } from \"@/src/registry/fetcher\";\r\nimport { getPackageManager } from \"@/src/utils/get-package-manager\";\r\nimport { handleError } from \"@/src/utils/handle-error\";\r\nimport { highlighter } from \"@/src/utils/highlighter\";\r\nimport { logger } from \"@/src/utils/logger\";\r\nimport { spinner } from \"@/src/utils/spinner\";\r\nimport { execa } from \"execa\";\r\nimport fs from \"fs-extra\";\r\nimport os from \"os\";\r\nimport path from \"path\";\r\nimport prompts from \"prompts\";\r\nimport z from \"zod\";\r\n\r\nconst MONOREPO_TEMPLATE_URL = \"https://codeload.github.com/aodesu-ui/ui/tar.gz/main\";\r\n\r\nexport const TEMPLATES = {\r\n  next: \"next\",\r\n  \"next-16\": \"next-16\",\r\n  \"next-monorepo\": \"next-monorepo\",\r\n  vite: \"vite\"\r\n} as const;\r\n\r\nexport async function createProject(\r\n  options: Pick<\r\n    z.infer<typeof initOptionsSchema>,\r\n    \"cwd\" | \"force\" | \"srcDir\" | \"components\" | \"template\"\r\n  >\r\n) {\r\n  options = {\r\n    srcDir: false,\r\n    ...options,\r\n  };\r\n\r\n  let template: keyof typeof TEMPLATES =\r\n    options.template && TEMPLATES[options.template as keyof typeof TEMPLATES]\r\n    ? (options.template as keyof typeof TEMPLATES)\r\n    : \"next\";\r\n\r\n  let projectName: string =\r\n    template === TEMPLATES.next ? \"my-app\" : \"my-monorepo\";\r\n\r\n  let nextVersion = \"15\";\r\n\r\n  const isRemoteComponent =\r\n    options.components?.length === 1 &&\r\n    !!options.components[0].match(/\\/chat\\/b\\//);\r\n\r\n  if (options.components && isRemoteComponent) {\r\n    try {\r\n      const [result] = await fetchRegistry(options.components);\r\n      const { meta } = z\r\n        .object({\r\n          meta: z.object({\r\n            nextVersion: z.string(),\r\n          }),\r\n        })\r\n        .parse(result);\r\n      nextVersion = meta.nextVersion;\r\n\r\n      // Force template to next for remote components.\r\n      template = TEMPLATES.next;\r\n    } catch (error) {\r\n      logger.break();\r\n      handleError(error);\r\n    }\r\n  }\r\n\r\n  if (!options.force) {\r\n    const { type, name } = await prompts([\r\n      {\r\n        type: options.template || isRemoteComponent ? null : \"select\",\r\n        name: \"type\",\r\n        message: `The path ${highlighter.info(\r\n          options.cwd\r\n        )} does not contain a package.json file.\\n  Would you like to start a new project?`,\r\n        choices: [\r\n          { title: \"Vite\", value: \"vite\" },\r\n          { title: \"Next.js 15\", value: \"next\" },\r\n          { title: \"Next.js 16\", value: \"next-16\" },\r\n          { title: \"Next.js (Monorepo)\", value: \"next-monorepo\" },\r\n        ],\r\n        initial: 0,\r\n      },\r\n      {\r\n        type: \"text\",\r\n        name: \"name\",\r\n        message: \"What is your project named?\",\r\n        initial: projectName,\r\n        format: (value: string) => value.trim(),\r\n        validate: (value: string) =>\r\n          value.length > 128\r\n            ? `Name should be less than 128 characters.`\r\n            : true,\r\n      },\r\n    ])\r\n\r\n    template = type ?? template;\r\n    projectName = name;\r\n\r\n    if (type === \"next-16\") {\r\n      nextVersion = \"latest\"\r\n    }\r\n  }\r\n\r\n  const packageManager = await getPackageManager(options.cwd, {\r\n    withFallback: true,\r\n  });\r\n\r\n  const projectPath = `${options.cwd}/${projectName}`;\r\n\r\n  // Check if path is writable.\r\n  try {\r\n    await fs.access(options.cwd, fs.constants.W_OK);\r\n  } catch (error) {\r\n    logger.break()\r\n    logger.error(`The path ${highlighter.info(options.cwd)} is not writable.`)\r\n    logger.error(\r\n      `It is likely you do not have write permissions for this folder or the path ${highlighter.info(\r\n        options.cwd\r\n      )} does not exist.`\r\n    )\r\n    logger.break()\r\n    process.exit(1)\r\n  }\r\n\r\n  if (fs.existsSync(path.resolve(options.cwd, projectName, \"package.json\"))) {\r\n    logger.break()\r\n    logger.error(\r\n      `A project with the name ${highlighter.info(projectName)} already exists.`\r\n    )\r\n    logger.error(`Please choose a different name and try again.`)\r\n    logger.break()\r\n    process.exit(1)\r\n  }\r\n\r\n  if (template === TEMPLATES.vite) {\r\n    await createViteProject(projectPath, {\r\n      packageManager\r\n    })\r\n  }\r\n\r\n  if (template === TEMPLATES.next || template === TEMPLATES[\"next-16\"]) {\r\n    await createNextProject(projectPath, {\r\n      version: nextVersion,\r\n      cwd: options.cwd,\r\n      packageManager,\r\n      srcDir: !!options.srcDir,\r\n    })\r\n  }\r\n\r\n  if (template === TEMPLATES[\"next-monorepo\"]) {\r\n    await createMonorepoProject(projectPath, {\r\n      packageManager,\r\n    })\r\n  }\r\n\r\n  return {\r\n    projectPath,\r\n    projectName,\r\n    template,\r\n  }\r\n}\r\n\r\nasync function createViteProject(\r\n  projectPath: string,\r\n  options: {\r\n    packageManager: string\r\n  }\r\n) {\r\n  const createSpinner = spinner(\r\n    `Creating a new Vite project. This may take a few minutes.`\r\n  ).start();\r\n\r\n  try {\r\n    const args = [\r\n      \"create\",\r\n      \"vite@latest\",\r\n      path.basename(projectPath),\r\n      \"--template\",\r\n      \"react-ts\",\r\n      \"--yes\"\r\n    ]\r\n\r\n    await execa(options.packageManager, args, {\r\n      cwd: path.dirname(projectPath),\r\n    });\r\n\r\n    const installSpinner = spinner(`Installing dependencies with ${options.packageManager}.`).start();\r\n\r\n    await execa(options.packageManager, [\"install\"], {\r\n      cwd: projectPath,\r\n    });\r\n\r\n    installSpinner?.succeed(`Installed dependencies with ${options.packageManager}.`);\r\n\r\n    try {\r\n      await execa(\"git\", [\"init\"], { cwd: projectPath })\r\n      await execa(\"git\", [\"add\", \"-A\"], { cwd: projectPath })\r\n      await execa(\"git\", [\"commit\", \"-m\", \"Initial commit from aodesu-ui\"], {\r\n        cwd: projectPath,\r\n      })\r\n    } catch (gitError) {\r\n      logger.warn(\"Git initialization skipped (git not available)\")\r\n    }\r\n\r\n    createSpinner?.succeed(\"Creating a new Vite project.\");\r\n  } catch (error) {\r\n    createSpinner?.fail(\"Something went worng creating a new Vite project.\");\r\n    handleError(error);\r\n  }\r\n}\r\n\r\nasync function createNextProject(\r\n  projectPath: string,\r\n  options: {\r\n    version: string\r\n    cwd: string\r\n    packageManager: string\r\n    srcDir: boolean\r\n  }\r\n) {\r\n  const createSpinner = spinner(\r\n    `Creating a new Next.js ${\r\n      options.version.startsWith(\"latest\") ? \"16\" : \"15\"\r\n    } project. This may take a few minutes.`\r\n  ).start()\r\n\r\n  // Note: pnpm fails here. Fallback to npx with --use-PACKAGE-MANAGER.\r\n  const args = [\r\n    \"--tailwind\",\r\n    \"--eslint\",\r\n    \"--typescript\",\r\n    \"--app\",\r\n    options.srcDir ? \"--src-dir\" : \"--no-src-dir\",\r\n    \"--no-import-alias\",\r\n    `--use-${options.packageManager}`,\r\n  ]\r\n\r\n  if (\r\n    options.version.startsWith(\"15\") ||\r\n    options.version.startsWith(\"latest\") ||\r\n    options.version.startsWith(\"canary\")\r\n  ) {\r\n    args.push(\"--turbopack\")\r\n  }\r\n\r\n  if (\r\n    options.version.startsWith(\"latest\") ||\r\n    options.version.startsWith(\"canary\")\r\n  ) {\r\n    args.push(\"--no-react-compiler\")\r\n  }\r\n\r\n  try {\r\n    await execa(\r\n      \"npx\",\r\n      [`create-next-app@${options.version}`, projectPath, \"--silent\", ...args],\r\n      {\r\n        cwd: options.cwd,\r\n      }\r\n    )\r\n  } catch (error) {\r\n    logger.break()\r\n    logger.error(\r\n      `Something went wrong creating a new Next.js project. Please try again.`\r\n    )\r\n    process.exit(1)\r\n  }\r\n\r\n  createSpinner?.succeed(\r\n    `Creating a new Next.js ${\r\n      options.version.startsWith(\"latest\") ? \"16\" : \"15\"\r\n    } project.`\r\n  )\r\n}\r\n\r\nasync function createMonorepoProject(\r\n  projectPath: string,\r\n  options: {\r\n    packageManager: string\r\n  }\r\n) {\r\n  const createSpinner = spinner(\r\n    `Creating a new Next.js monorepo. This may take a few minutes.`\r\n  ).start()\r\n\r\n  try {\r\n    // Get the template.\r\n    const templatePath = path.join(os.tmpdir(), `aodesu-template-${Date.now()}`)\r\n    await fs.ensureDir(templatePath)\r\n    const response = await fetch(MONOREPO_TEMPLATE_URL)\r\n    if (!response.ok) {\r\n      throw new Error(`Failed to download template: ${response.statusText}`)\r\n    }\r\n\r\n    // Write the tar file\r\n    const tarPath = path.resolve(templatePath, \"template.tar.gz\")\r\n    await fs.writeFile(tarPath, Buffer.from(await response.arrayBuffer()))\r\n    await execa(\"tar\", [\r\n      \"-xzf\",\r\n      tarPath,\r\n      \"-C\",\r\n      templatePath,\r\n      \"--strip-components=2\",\r\n      \"ui-main/templates/monorepo-next\",\r\n    ])\r\n    const extractedPath = path.resolve(templatePath, \"monorepo-next\")\r\n    await fs.move(extractedPath, projectPath)\r\n    await fs.remove(templatePath)\r\n\r\n    // Run install.\r\n    await execa(options.packageManager, [\"install\"], {\r\n      cwd: projectPath,\r\n    })\r\n    // await execa(\"cd\", [cwd])\r\n\r\n    // Write project name to the package.json\r\n    const packageJsonPath = path.join(projectPath, \"package.json\")\r\n    if (fs.existsSync(packageJsonPath)) {\r\n      const packageJsonContent = await fs.readFile(packageJsonPath, \"utf8\")\r\n      const packageJson = JSON.parse(packageJsonContent)\r\n      packageJson.name = projectPath.split(\"/\").pop()\r\n      await fs.writeFile(packageJsonPath, JSON.stringify(packageJson, null, 2))\r\n    }\r\n\r\n    // Try git init.\r\n    const cwd = process.cwd()\r\n    await execa(\"git\", [\"--version\"], { cwd: projectPath })\r\n    await execa(\"git\", [\"init\"], { cwd: projectPath })\r\n    await execa(\"git\", [\"add\", \"-A\"], { cwd: projectPath })\r\n    await execa(\"git\", [\"commit\", \"-m\", \"Initial commit\"], {\r\n      cwd: projectPath,\r\n    })\r\n\r\n    createSpinner?.succeed(\"Creating a new Next.js monorepo.\")\r\n  } catch (error) {\r\n    createSpinner?.fail(\"Something went wrong creating a new Next.js monorepo.\")\r\n    handleError(error)\r\n  }\r\n}\r\n","import { existsSync } from \"fs\";\r\nimport { join } from \"path\";\r\nimport { logger } from \"./logger\";\r\n\r\nexport async function loadEnvFiles(cwd: string = process.cwd()): Promise<void> {\r\n  try {\r\n    const { config } = await import(\"@dotenvx/dotenvx\");\r\n    const envFiles = [\r\n      \".env.local\",\r\n      \".env.development.local\",\r\n      \".env.development\",\r\n      \".env\"\r\n    ];\r\n\r\n    for (const envFile of envFiles) {\r\n      const envPath = join(cwd, envFile);\r\n      if (existsSync(envPath)) {\r\n        config({\r\n          path: envPath,\r\n          overload: false,\r\n          quiet: true\r\n        })\r\n      }\r\n    }\r\n  } catch (error) {\r\n    logger.warn(\"Failed to load env files:\", error);\r\n  }\r\n}\r\n","import fsExtra from \"fs-extra\"\r\n\r\nexport const FILE_BACKUP_SUFFIX = \".bak\"\r\n\r\nexport function createFileBackup(filePath: string): string | null {\r\n  if (!fsExtra.existsSync(filePath)) {\r\n    return null\r\n  }\r\n\r\n  const backupPath = `${filePath}${FILE_BACKUP_SUFFIX}`\r\n  try {\r\n    fsExtra.renameSync(filePath, backupPath)\r\n    return backupPath\r\n  } catch (error) {\r\n    console.error(`Failed to create backup of ${filePath}: ${error}`)\r\n    return null\r\n  }\r\n}\r\n\r\nexport function restoreFileBackup(filePath: string): boolean {\r\n  const backupPath = `${filePath}${FILE_BACKUP_SUFFIX}`\r\n\r\n  if (!fsExtra.existsSync(backupPath)) {\r\n    return false\r\n  }\r\n\r\n  try {\r\n    fsExtra.renameSync(backupPath, filePath)\r\n    return true\r\n  } catch (error) {\r\n    console.error(\r\n      `Warning: Could not restore backup file ${backupPath}: ${error}`\r\n    )\r\n    return false\r\n  }\r\n}\r\n\r\nexport function deleteFileBackup(filePath: string): boolean {\r\n  const backupPath = `${filePath}${FILE_BACKUP_SUFFIX}`\r\n\r\n  if (!fsExtra.existsSync(backupPath)) {\r\n    return false\r\n  }\r\n\r\n  try {\r\n    fsExtra.unlinkSync(backupPath)\r\n    return true\r\n  } catch (error) {\r\n    // Best effort - don't log as this is just cleanup\r\n    return false\r\n  }\r\n}\r\n","import { BUILTIN_REGISTRIES } from \"@/src/registry/constants\"\r\nimport { RegistryNotConfiguredError } from \"@/src/registry/errors\"\r\nimport { parseRegistryAndItemFromString } from \"@/src/registry/parser\"\r\nimport { fetchRegistryItems } from \"@/src/registry/resolver\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\n\r\n// Recursively discovers all registry namespaces including nested ones.\r\nexport async function resolveRegistryNamespaces(\r\n  components: string[],\r\n  config: Config\r\n) {\r\n  const discoveredNamespaces = new Set<string>()\r\n  const visitedItems = new Set<string>()\r\n  const itemsToProcess = [...components]\r\n\r\n  while (itemsToProcess.length > 0) {\r\n    const currentItem = itemsToProcess.shift()!\r\n\r\n    if (visitedItems.has(currentItem)) {\r\n      continue\r\n    }\r\n    visitedItems.add(currentItem)\r\n\r\n    const { registry } = parseRegistryAndItemFromString(currentItem)\r\n    if (registry && !BUILTIN_REGISTRIES[registry]) {\r\n      discoveredNamespaces.add(registry)\r\n    }\r\n\r\n    try {\r\n      const [item] = await fetchRegistryItems([currentItem], config, {\r\n        useCache: true,\r\n      })\r\n\r\n      if (item?.registryDependencies) {\r\n        for (const dep of item.registryDependencies) {\r\n          const { registry: depRegistry } = parseRegistryAndItemFromString(dep)\r\n          if (depRegistry && !BUILTIN_REGISTRIES[depRegistry]) {\r\n            discoveredNamespaces.add(depRegistry)\r\n          }\r\n\r\n          if (!visitedItems.has(dep)) {\r\n            itemsToProcess.push(dep)\r\n          }\r\n        }\r\n      }\r\n    } catch (error) {\r\n      // If a registry is not configured, we still track it.\r\n      if (error instanceof RegistryNotConfiguredError) {\r\n        const { registry } = parseRegistryAndItemFromString(currentItem)\r\n        if (registry && !BUILTIN_REGISTRIES[registry]) {\r\n          discoveredNamespaces.add(registry)\r\n        }\r\n        continue\r\n      }\r\n\r\n      // For other errors (network, parsing, etc.), we skip this item\r\n      // but continue processing others to discover as many namespaces as possible.\r\n      continue\r\n    }\r\n  }\r\n\r\n  return Array.from(discoveredNamespaces)\r\n}\r\n","import { getRegistriesIndex } from \"@/src/registry/api\"\r\nimport { BUILTIN_REGISTRIES } from \"@/src/registry/constants\"\r\nimport { resolveRegistryNamespaces } from \"@/src/registry/namespaces\"\r\nimport { rawConfigSchema } from \"@/src/registry/schema\"\r\nimport { Config } from \"@/src/utils/get-config\"\r\nimport { spinner } from \"@/src/utils/spinner\"\r\nimport fs from \"fs-extra\"\r\nimport path from \"path\"\r\n\r\nexport async function ensureRegistriesInConfig(\r\n  components: string[],\r\n  config: Config,\r\n  options: {\r\n    silent?: boolean\r\n    writeFile?: boolean\r\n  } = {}\r\n) {\r\n  options = {\r\n    silent: false,\r\n    writeFile: true,\r\n    ...options,\r\n  }\r\n\r\n  // Use resolveRegistryNamespaces to discover all namespaces including dependencies.\r\n  const registryNames = await resolveRegistryNamespaces(components, config)\r\n\r\n  const missingRegistries = registryNames.filter(\r\n    (registry) =>\r\n      !config.registries?.[registry] &&\r\n      !Object.keys(BUILTIN_REGISTRIES).includes(registry)\r\n  )\r\n\r\n  if (missingRegistries.length === 0) {\r\n    return {\r\n      config,\r\n      newRegistries: [],\r\n    }\r\n  }\r\n\r\n  // We'll fail silently if we can't fetch the registry index.\r\n  // The error handling by caller will guide user to add the missing registries.\r\n  const registryIndex = await getRegistriesIndex({\r\n    useCache: process.env.NODE_ENV !== \"development\",\r\n  })\r\n\r\n  if (!registryIndex) {\r\n    return {\r\n      config,\r\n      newRegistries: [],\r\n    }\r\n  }\r\n\r\n  const foundRegistries: Record<string, string> = {}\r\n  for (const registry of missingRegistries) {\r\n    if (registryIndex[registry]) {\r\n      foundRegistries[registry] = registryIndex[registry]\r\n    }\r\n  }\r\n\r\n  if (Object.keys(foundRegistries).length === 0) {\r\n    return {\r\n      config,\r\n      newRegistries: [],\r\n    }\r\n  }\r\n\r\n  // Filter out built-in registries from existing config before merging\r\n  const existingRegistries = Object.fromEntries(\r\n    Object.entries(config.registries || {}).filter(\r\n      ([key]) => !Object.keys(BUILTIN_REGISTRIES).includes(key)\r\n    )\r\n  )\r\n\r\n  const newConfigWithRegistries = {\r\n    ...config,\r\n    registries: {\r\n      ...existingRegistries,\r\n      ...foundRegistries,\r\n    },\r\n  }\r\n\r\n  if (options.writeFile) {\r\n    const { resolvedPaths, ...configWithoutResolvedPaths } =\r\n      newConfigWithRegistries\r\n    const configSpinner = spinner(\"Updating components.json.\", {\r\n      silent: options.silent,\r\n    }).start()\r\n    const updatedConfig = rawConfigSchema.parse(configWithoutResolvedPaths)\r\n    await fs.writeFile(\r\n      path.resolve(config.resolvedPaths.cwd, \"components.json\"),\r\n      JSON.stringify(updatedConfig, null, 2) + \"\\n\",\r\n      \"utf-8\"\r\n    )\r\n    configSpinner.succeed()\r\n  }\r\n\r\n  return {\r\n    config: newConfigWithRegistries,\r\n    newRegistries: Object.keys(foundRegistries),\r\n  }\r\n}\r\n","import * as ERRORS from \"@/src/utils/errors\";\r\nimport { Command } from 'commander';\r\nimport fsExtra from 'fs-extra';\r\nimport path from 'path';\r\nimport prompts from \"prompts\";\r\nimport z from 'zod';\r\nimport { preFlightInit } from '../preflights/preflight-init';\r\nimport { getRegistryBaseColors, getRegistryItems, getRegistryStyles } from '../registry/api';\r\nimport { buildUrlAndHeadersForRegistryItem } from '../registry/builder';\r\nimport { configWithDefaults } from '../registry/config';\r\nimport { clearRegistryContext } from '../registry/context';\r\nimport { rawConfigSchema } from \"../schema\";\r\nimport { createProject } from \"../utils/create-project\";\r\nimport { loadEnvFiles } from '../utils/env-loader';\r\nimport { createFileBackup, deleteFileBackup, restoreFileBackup } from '../utils/file-helper';\r\nimport { Config, getConfig } from \"../utils/get-config\";\r\nimport { getProjectConfig, getProjectInfo, getProjectTailwindVersionFromConfig } from \"../utils/get-project-info\";\r\nimport { handleError } from '../utils/handle-error';\r\nimport { highlighter } from '../utils/highlighter';\r\nimport { logger } from '../utils/logger';\r\nimport { ensureRegistriesInConfig } from '../utils/registries';\r\nprocess.on(\"exit\", (code) => {\r\n  const filePath = path.resolve(process.cwd(), \"components.json\")\r\n\r\n  if (code === 0) {\r\n    return deleteFileBackup(filePath);\r\n  }\r\n\r\n  return restoreFileBackup(filePath);\r\n});\r\n\r\nexport const initOptionsSchema = z.object({\r\n  cwd: z.string(),\r\n  components: z.array(z.string()).optional(),\r\n  yes: z.boolean(),\r\n  defaults: z.boolean(),\r\n  force: z.boolean(),\r\n  silent: z.boolean(),\r\n  isNewProject: z.boolean(),\r\n  srcDir: z.boolean().optional(),\r\n  cssVariables: z.boolean(),\r\n  template: z\r\n    .string()\r\n    .optional()\r\n    .refine(\r\n      (val) => {\r\n        if (val) {\r\n          return \"TEMPLATES\"\r\n        }\r\n        return true\r\n      },\r\n      {\r\n        message: \"Invalid template. Please use 'next', 'next-16' or 'next-monorepo'.\",\r\n      }\r\n    ),\r\n  baseColor: z\r\n    .string()\r\n    .optional(),\r\n  baseStyle: z.boolean(),\r\n});\r\n\r\nexport const init = new Command()\r\n  .name(\"init\")\r\n  .description(\"initialize your project and install dependencies\")\r\n  .argument(\"[components...]\", \"names, url or local path to component\")\r\n  .option(\r\n    \"-t, --template <template>\",\r\n    \"the template to use. (next, next-16, next-monorepo)\"\r\n  )\r\n  .option(\"-b, --base-color <base-color>\", \"The base color to use. (neutral)\", undefined)\r\n  .option(\"-y, --yes\", \"Skip de confirmation prompt\", true)\r\n  .option(\"-d, --defaults\", \"Use default configuration.\", false)\r\n  .option(\"-f, --force\", \"Force overwrite of existing configuration\", false)\r\n  .option(\r\n    \"-c, --cwd <cwd>\",\r\n    \"the working directory. defaults to the current directory.\",\r\n    process.cwd()\r\n  )\r\n  .option(\"-s, --silent\", \"Mute output\", false)\r\n  .option(\"--src-dir\", \"Use the src directory when creating a new project.\", false)\r\n  .option(\"--no-src-dir\", \"Do not use the src directory when creating a new project.\")\r\n  .option(\"--css-variables\", \"Use css variables for theming.\", true)\r\n  .option(\"--no-base-style\", \"Do not install the base aodesu style.\")\r\n  .action(async (components, opts) => {\r\n    try {\r\n      if (opts.defaults) {\r\n        opts.template = opts.template || \"next\"\r\n        opts.baseColor = opts.baseColor || \"neutral\"\r\n      }\r\n\r\n      const options = initOptionsSchema.parse({\r\n        cwd: path.resolve(opts.cwd),\r\n        isNewProject: false,\r\n        components,\r\n        ...opts\r\n      });\r\n\r\n      await loadEnvFiles(options.cwd);\r\n\r\n      // We need check if we're initializing with a new style\r\n      // This will allow us to determine if we need to install the base style.\r\n      // And if we should prompt the user for a base color.\r\n      if (components.length > 0) {\r\n        // We don't know the full config at this point.\r\n        // So we'll use a shadow config to fetch the first item,\r\n        let shadowConfig = configWithDefaults({});\r\n\r\n        // Check if there's a components.json file.\r\n        // If so, we'll merge with our shadow config.\r\n        const componentsJsonPath = path.resolve(options.cwd, \"components.json\");\r\n        if (fsExtra.existsSync(componentsJsonPath)) {\r\n          const existingConfig = await fsExtra.readJson(componentsJsonPath);\r\n          const config = rawConfigSchema.partial().parse(existingConfig);\r\n          shadowConfig = configWithDefaults(config);\r\n\r\n          // Since components.json might not be valid at this point.\r\n          // Temporaly rename components.json to allow preflight to run.\r\n          // We'll rename it back after preflight.\r\n          createFileBackup(componentsJsonPath);\r\n        }\r\n\r\n        // Ensure all registries used in componentes are configured.\r\n        const { config: updatedConfig } = await ensureRegistriesInConfig(\r\n          components,\r\n          shadowConfig,\r\n          {\r\n            silent: true,\r\n          }\r\n        )\r\n        shadowConfig = updatedConfig;\r\n\r\n\r\n        // This forces a shadowConfig validation early in the process.\r\n        buildUrlAndHeadersForRegistryItem(components[0], shadowConfig);\r\n\r\n\r\n        const [item] = await getRegistryItems([components[0]], {\r\n          config: shadowConfig\r\n        });\r\n\r\n        console.log(\"TEST - LLEGO AKI\")\r\n\r\n        if (item?.type == \"registry:style\") {\r\n          // Set a default base color so we're not prompted.\r\n          // The style will extend or override it.\r\n          options.baseColor = \"neutral\";\r\n\r\n          // If the style extends none, we don't want to install the base style.\r\n          options.baseStyle =\r\n            item.extends === \"none\" ? false : options.baseStyle;\r\n        }\r\n      }\r\n\r\n      // If --no-base-style, we don't want to prompt for a base color either\r\n      if (!options.baseStyle) {\r\n        options.baseColor = \"neutral\";\r\n      }\r\n\r\n      await runInit(options);\r\n\r\n      logger.log(\r\n        `${highlighter.success(\r\n          \"Success!\"\r\n        )} Project initialization completed. \\nYou may now add components.`\r\n      )\r\n\r\n    } catch (error) {\r\n      logger.break();\r\n      handleError(error);\r\n    } finally {\r\n      clearRegistryContext();\r\n    }\r\n  })\r\n\r\n\r\nexport async function runInit(\r\n  options: z.infer<typeof initOptionsSchema> & {\r\n    skipPreflight?: boolean\r\n  }\r\n) {\r\n  let projectInfo;\r\n  let newProjectTemplate;\r\n  if (!options.skipPreflight) {\r\n    const preflight = await preFlightInit(options);\r\n    if (preflight.errors[ERRORS.MISSING_DIR_OR_EMPTY_PROJECT]) {\r\n      const { projectPath, template } = await createProject(options);\r\n      if (!projectPath) {\r\n        process.exit(1);\r\n      }\r\n      options.cwd = projectPath;\r\n      options.isNewProject = true;\r\n      newProjectTemplate = template;\r\n    }\r\n    projectInfo = preflight.projectInfo;\r\n  } else {\r\n    projectInfo = await getProjectInfo(options.cwd);\r\n  }\r\n\r\n  if (newProjectTemplate === \"next-monorepo\") {\r\n    options.cwd = path.resolve(options.cwd, \"apps/web\");\r\n    return await getConfig(options.cwd);\r\n  }\r\n\r\n  const projectConfig = await getProjectConfig(options.cwd, projectInfo);\r\n\r\n  let config = projectConfig\r\n    ? await promptForMinimalConfig(projectConfig, options)\r\n    : console.log(\"xd\")\r\n}\r\n\r\nasync function promptForMinimalConfig(\r\n  defaultConfig: Config,\r\n  opts: z.infer<typeof initOptionsSchema>\r\n) {\r\n  let style = defaultConfig.style;\r\n  let baseColor = opts.baseColor;\r\n  let cssVariables = defaultConfig.tailwind.cssVariables;\r\n\r\n  if (!opts.defaults) {\r\n    const [styles, baseColors, tailwindVersion] = await Promise.all([\r\n      getRegistryStyles(),\r\n      getRegistryBaseColors(),\r\n      getProjectTailwindVersionFromConfig(defaultConfig),\r\n    ]);\r\n\r\n    const options = await prompts([\r\n      {\r\n        type: tailwindVersion === \"v4\" ? null : \"select\",\r\n        name: \"style\",\r\n        message: `Which ${highlighter.info(\"style\")} would you like to use?`,\r\n        choices: styles.map((style) => ({\r\n          title:\r\n            style.name === \"aodesu\" ? \"aodesu (Recommended)\" : style.label,\r\n          value: style.name,\r\n        })),\r\n        initial: 0,\r\n      },\r\n      {\r\n        type: opts.baseColor ? null : \"select\",\r\n        name: \"tailwindBaseColor\",\r\n        message: `Which color would you like to use as the ${highlighter.info(\"base color\")}?`,\r\n        choices: baseColors.map((color) => ({\r\n          title: color.label,\r\n          value: color.name,\r\n        })),\r\n      },\r\n    ]);\r\n\r\n    style = options.style ?? \"aodesu\";\r\n    baseColor = options.tailwindBaseColor ?? baseColor;\r\n    cssVariables = opts.cssVariables;\r\n  }\r\n\r\n  return rawConfigSchema.parse({\r\n    $schema: defaultConfig?.$schema,\r\n    style,\r\n    tailwind: {\r\n      ...defaultConfig?.tailwind,\r\n      baseColor,\r\n      cssVariables,\r\n    },\r\n    rsc: defaultConfig?.rsc,\r\n    tsx: defaultConfig?.tsx,\r\n    iconLibrary: defaultConfig?.iconLibrary,\r\n    aliases: defaultConfig?.aliases,\r\n  });\r\n}\r\n","#!/usr/bin/env node\r\nimport { Command } from \"commander\";\r\nimport packageJson from \"../package.json\";\r\nimport { build } from \"./commands/build\";\r\nimport { init } from \"./commands/init\";\r\n\r\nprocess.on(\"SIGNINT\", () => process.exit(0));\r\nprocess.on(\"SIGTERM\", () => process.exit(0));\r\n\r\nasync function main() {\r\n  const program = new Command()\r\n    .name(\"uidesu\")\r\n    .description(\"add items from registry to your project\")\r\n    .version(\r\n      packageJson.version || \"1.0.0\",\r\n      \"-v, --version\",\r\n      \"display the version number\"\r\n    )\r\n\r\n  program\r\n    .addCommand(init)\r\n    .addCommand(build)\r\n\r\n  program.parse()\r\n}\r\n\r\nmain()\r\n\r\n// export * from './registry/api';\r\n"]}
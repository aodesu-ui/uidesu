#!/usr/bin/env node
import {h as h$1,g as g$1,p,q as q$1,j as j$1,u as u$1}from'./chunk-2IEF2V43.js';import {Command}from'commander';import*as v from'fs/promises';import*as O from'path';import O__default,{join}from'path';import d,{z as z$1}from'zod';import b from'fs-extra';import {cyan,green,yellow,red}from'kleur/colors';import dt from'ora';import Zt from'prompts';import {cosmiconfig}from'cosmiconfig';import {loadConfig,createMatchPath}from'tsconfig-paths';import ie from'fast-glob';import Pt from'deepmerge';import {existsSync,promises}from'fs';import {HttpsProxyAgent}from'https-proxy-agent';import Wt from'node-fetch';import Kt,{homedir}from'os';import {detect}from'@antfu/ni';import {execa}from'execa';var Ie={version:"1.0.0"};var f={error:red,warn:yellow,info:cyan,success:green};var s={error(...e){console.log(f.error(e.join(" ")));},warn(...e){console.log(f.warn(e.join(" ")));},info(...e){console.log(f.info(e.join(" ")));},success(...e){console.log(f.success(e.join(" ")));},log(...e){console.log(e.join(" "));},break(){console.log("");}};async function Oe(e){let t={},r={cwd:e.cwd,registryFile:O__default.resolve(e.cwd,e.registryFile),outputDir:O__default.resolve(e.cwd,e.outputDir)};return b.existsSync(r.registryFile)||(t["13"]=true),await b.mkdir(r.outputDir,{recursive:true}),Object.keys(t).length>0&&(t["13"]&&(s.break(),s.error(`The path ${f.info(r.registryFile)} does not exist.`)),s.break(),process.exit(1)),{errors:t,resolvePaths:r}}var R={NOT_FOUND:"NOT_FOUND",UNAUTHORIZED:"UNAUTHORIZED",FORBIDDEN:"FORBIDDEN",FETCH_ERROR:"FETCH_ERROR",NOT_CONFIGURED:"NOT_CONFIGURED",MISSING_ENV_VARS:"MISSING_ENV_VARS",LOCAL_FILE_ERROR:"LOCAL_FILE_ERROR",PARSE_ERROR:"PARSE_ERROR",UNKNOWN_ERROR:"UNKNOWN_ERROR"},h=class extends Error{code;statusCode;context;suggestion;timestamp;cause;constructor(t,r={}){super(t),this.name="RegistryError",this.code=r.code||R.UNKNOWN_ERROR,this.statusCode=r.statusCode,this.cause=r.cause,this.context=r.context,this.suggestion=r.suggestion,this.timestamp=new Date,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor);}toJSON(){return {name:this.name,message:this.message,code:this.code,statusCode:this.statusCode,context:this.context,suggestion:this.suggestion,timestamp:this.timestamp,stack:this.stack}}},D=class extends h{constructor(r,i){let o=`The item at ${r} was not found. It may not exist at the registry.`;super(o,{code:R.NOT_FOUND,statusCode:404,cause:i,context:{url:r},suggestion:"Check if the item name is correct and the registry URL is accessible."});this.url=r;this.name="RegistryNotFoundError";}},Z=class extends h{constructor(r,i){let o=`You are not authorized to access the item at ${r}. If this is a remote registry, you may need to authenticate.`;super(o,{code:R.UNAUTHORIZED,statusCode:401,cause:i,context:{url:r},suggestion:"Check your authentication credentials and environment variables."});this.url=r;this.name="RegistryUnauthorizedError";}},q=class extends h{constructor(r,i){let o=`You are not authorized to access the item at ${r}. If this is a remote registry, you may need to authenticate.`;super(o,{code:R.FORBIDDEN,statusCode:403,cause:i,context:{url:r},suggestion:"Check your authentication credentials and environment variables."});this.url=r;this.name="RegistryForbiddenError";}},Q=class extends h{constructor(r,i,o,n){let c=i?`Failed to fetch from registry (${i}): ${r}`:`Failed to fetch from registry: ${r}`,a=typeof n=="string"&&n?`${c} - ${n}`:c,l="Check your network connection and try again.";i===404?l="The requested resource was not found. Check the URL or item name.":i===500?l="The registry server encountered an error. Try again later.":i&&i>=400&&i<500&&(l="There was a client error. Check your request parameters.");super(a,{code:R.FETCH_ERROR,statusCode:i,cause:n,context:{url:r,responseBody:o},suggestion:l});this.url=r;this.responseBody=o;this.name="RegistryFetchError";}},j=class extends h{constructor(r){let i=r?`Unknown registry "${r}". Make sure it is defined in components.json as follows:
{
  "registries": {
    "${r}": "[URL_TO_REGISTRY]"
  }
}`:'Unknown registry. Make sure it is defined in components.json under "registries".';super(i,{code:R.NOT_CONFIGURED,context:{registryName:r},suggestion:"Add the registry configuration to your components.json file. Consult the registry documentation for the correct format."});this.registryName=r;this.name="RegistryNotConfiguredError";}},U=class extends h{constructor(r,i){super(`Failed to read local registry file: ${r}`,{code:R.LOCAL_FILE_ERROR,cause:i,context:{filePath:r},suggestion:"Check if the file exists and you have read permissions."});this.filePath=r;this.name="RegistryLocalFileError";}},w=class extends h{constructor(r,i){let o=`Failed to parse registry item: ${r}`;i instanceof z$1.ZodError&&(o=`Failed to parse registry item: ${r}
${i.errors.map(n=>`  - ${n.path.join(".")}: ${n.message}`).join(`
`)}`);super(o,{code:R.PARSE_ERROR,cause:i,context:{item:r},suggestion:"The registry item may be corrupted or have an invalid format. Please make sure it returns a valid JSON object. See https://ui.aodesu.com/schema/registry-item.json."});this.item=r;this.parseError=i,this.name="RegistryParseError";}parseError},X=class extends h{constructor(r,i){let o=`Registry "${r}" requires the following environment variables:

`+i.map(n=>`  \u2022 ${n}`).join(`
`);super(o,{code:R.MISSING_ENV_VARS,context:{registryName:r,missingVars:i},suggestion:"Set the required environment variables to your .env or .env.local file."});this.registryName=r;this.missingVars=i;this.name="RegistryMissingEnvironmentVariablesError";}};var ee=class extends h{parseError;constructor(t){let r="Failed to parse registries index";if(t instanceof z$1.ZodError){let i=t.errors.filter(o=>o.path.length>0).map(o=>`"${o.path[0]}"`).filter((o,n,c)=>c.indexOf(o)===n);i.length>0?r=`Failed to parse registries index. Invalid registry namespace(s): ${i.join(", ")}
${t.errors.map(o=>`  - ${o.path.join(".")}: ${o.message}`).join(`
`)}`:r=`Failed to parse registries index:
${t.errors.map(o=>`  - ${o.path.join(".")}: ${o.message}`).join(`
`)}`;}super(r,{code:R.PARSE_ERROR,cause:t,context:{parseError:t},suggestion:"The registries index may be corrupted or have invalid registry namespace format. Registry names must start with @ (e.g., @aodesu, @example)."}),this.parseError=t,this.name="RegistriesIndexParseError";}};function x(e){if(s.break(),s.error("Something went wrong. Please check the error below for more details."),s.error("If the problem persist, please open an issue on GitHub."),s.error(""),typeof e=="string"&&(s.error(e),s.break(),process.exit(1)),e instanceof h&&(e.message&&(s.error(e.cause?"Error":"Message:"),s.error(e.message)),e.cause&&(s.error(`
Message:`),s.error(e.cause)),e.suggestion&&(s.error(`
Suggestion:`),s.error(e.suggestion)),s.break(),process.exit(1)),e instanceof d.ZodError){s.error("Validation failed:");for(let[t,r]of Object.entries(e.flatten().fieldErrors))s.error(`- ${f.info(t)}: ${r}`);s.break(),process.exit(1);}e instanceof Error&&(s.error(e.message),s.break(),process.exit(1)),s.break(),process.exit(1);}function u(e,t){return dt({text:e,isSilent:t?.silent})}var yt=d.object({cwd:d.string(),registryFile:d.string(),outputDir:d.string()}),Ne=new Command().name("build").description("build components for a aodesu registry").argument("[registry]","path to registry.json file","./registry.json").option("-o, --output <path>","destination directory for json files","./public/r").option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).action(async(e,t)=>{try{let r=yt.parse({cwd:O.resolve(t.cwd),registryFile:e,outputDir:t.output}),{resolvePaths:i}=await Oe(r),o=await v.readFile(i.registryFile,"utf-8"),n=h$1.safeParse(JSON.parse(o));n.success||(s.error(`Invalid registry file found at ${f.info(i.registryFile)}.`),process.exit(1));let c=u("Building registry...");for(let a of n.data.items){c.start(`Building ${a.name}...`),a.$schema="https://ui.aodesu.com/schema/registry-item.json";for(let m of a.files??[])m.content=await v.readFile(O.resolve(i.cwd,m.path),"utf-8");let l=g$1.safeParse(a);if(!l.success){s.error(`Invalid registry item found for ${f.info(a.name)}.`);continue}s.info(`Registry item found for ${a.name}`),await v.writeFile(O.resolve(i.outputDir,`${l.data.name}.json`),JSON.stringify(l.data,null,2));}await v.copyFile(i.registryFile,O.resolve(i.outputDir,"registry.json")),c.succeed("Building registry.");}catch(r){s.break(),x(r);}});var V={"next-app":{name:"next-app",label:"Next.js",links:{installation:"https://ui.aodesu.com/docs/installation/next",tailwind:"https://tailwindcss.com/docs/guides/nextjs"}},"next-pages":{name:"next-pages",label:"Next.js",links:{installation:"https://ui.aodesu.com/docs/installation/next",tailwind:"https://tailwindcss.com/docs/guides/nextjs"}},vite:{name:"vite",label:"vite",links:{installation:"https://ui.aodesu.com/docs/installation/vite",tailwind:"https://tailwindcss.com/docs/guides/vite"}},manual:{name:"manual",label:"Manual",links:{installation:"https://ui.aodesu.com/docs/installation/manual",tailwind:"https://tailwindcss.com/docs/installation"}}};var G=process.env.REGISTRY_URL??"https://ui.aodesu.com/r",re="aodesu",Te=[{name:"neutral",label:"Neutral"}],g={"@uidesu":`${G}/styles/{style}/{name}.json`};async function S(e,t){return createMatchPath(t.absoluteBaseUrl,t.paths)(e,void 0,()=>true,[".ts",".tsx",".jsx",".js",".css"])}var bt=cosmiconfig("components",{searchPlaces:["components.json"]});async function z(e){let t=await St(e);return t?(t.iconLibrary||(t.iconLibrary=t.style==="aodesu"?"radix":"lucide"),await ue(e,t)):null}async function ue(e,t){t.registries={...g,...t.registries||{}};let r=await loadConfig(e);if(r.resultType==="failed")throw new Error(`Failed to load ${t.tsx?"tsconfig":"jsconfig"}.json ${r.message??""}`.trim());return q$1.parse({...t,resolvedPaths:{cwd:e,tailwindConfig:t.tailwind.config?O__default.resolve(e,t.tailwind.config):"",tailwindCss:O__default.resolve(e,t.tailwind.css),utils:await S(t.aliases.utils,r),components:await S(t.aliases.components,r),ui:t.aliases.ui?await S(t.aliases.ui,r):O__default.resolve(await S(t.aliases.components,r)??e,"ui"),lib:t.aliases.lib?await S(t.aliases.lib,r):O__default.resolve(await S(t.aliases.utils,r)??e,".."),hooks:t.aliases.hooks?await S(t.aliases.hooks,r):O__default.resolve(await S(t.aliases.components,r)??e,"..","hooks")}})}async function St(e){try{let t=await bt.search(e);if(!t)return null;let r=p.parse(t.config);if(r.registries){for(let i of Object.keys(r.registries))if(i in g)throw new Error(`"${i}" is a built-in registry and cannot be overriden.`)}return r}catch(t){let r=`${e}/components.json`;throw t instanceof Error&&t.message.includes("reserved registry")?t:new Error(`Invalid configuration found in ${f.info(r)}`)}}function Fe(e){let t={resolvedPaths:{cwd:process.cwd(),tailwindConfig:"",tailwindCss:"",utils:"",components:"",ui:"",lib:"",hooks:""},style:"",tailwind:{config:"",css:"",baseColor:"",cssVariables:false},rsc:false,tsx:true,aliases:{components:"",utils:""},registries:{...g}};return e?{...t,...e,resolvedPaths:{...t.resolvedPaths,...e.resolvedPaths||{}},tailwind:{...t.tailwind,...e.tailwind||{}},aliases:{...t.aliases,...e.aliases||{}},registries:{...t.registries,...e.registries||{}}}:t}function ge(e="",t=true){let r=O__default.join(e,"package.json");return b.readJSONSync(r,{throws:t})}var oe=["**/node_modules/**",".next","public","dist","build"];z$1.object({compilerOptions:z$1.object({paths:z$1.record(z$1.string().or(z$1.array(z$1.string())))})});async function T(e){let[t,r,i,o,n,c,a,l]=await Promise.all([ie.glob("**/{vite,app,next}.config.*|gatsby-config.*|composer.json|react-router.config.*",{cwd:e,deep:3,ignore:oe}),b.pathExists(O__default.resolve(e,"src")),Nt(e),Ot(e),kt(e),Pe(e),jt(e),ge(e,false)]),m=await b.pathExists(O__default.resolve(e,`${r?"src/":""}app`)),p={framework:V.manual,isSrcDir:r,isRSC:false,isTsx:i,tailwindConfigFile:o,tailwindCssFile:n,tailwindVersion:c,frameworkVersion:null,aliasPrefix:a};return t.find(L=>L.startsWith("next.config."))?.length?(p.framework=m?V["next-app"]:V["next-pages"],p.isRSC=m,p.frameworkVersion=await vt(p.framework,l),p):(t.find(L=>L.startsWith("vite.config."))?.length&&(p.framework=V.vite),p)}async function vt(e,t){if(!t||!["next-app","next-pages"].includes(e.name))return null;let r=t.dependencies?.next||t.devDependencies?.next;if(!r)return null;let i=r.match(/^[\^~]?(\d+\.\d+\.\d+)/);if(i)return i[1];let o=r.match(/(\d+\.\d+\.\d+)/);return o?o[1]:r}async function Pe(e){let[t,r]=await Promise.all([ge(e,false),z(e)]);return r?.tailwind?.config===""?"v4":!t?.dependencies?.tailwindcss&&!t?.devDependencies?.tailwindcss?null:/^(?:\^|~)?3(?:\.\d+)*(?:-.*)?$/.test(t?.dependencies?.tailwindcss||t?.devDependencies?.tailwindcss||"")?"v3":"v4"}async function kt(e){let[t,r]=await Promise.all([ie.glob(["**/*.css","**/*.scss"],{cwd:e,deep:5,ignore:oe}),Pe(e)]);if(!t.length)return null;for(let i of t){let o=await b.readFile(O__default.resolve(e,i),"utf8");if(o.includes('@import "tailwindcss"')||o.includes("@import 'tailwindcss'")||o.includes("@tailwind base"))return i}return null}async function Ot(e){let t=await ie.glob("tailwind.config.*",{cwd:e,deep:3,ignore:oe});return t.length?t[0]:null}async function jt(e){let t=await loadConfig(e);if(t?.resultType==="failed"||!Object.entries(t?.paths).length)return null;for(let[r,i]of Object.entries(t.paths))if(i.includes("./*")||i.includes("./src/*")||i.includes("./app/*")||i.includes("./resources/js/*"))return r.replace(/\/\*$/,"")??null;return Object.keys(t?.paths)?.[0].replace(/\/\*$/,"")??null}async function Nt(e){return (await ie.glob("tsconfig.*",{cwd:e,deep:1,ignore:oe})).length>0}async function _e(e,t=null){let[r,i]=await Promise.all([z(e),t?Promise.resolve(t):T(e)]);if(r)return r;if(!i||!i.tailwindCssFile||i.tailwindVersion==="v3"&&!i.tailwindConfigFile)return null;let o={$schema:"https://ui.aodesu.com/schema.json",rsc:i.isRSC,tsx:i.isTsx,style:"aodesu",tailwind:{config:i.tailwindConfigFile??"",baseColor:"zinc",css:i.tailwindCssFile,cssVariables:true,prefix:""},iconLibrary:"lucide",aliases:{components:`${i.aliasPrefix}/components`,ui:`${i.aliasPrefix}/components/ui`,hooks:`${i.aliasPrefix}/hooks`,lib:`${i.aliasPrefix}/lib`,utils:`${i.aliasPrefix}/lib/utils`}};return await ue(e,o)}async function $e(e){if(!e.resolvedPaths?.cwd)return "v3";let t=await T(e.resolvedPaths.cwd);return t?.tailwindVersion?t.tailwindVersion:null}async function De(e){let t={};if(!b.existsSync(e.cwd)||!b.existsSync(O__default.resolve(e.cwd,"package.json")))return t["1"]=true,{errors:t,projectInfo:null};let r=u("Preflight checks.",{silent:e.silent}).start();b.existsSync(O__default.resolve(e.cwd,"components.json"))&&!e.force&&(r?.fail(),s.break(),s.error(`A ${f.info("components.json")} file already exist at ${f.info(e.cwd)}. 
To start over, remove the ${f.info("components.json")} file and run ${f.info("init")} again.`),s.break(),process.exit(1)),r?.succeed();let i=u("Verifying framework.",{silent:e.silent}).start(),o=await T(e.cwd);(!o||o?.framework.name==="manual")&&(t["7"]=true,i?.fail(),s.break(),o?.framework.links.installation&&s.error(`We could not detect a supported framework at ${f.info(e.cwd)}.
Visit ${f.info(o?.framework.links.installation)} to manually configure your project. 
Once configured, you can use the cli to add components.`),s.break(),process.exit(1)),i?.succeed(`Verifying framework. Found ${f.info(o.framework.label)}.`);let n="Validating Tailwind CSS.";o.tailwindVersion==="v4"&&(n=`Validating Tailwind CSS config. Found ${f.info("v4")}.`);let c=u(n,{silent:e.silent}).start();o.tailwindVersion==="v3"&&(!o?.tailwindConfigFile||!o?.tailwindCssFile)?(t["5"]=true,c?.fail()):o.tailwindVersion==="v4"&&!o?.tailwindCssFile?(t["5"]=true,c?.fail()):o.tailwindVersion?c?.succeed():(t["5"]=true,c?.fail());let a=u("Validating import alias.",{silent:e.silent}).start();return o?.aliasPrefix?a?.succeed():(t["6"]=true,a?.fail()),Object.keys(t).length>0&&(t["5"]&&(s.break(),s.error(`No Tailwind CSS configuration found at ${f.info(e.cwd)}.`),s.error("It is likely you do not have Tailwind CSS installed or have an invalid configuration."),s.error("Install Tailwind CSS then try again."),o?.framework.links.tailwind&&s.error(`Visit ${f.info(o?.framework.links.tailwind)} to get started.`)),t["6"]&&(s.break(),s.error("No import alias found in your tsconfig.json file."),o?.framework.links.installation&&s.error(`Visit ${f.info(o?.framework.links.installation)} to learn how to set an import alias.`)),s.break(),process.exit(1)),{errors:t,projectInfo:o}}function B(e){return e.replace(/\${(\w+)}/g,(t,r)=>process.env[r]||"")}function H(e){let t=[],r=/\${(\w+)}/g,i;for(;(i=r.exec(e))!==null;)t.push(i[1]);return t}var Ft=/^(@[a-zA-Z0-9](?:[a-zA-Z0-9-_]*[a-zA-Z0-9])?)\/(.+)$/;function F(e){if(!e.startsWith("@"))return {registry:null,item:e};let t=e.match(Ft);return t?{registry:t[1],item:t[2]}:{registry:null,item:e}}function P(e){try{return new URL(e),!0}catch{return  false}}function Ue(e){return e.endsWith(".json")&&!P(e)}function _t(e){return e.style?e.style==="aodesu"&&e.tailwind?.config===""?re:e.style:re}function _(e){let t=Fe({style:re,registries:g});return e?q$1.parse(Pt(t,{...e,style:_t(e),registries:{...g,...e.registries}})):t}var ne={headers:{}};function ae(e){ne.headers={...ne.headers,...e};}function Me(e){return ne.headers[e]||{}}function J(){ne.headers={};}function $t(e){let t=new Set;return typeof e=="string"?H(e).forEach(r=>t.add(r)):(H(e.url).forEach(r=>t.add(r)),e.params&&Object.values(e.params).forEach(r=>{H(r).forEach(i=>t.add(i));}),e.headers&&Object.values(e.headers).forEach(r=>{H(r).forEach(i=>t.add(i));})),Array.from(t)}function Ve(e,t){let i=$t(t).filter(o=>!process.env[o]);if(i.length>0)throw new X(e,i)}var Ge="{name}",ce="{style}",We=/\${(\w+)}/g,ze="?",At="&";function $(e,t){let{registry:r,item:i}=F(e);if(!r)return null;let n=(t?.registries||{})[r];if(!n)throw new j(r);return Ve(r,n),{url:Lt(i,n,t),headers:Dt(n)}}function Lt(e,t,r){if(typeof t=="string"){let o=t.replace(Ge,e);return r?.style&&o.includes(ce)&&(o=o.replace(ce,r.style)),B(o)}let i=t.url.replace(Ge,e);return r?.style&&i.includes(ce)&&(i=i.replace(ce,r.style)),i=B(i),t.params?Ut(i,t.params):i}function Dt(e){if(typeof e=="string"||!e.headers)return {};let t={};for(let[r,i]of Object.entries(e.headers)){let o=B(i);Mt(i,o)&&(t[r]=o);}return t}function Ut(e,t){let r=new URLSearchParams;for(let[n,c]of Object.entries(t)){let a=B(c);a&&r.append(n,a);}let i=r.toString();if(!i)return e;let o=e.includes(ze)?At:ze;return `${e}${o}${i}`}function Mt(e,t){let r=t.trim();if(!r)return  false;if(e.includes("${")&&e.match(We)){let o=e.replace(We,"").trim();return r!==o}return  true}function Be(e){if(P(e)){let t=new URL(e);return t.pathname.match(/\/chat\/b\//)&&!t.pathname.endsWith("/json")&&(t.pathname=`${t.pathname}/json`),t.toString()}return `${G}/${e}`}var Bt=process.env.https_proxy?new HttpsProxyAgent(process.env.https_proxy):void 0,Re=new Map;async function E(e,t={}){t={useCache:true,...t};try{return await Promise.all(e.map(async i=>{let o=Be(i);if(t.useCache&&Re.has(o))return Re.get(o);let n=(async()=>{let c=Me(o),a=await Wt(o,{agent:Bt,headers:{...c}});if(!a.ok){let l;if(a.headers.get("content-type")?.includes("application/json")){let m=await a.json(),p=z$1.object({detail:z$1.string().optional(),title:z$1.string().optional(),message:z$1.string().optional(),error:z$1.string().optional()}).safeParse(m);p.success&&(l=p.data.detail||p.data.message,p.data.error&&(l=`[${p.data.error}] ${l}`));}throw a.status===401?new Z(o,l):a.status===404?new D(o,l):a.status===403?new q(o,l):new Q(o,a.status,l)}return a.json()})();return t.useCache&&Re.set(o,n),n}))}catch(r){throw r}}async function Je(e){try{let t=e;e.startsWith("~/")&&(t=O__default.join(homedir(),e.slice(2)));let r=O__default.resolve(t),i=await promises.readFile(r,"utf8"),o=JSON.parse(i);try{return g$1.parse(o)}catch(n){throw new w(e,n)}}catch(t){throw t instanceof Error&&(t.message.includes("ENOENT")||t.message.includes("no such file"))?new U(e,t):t instanceof w?t:new U(e,t)}}function Ht(e,t){let r={},i=[...e];if(!t?.registries)return ae({}),i;for(let o=0;o<i.length;o++){let n=$(i[o],t);n&&(i[o]=n.url,Object.keys(n.headers).length>0&&(r[n.url]=n.headers));}return ae(r),i}async function le(e,t,r={}){return await Promise.all(e.map(async o=>{if(Ue(o))return Je(o);if(P(o)){let[a]=await E([o],r);try{return g$1.parse(a)}catch(l){throw new w(o,l)}}if(o.startsWith("@")&&t?.registries){let a=Ht([o],t),[l]=await E(a,r);try{return g$1.parse(l)}catch(m){throw new w(o,m)}}let n=`styles/${t?.style??"aodesu"}/${o}.json`,[c]=await E([n],r);console.log("TEST - LLEGO AKI");try{return g$1.parse(c)}catch(a){throw new w(o,a)}}))}async function Ye(e,t){let{config:r,useCache:i}=t||{};return J(),le(e,_(r),{useCache:i})}async function Ke(){try{let[e]=await E(["styles/index.json"]);return j$1.parse(e)}catch(e){return s.error(`
`),x(e),[]}}async function Ze(){return Te}async function qe(e){e={useCache:true,...e};let t=`${G}/registries.json`,[r]=await E([t],{useCache:e.useCache});try{return u$1.parse(r)}catch(i){throw i instanceof d.ZodError?new ee(i):i}}async function Qe(e,{withFallback:t}={withFallback:false}){let r=await detect({programmatic:true,cwd:e});if(r==="yarn@berry")return "yarn";if(r==="pnpm@6")return "pnpm";if(r==="bun")return "bun";if(r==="deno")return "deno";if(!t)return r??"npm";let i=process.env.npm_config_user_agent||"";return i.startsWith("yarn")?"yarn":i.startsWith("pnpm")?"pnpm":i.startsWith("bun")?"bun":"npm"}var qt="https://codeload.github.com/aodesu-ui/ui/tar.gz/main",k={next:"next","next-16":"next-16","next-monorepo":"next-monorepo",vite:"vite"};async function Xe(e){e={srcDir:false,...e};let t=e.template&&k[e.template]?e.template:"next",r=t===k.next?"my-app":"my-monorepo",i="15",o=e.components?.length===1&&!!e.components[0].match(/\/chat\/b\//);if(e.components&&o)try{let[a]=await E(e.components),{meta:l}=d.object({meta:d.object({nextVersion:d.string()})}).parse(a);i=l.nextVersion,t=k.next;}catch(a){s.break(),x(a);}if(!e.force){let{type:a,name:l}=await Zt([{type:e.template||o?null:"select",name:"type",message:`The path ${f.info(e.cwd)} does not contain a package.json file.
  Would you like to start a new project?`,choices:[{title:"Vite",value:"vite"},{title:"Next.js 15",value:"next"},{title:"Next.js 16",value:"next-16"},{title:"Next.js (Monorepo)",value:"next-monorepo"}],initial:0},{type:"text",name:"name",message:"What is your project named?",initial:r,format:m=>m.trim(),validate:m=>m.length>128?"Name should be less than 128 characters.":true}]);t=a??t,r=l,a==="next-16"&&(i="latest");}let n=await Qe(e.cwd,{withFallback:true}),c=`${e.cwd}/${r}`;try{await b.access(e.cwd,b.constants.W_OK);}catch{s.break(),s.error(`The path ${f.info(e.cwd)} is not writable.`),s.error(`It is likely you do not have write permissions for this folder or the path ${f.info(e.cwd)} does not exist.`),s.break(),process.exit(1);}return b.existsSync(O__default.resolve(e.cwd,r,"package.json"))&&(s.break(),s.error(`A project with the name ${f.info(r)} already exists.`),s.error("Please choose a different name and try again."),s.break(),process.exit(1)),t===k.vite&&await Qt(c,{packageManager:n}),(t===k.next||t===k["next-16"])&&await Xt(c,{version:i,cwd:e.cwd,packageManager:n,srcDir:!!e.srcDir}),t===k["next-monorepo"]&&await er(c,{packageManager:n}),{projectPath:c,projectName:r,template:t}}async function Qt(e,t){let r=u("Creating a new Vite project. This may take a few minutes.").start();try{let i=["create","vite@latest",O__default.basename(e),"--template","react-ts","--yes"];await execa(t.packageManager,i,{cwd:O__default.dirname(e)});let o=u(`Installing dependencies with ${t.packageManager}.`).start();await execa(t.packageManager,["install"],{cwd:e}),o?.succeed(`Installed dependencies with ${t.packageManager}.`);try{await execa("git",["init"],{cwd:e}),await execa("git",["add","-A"],{cwd:e}),await execa("git",["commit","-m","Initial commit from aodesu-ui"],{cwd:e});}catch{s.warn("Git initialization skipped (git not available)");}r?.succeed("Creating a new Vite project.");}catch(i){r?.fail("Something went worng creating a new Vite project."),x(i);}}async function Xt(e,t){let r=u(`Creating a new Next.js ${t.version.startsWith("latest")?"16":"15"} project. This may take a few minutes.`).start(),i=["--tailwind","--eslint","--typescript","--app",t.srcDir?"--src-dir":"--no-src-dir","--no-import-alias",`--use-${t.packageManager}`];(t.version.startsWith("15")||t.version.startsWith("latest")||t.version.startsWith("canary"))&&i.push("--turbopack"),(t.version.startsWith("latest")||t.version.startsWith("canary"))&&i.push("--no-react-compiler");try{await execa("npx",[`create-next-app@${t.version}`,e,"--silent",...i],{cwd:t.cwd});}catch{s.break(),s.error("Something went wrong creating a new Next.js project. Please try again."),process.exit(1);}r?.succeed(`Creating a new Next.js ${t.version.startsWith("latest")?"16":"15"} project.`);}async function er(e,t){let r=u("Creating a new Next.js monorepo. This may take a few minutes.").start();try{let i=O__default.join(Kt.tmpdir(),`aodesu-template-${Date.now()}`);await b.ensureDir(i);let o=await fetch(qt);if(!o.ok)throw new Error(`Failed to download template: ${o.statusText}`);let n=O__default.resolve(i,"template.tar.gz");await b.writeFile(n,Buffer.from(await o.arrayBuffer())),await execa("tar",["-xzf",n,"-C",i,"--strip-components=2","ui-main/templates/monorepo-next"]);let c=O__default.resolve(i,"monorepo-next");await b.move(c,e),await b.remove(i),await execa(t.packageManager,["install"],{cwd:e});let a=O__default.join(e,"package.json");if(b.existsSync(a)){let m=await b.readFile(a,"utf8"),p=JSON.parse(m);p.name=e.split("/").pop(),await b.writeFile(a,JSON.stringify(p,null,2));}let l=process.cwd();await execa("git",["--version"],{cwd:e}),await execa("git",["init"],{cwd:e}),await execa("git",["add","-A"],{cwd:e}),await execa("git",["commit","-m","Initial commit"],{cwd:e}),r?.succeed("Creating a new Next.js monorepo.");}catch(i){r?.fail("Something went wrong creating a new Next.js monorepo."),x(i);}}async function et(e=process.cwd()){try{let{config:t}=await import('@dotenvx/dotenvx'),r=[".env.local",".env.development.local",".env.development",".env"];for(let i of r){let o=join(e,i);existsSync(o)&&t({path:o,overload:!1,quiet:!0});}}catch(t){s.warn("Failed to load env files:",t);}}var be=".bak";function tt(e){if(!b.existsSync(e))return null;let t=`${e}${be}`;try{return b.renameSync(e,t),t}catch(r){return console.error(`Failed to create backup of ${e}: ${r}`),null}}function rt(e){let t=`${e}${be}`;if(!b.existsSync(t))return  false;try{return b.renameSync(t,e),!0}catch(r){return console.error(`Warning: Could not restore backup file ${t}: ${r}`),false}}function it(e){let t=`${e}${be}`;if(!b.existsSync(t))return  false;try{return b.unlinkSync(t),!0}catch{return  false}}async function ot(e,t){let r=new Set,i=new Set,o=[...e];for(;o.length>0;){let n=o.shift();if(i.has(n))continue;i.add(n);let{registry:c}=F(n);c&&!g[c]&&r.add(c);try{let[a]=await le([n],t,{useCache:!0});if(a?.registryDependencies)for(let l of a.registryDependencies){let{registry:m}=F(l);m&&!g[m]&&r.add(m),i.has(l)||o.push(l);}}catch(a){if(a instanceof j){let{registry:l}=F(n);l&&!g[l]&&r.add(l);continue}continue}}return Array.from(r)}async function st(e,t,r={}){r={silent:false,writeFile:true,...r};let o=(await ot(e,t)).filter(m=>!t.registries?.[m]&&!Object.keys(g).includes(m));if(o.length===0)return {config:t,newRegistries:[]};let n=await qe({useCache:process.env.NODE_ENV!=="development"});if(!n)return {config:t,newRegistries:[]};let c={};for(let m of o)n[m]&&(c[m]=n[m]);if(Object.keys(c).length===0)return {config:t,newRegistries:[]};let a=Object.fromEntries(Object.entries(t.registries||{}).filter(([m])=>!Object.keys(g).includes(m))),l={...t,registries:{...a,...c}};if(r.writeFile){let{resolvedPaths:m,...p$1}=l,L=u("Updating components.json.",{silent:r.silent}).start(),ct=p.parse(p$1);await b.writeFile(O__default.resolve(t.resolvedPaths.cwd,"components.json"),JSON.stringify(ct,null,2)+`
`,"utf-8"),L.succeed();}return {config:l,newRegistries:Object.keys(c)}}process.on("exit",e=>{let t=O__default.resolve(process.cwd(),"components.json");return e===0?it(t):rt(t)});var ar=d.object({cwd:d.string(),components:d.array(d.string()).optional(),yes:d.boolean(),defaults:d.boolean(),force:d.boolean(),silent:d.boolean(),isNewProject:d.boolean(),srcDir:d.boolean().optional(),cssVariables:d.boolean(),template:d.string().optional().refine(e=>e?"TEMPLATES":true,{message:"Invalid template. Please use 'next', 'next-16' or 'next-monorepo'."}),baseColor:d.string().optional(),baseStyle:d.boolean()}),at=new Command().name("init").description("initialize your project and install dependencies").argument("[components...]","names, url or local path to component").option("-t, --template <template>","the template to use. (next, next-16, next-monorepo)").option("-b, --base-color <base-color>","The base color to use. (neutral)",void 0).option("-y, --yes","Skip de confirmation prompt",true).option("-d, --defaults","Use default configuration.",false).option("-f, --force","Force overwrite of existing configuration",false).option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).option("-s, --silent","Mute output",false).option("--src-dir","Use the src directory when creating a new project.",false).option("--no-src-dir","Do not use the src directory when creating a new project.").option("--css-variables","Use css variables for theming.",true).option("--no-base-style","Do not install the base aodesu style.").action(async(e,t)=>{try{t.defaults&&(t.template=t.template||"next",t.baseColor=t.baseColor||"neutral");let r=ar.parse({cwd:O__default.resolve(t.cwd),isNewProject:!1,components:e,...t});if(await et(r.cwd),e.length>0){let i=_({}),o=O__default.resolve(r.cwd,"components.json");if(b.existsSync(o)){let a=await b.readJson(o),l=p.partial().parse(a);i=_(l),tt(o);}let{config:n}=await st(e,i,{silent:!0});i=n,$(e[0],i);let[c]=await Ye([e[0]],{config:i});console.log("TEST - LLEGO AKI"),c?.type=="registry:style"&&(r.baseColor="neutral",r.baseStyle=c.extends==="none"?!1:r.baseStyle);}r.baseStyle||(r.baseColor="neutral"),await cr(r),s.log(`${f.success("Success!")} Project initialization completed. 
You may now add components.`);}catch(r){s.break(),x(r);}finally{J();}});async function cr(e){let t,r;if(e.skipPreflight)t=await T(e.cwd);else {let n=await De(e);if(n.errors["1"]){let{projectPath:c,template:a}=await Xe(e);c||process.exit(1),e.cwd=c,e.isNewProject=true,r=a;}t=n.projectInfo;}if(r==="next-monorepo")return e.cwd=O__default.resolve(e.cwd,"apps/web"),await z(e.cwd);let i=await _e(e.cwd,t);i?await lr(i,e):console.log("xd");}async function lr(e,t){let r=e.style,i=t.baseColor,o=e.tailwind.cssVariables;if(!t.defaults){let[n,c,a]=await Promise.all([Ke(),Ze(),$e(e)]),l=await Zt([{type:a==="v4"?null:"select",name:"style",message:`Which ${f.info("style")} would you like to use?`,choices:n.map(m=>({title:m.name==="aodesu"?"aodesu (Recommended)":m.label,value:m.name})),initial:0},{type:t.baseColor?null:"select",name:"tailwindBaseColor",message:`Which color would you like to use as the ${f.info("base color")}?`,choices:c.map(m=>({title:m.label,value:m.name}))}]);r=l.style??"aodesu",i=l.tailwindBaseColor??i,o=t.cssVariables;}return p.parse({$schema:e?.$schema,style:r,tailwind:{...e?.tailwind,baseColor:i,cssVariables:o},rsc:e?.rsc,tsx:e?.tsx,iconLibrary:e?.iconLibrary,aliases:e?.aliases})}process.on("SIGNINT",()=>process.exit(0));process.on("SIGTERM",()=>process.exit(0));async function fr(){let e=new Command().name("uidesu").description("add items from registry to your project").version(Ie.version,"-v, --version","display the version number");e.addCommand(at).addCommand(Ne),e.parse();}fr();//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map